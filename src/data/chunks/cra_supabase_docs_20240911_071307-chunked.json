[
  {
    "chunk_id": "16a985c7-52d0-4930-b133-6eb3186af9ab",
    "metadata": {
      "token_count": 95,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/sveltekit",
      "page_title": "Supabase Auth with SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Supabase Auth with SvelteKit",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nWe generally recommend using the new <code>@supabase/ssr</code> package instead of <code>auth-helpers</code>. <code>@supabase/ssr</code> takes the core concepts of the Auth Helpers package and makes them available to any server framework. Check out the [migration doc](/docs/guides/auth/server-side/migrating-to-ssr-from-auth-helpers) to learn more.\n\nSee legacy docs\n"
    }
  },
  {
    "chunk_id": "43224174-0d4b-473f-b90e-63e327d8ba77",
    "metadata": {
      "token_count": 124,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Install Supabase packages"
      },
      "text": "Auth\nSet up Server-Side Auth to use cookie-based authentication with SvelteKit.\n\n1\nInstall the <code>@supabase/supabase-js</code> package and the helper <code>@supabase/ssr</code> package.\n\n`\n_10\nnpm install @supabase/supabase-js @supabase/ssr\n`\n\n2\nCreate a <code>.env.local</code> file in your project root directory.\n\nFill in your <code>PUBLIC_SUPABASE_URL</code> and <code>PUBLIC_SUPABASE_ANON_KEY</code>:\n"
    }
  },
  {
    "chunk_id": "79d2adc0-124b-4b46-bd4d-3091587623f4",
    "metadata": {
      "token_count": 891,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "### Project URL"
      },
      "text": "\n`\n\n2\nCreate a <code>.env.local</code> file in your project root directory.\n\nFill in your <code>PUBLIC_SUPABASE_URL</code> and <code>PUBLIC_SUPABASE_ANON_KEY</code>:\nLoading...\nLoading...\n\n.env.local\n\n`\n_10\nPUBLIC_SUPABASE_URL=<your_supabase_project_url>\n_10\nPUBLIC_SUPABASE_ANON_KEY=<your_supabase_anon_key>\n`\n\n3\nSet up server-side hooks in <code>src/hooks.server.ts</code>. The hooks:\n\n- Create a request-specific Supabase client, using the user credentials from the request cookie. This client is used for server-only code.\n- Check user authentication.\n- Guard protected pages.\n\nsrc/hooks.server.ts\n\n``\n_81\nimport { createServerClient } from '@supabase/ssr'\n_81\nimport { type Handle, redirect } from '@sveltejs/kit'\n_81\nimport { sequence } from '@sveltejs/kit/hooks'\n_81\n_81\nimport { PUBLIC_SUPABASE_URL, PUBLIC_SUPABASE_ANON_KEY } from '$env/static/public'\n_81\n_81\nconst supabase: Handle = async ({ event, resolve }) => {\n_81\n/**\n_81\n* Creates a Supabase client specific to this server request.\n_81\n*\n_81\n* The Supabase client gets the Auth token from the request cookies.\n_81\n*/\n_81\nevent.locals.supabase = createServerClient(PUBLIC_SUPABASE_URL, PUBLIC_SUPABASE_ANON_KEY, {\n_81\n    cookies: {\n_81\n      getAll: () => event.cookies.getAll(),\n_81\n      /**\n_81\n       * SvelteKit's cookies API requires <code>path</code> to be explicitly set in\n_81\n       * the cookie options. Setting <code>path</code> to <code>/</code> replicates previous/\n_81\n       * standard behavior.\n_81\n       */\n_81\n      setAll: (cookiesToSet) => {\n_81\n        cookiesToSet.forEach(({ name, value, options }) => {\n_81\n          event.cookies.set(name, value, { ...options, path: '/' })\n_81\n        })\n_81\n      },\n_81\n    },\n_81\n})\n_81\n_81\n/**\n_81\n* Unlike <code>supabase.auth.getSession()</code>, which returns the session _without_\n_81\n* validating the JWT, this function also calls <code>getUser()</code> to validate the\n_81\n* JWT before returning the session.\n_81\n*/\n_81\nevent.locals.safeGetSession = async () => {\n_81\n    const {\n_81\n      data: { session },\n_81\n    } = await event.locals.supabase.auth.getSession()\n_81\n    if (!session) {\n_81\n      return { session: null, user: null }\n_81\n    }\n_81\n_81\n    const {\n_81\n      data: { user },\n_81\n      error,\n_81\n    } = await event.locals.supabase.auth.getUser()\n_81\n    if (error) {\n_81\n      // JWT validation has failed\n_81\n      return { session: null, user: null }\n_81\n    }\n_81\n_81\n    return { session, user }\n_81\n}\n_81\n_81\nreturn resolve(event, {\n_81\n    filterSerializedResponseHeaders(name) {\n_81\n      /**\n_81\n       * Supabase libraries use the <code>content-range</code> and <code>x-supabase-api-version</code>\n_81\n       * headers, so we need to tell SvelteKit to pass it through.\n_81\n       */\n_81\n      return name === 'content-range' || name === 'x-supabase-api-version'\n_81\n    },\n_81\n})\n_81\n}\n_81\n_81\nconst authGuard: Handle = async ({ event, resolve }) => {\n_81\nconst { session, user } = await event.locals.safeGetSession()\n_81\nevent.locals.session = session\n_81\n"
    }
  },
  {
    "chunk_id": "d2b4445b-94de-4ae7-868a-2ec008154791",
    "metadata": {
      "token_count": 165,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Set up server-side hooks"
      },
      "text": "}\n_81\n_81\nconst authGuard: Handle = async ({ event, resolve }) => {\n_81\nconst { session, user } = await event.locals.safeGetSession()\n_81\nevent.locals.session = session\n_81\nevent.locals.user = user\n_81\n_81\nif (!event.locals.session && event.url.pathname.startsWith('/private')) {\n_81\n    redirect(303, '/auth')\n_81\n}\n_81\n_81\nif (event.locals.session && event.url.pathname === '/auth') {\n_81\n    redirect(303, '/private')\n_81\n}\n_81\n_81\nreturn resolve(event)\n_81\n}\n_81\n_81\nexport const handle: Handle = sequence(supabase, authGuard)\n``\n\n4\n"
    }
  },
  {
    "chunk_id": "7a3b13cd-fda9-4df1-8fc8-7af7a30ef3d6",
    "metadata": {
      "token_count": 255,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Create TypeScript definitions"
      },
      "text": " redirect(303, '/private')\n_81\n}\n_81\n_81\nreturn resolve(event)\n_81\n}\n_81\n_81\nexport const handle: Handle = sequence(supabase, authGuard)\n``\n\n4\nTo prevent TypeScript errors, add type definitions for the new <code>event.locals</code> properties.\n\nsrc/app.d.ts\n\n`\n_20\nimport type { Session, SupabaseClient, User } from '@supabase/supabase-js'\n_20\n_20\ndeclare global {\n_20\nnamespace App {\n_20\n    // interface Error {}\n_20\n    interface Locals {\n_20\n      supabase: SupabaseClient\n_20\n      safeGetSession: () => Promise<{ session: Session | null; user: User | null }>\n_20\n      session: Session | null\n_20\n      user: User | null\n_20\n    }\n_20\n    interface PageData {\n_20\n      session: Session | null\n_20\n    }\n_20\n    // interface PageState {}\n_20\n    // interface Platform {}\n_20\n}\n_20\n}\n_20\n_20\nexport {}\n`\n\n5\n"
    }
  },
  {
    "chunk_id": "b0268817-6dd8-449a-8c56-e9f70f8aaa4e",
    "metadata": {
      "token_count": 580,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Create a Supabase client in your root layout"
      },
      "text": "20\n      session: Session | null\n_20\n    }\n_20\n    // interface PageState {}\n_20\n    // interface Platform {}\n_20\n}\n_20\n}\n_20\n_20\nexport {}\n`\n\n5\nCreate a Supabase client in your root <code>+layout.ts</code>. This client can be used to access Supabase from the client or the server. In order to get access to the Auth token on the server, use a <code>+layout.server.ts</code> file to pass in the session from <code>event.locals</code>.\n\nsrc/routes/+layout.ts\n\nsrc/routes/+layout.server.ts\n\n``\n_43\nimport { createBrowserClient, createServerClient, isBrowser } from '@supabase/ssr'\n_43\nimport { PUBLIC_SUPABASE_ANON_KEY, PUBLIC_SUPABASE_URL } from '$env/static/public'\n_43\nimport type { LayoutLoad } from './$types'\n_43\n_43\nexport const load: LayoutLoad = async ({ data, depends, fetch }) => {\n_43\n/**\n_43\n* Declare a dependency so the layout can be invalidated, for example, on\n_43\n* session refresh.\n_43\n*/\n_43\ndepends('supabase:auth')\n_43\n_43\nconst supabase = isBrowser()\n_43\n    ? createBrowserClient(PUBLIC_SUPABASE_URL, PUBLIC_SUPABASE_ANON_KEY, {\n_43\n        global: {\n_43\n          fetch,\n_43\n        },\n_43\n      })\n_43\n    : createServerClient(PUBLIC_SUPABASE_URL, PUBLIC_SUPABASE_ANON_KEY, {\n_43\n        global: {\n_43\n          fetch,\n_43\n        },\n_43\n        cookies: {\n_43\n          getAll() {\n_43\n            return data.cookies\n_43\n          },\n_43\n        },\n_43\n      })\n_43\n_43\n/**\n_43\n* It's fine to use <code>getSession</code> here, because on the client, <code>getSession</code> is\n_43\n* safe, and on the server, it reads <code>session</code> from the <code>LayoutData</code>, which\n_43\n* safely checked the session using <code>safeGetSession</code>.\n_43\n*/\n_43\nconst {\n_43\n    data: { session },\n_43\n} = await supabase.auth.getSession()\n_43\n_43\nconst {\n_43\n    data: { user },\n_43\n} = await supabase.auth.getUser()\n_43\n_43\nreturn { session, supabase, user }\n_43\n}\n``\n\n6\n"
    }
  },
  {
    "chunk_id": "363224e0-ed4e-4079-b580-aa6a572eea68",
    "metadata": {
      "token_count": 248,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Listen to Auth events"
      },
      "text": "_43\nconst {\n_43\n    data: { user },\n_43\n} = await supabase.auth.getUser()\n_43\n_43\nreturn { session, supabase, user }\n_43\n}\n``\n\n6\nSet up a listener for Auth events on the client, to handle session refreshes and signouts.\n\nsrc/routes/+layout.svelte\n\n`\n_19\n<script>\n_19\n\timport { invalidate } from '$app/navigation';\n_19\n\timport { onMount } from 'svelte';\n_19\n_19\n\texport let data;\n_19\n\t$: ({ session, supabase } = data);\n_19\n_19\n\tonMount(() => {\n_19\n\t\tconst { data } = supabase.auth.onAuthStateChange((_, newSession) => {\n_19\n\t\t\tif (newSession?.expires_at !== session?.expires_at) {\n_19\n\t\t\t\tinvalidate('supabase:auth');\n_19\n\t\t\t}\n_19\n\t\t});\n_19\n_19\n\t\treturn () => data.subscription.unsubscribe();\n_19\n\t});\n_19\n</script>\n_19\n_19\n<slot />\n`\n\n7\n"
    }
  },
  {
    "chunk_id": "40f66c98-9081-4d80-b4a1-3a4cff698103",
    "metadata": {
      "token_count": 219,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Create your first page"
      },
      "text": "');\n_19\n\t\t\t}\n_19\n\t\t});\n_19\n_19\n\t\treturn () => data.subscription.unsubscribe();\n_19\n\t});\n_19\n</script>\n_19\n_19\n<slot />\n`\n\n7\nCreate your first page. This example page calls Supabase from the server to get a list of countries from the database.\n\nThis is an example of a public page that uses publicly readable data.\n\nTo populate your database, run the [countries quickstart](/dashboard/project/_/sql/quickstarts) from your dashboard.\n\nsrc/routes/+page.server.ts\n\nsrc/routes/+page.svelte\n\n`\n_10\nimport type { PageServerLoad } from './$types'\n_10\n_10\nexport const load: PageServerLoad = async ({ locals: { supabase } }) => {\n_10\nconst { data: countries } = await supabase.from('countries').select('name').limit(5).order('name')\n_10\nreturn { countries: countries ?? [] }\n_10\n}\n`\n\n8\n"
    }
  },
  {
    "chunk_id": "906dd6df-2e94-463a-921e-670798d7d480",
    "metadata": {
      "token_count": 159,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Change the Auth confirmation path"
      },
      "text": " => {\n_10\nconst { data: countries } = await supabase.from('countries').select('name').limit(5).order('name')\n_10\nreturn { countries: countries ?? [] }\n_10\n}\n`\n\n8\nIf you have email confirmation turned on (the default), a new user will receive an email confirmation after signing up.\n\nChange the email template to support a server-side authentication flow.\n\nGo to the [Auth templates](https://supabase.com/dashboard/project/_/auth/templates) page in your dashboard. In the <code>Confirm signup</code> template, change <code>{{ .ConfirmationURL }}</code> to <code>{{ .SiteURL }}/auth/confirm?token_hash={{ .TokenHash }}&type=email</code>.\n\n9\n"
    }
  },
  {
    "chunk_id": "655773ce-2205-45de-9e5b-105030452324",
    "metadata": {
      "token_count": 429,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Create a login page"
      },
      "text": ". In the <code>Confirm signup</code> template, change <code>{{ .ConfirmationURL }}</code> to <code>{{ .SiteURL }}/auth/confirm?token_hash={{ .TokenHash }}&type=email</code>.\n\n9\nNext, create a login page to let users sign up and log in.\n\nsrc/routes/auth/+page.server.ts\n\nsrc/routes/auth/+page.svelte\n\nsrc/routes/auth/+layout.svelte\n\nsrc/routes/auth/error/+page.svelte\n\n`\n_32\nimport { redirect } from '@sveltejs/kit'\n_32\n_32\nimport type { Actions } from './$types'\n_32\n_32\nexport const actions: Actions = {\n_32\nsignup: async ({ request, locals: { supabase } }) => {\n_32\n    const formData = await request.formData()\n_32\n    const email = formData.get('email') as string\n_32\n    const password = formData.get('password') as string\n_32\n_32\n    const { error } = await supabase.auth.signUp({ email, password })\n_32\n    if (error) {\n_32\n      console.error(error)\n_32\n      redirect(303, '/auth/error')\n_32\n    } else {\n_32\n      redirect(303, '/')\n_32\n    }\n_32\n},\n_32\nlogin: async ({ request, locals: { supabase } }) => {\n_32\n    const formData = await request.formData()\n_32\n    const email = formData.get('email') as string\n_32\n    const password = formData.get('password') as string\n_32\n_32\n    const { error } = await supabase.auth.signInWithPassword({ email, password })\n_32\n    if (error) {\n_32\n      console.error(error)\n_32\n      redirect(303, '/auth/error')\n_32\n    } else {\n_32\n      redirect(303, '/private')\n_32\n    }\n_32\n},\n_32\n}\n`\n\n10\n"
    }
  },
  {
    "chunk_id": "5c178cf4-9d2a-4bde-aa1c-35ab84f4d39b",
    "metadata": {
      "token_count": 407,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Create the signup confirmation route"
      },
      "text": " console.error(error)\n_32\n      redirect(303, '/auth/error')\n_32\n    } else {\n_32\n      redirect(303, '/private')\n_32\n    }\n_32\n},\n_32\n}\n`\n\n10\nFinish the signup flow by creating the API route to handle email verification.\n\nsrc/routes/auth/confirm/+server.ts\n\n``\n_31\nimport type { EmailOtpType } from '@supabase/supabase-js'\n_31\nimport { redirect } from '@sveltejs/kit'\n_31\n_31\nimport type { RequestHandler } from './$types'\n_31\n_31\nexport const GET: RequestHandler = async ({ url, locals: { supabase } }) => {\n_31\nconst token_hash = url.searchParams.get('token_hash')\n_31\nconst type = url.searchParams.get('type') as EmailOtpType | null\n_31\nconst next = url.searchParams.get('next') ?? '/'\n_31\n_31\n/**\n_31\n* Clean up the redirect URL by deleting the Auth flow parameters.\n_31\n*\n_31\n* <code>next</code> is preserved for now, because it's needed in the error case.\n_31\n*/\n_31\nconst redirectTo = new URL(url)\n_31\nredirectTo.pathname = next\n_31\nredirectTo.searchParams.delete('token_hash')\n_31\nredirectTo.searchParams.delete('type')\n_31\n_31\nif (token_hash && type) {\n_31\n    const { error } = await supabase.auth.verifyOtp({ type, token_hash })\n_31\n    if (!error) {\n_31\n      redirectTo.searchParams.delete('next')\n_31\n      redirect(303, redirectTo)\n_31\n    }\n_31\n}\n_31\n_31\nredirectTo.pathname = '/auth/error'\n_31\nredirect(303, redirectTo)\n_31\n}\n``\n\n11\n"
    }
  },
  {
    "chunk_id": "cf5e2b69-326d-45f9-aa57-c4991c634587",
    "metadata": {
      "token_count": 268,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/sveltekit",
      "page_title": "Setting up Server-Side Auth for SvelteKit | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for SvelteKit",
        "h2": "",
        "h3": "Create private routes"
      },
      "text": "')\n_31\n      redirect(303, redirectTo)\n_31\n    }\n_31\n}\n_31\n_31\nredirectTo.pathname = '/auth/error'\n_31\nredirect(303, redirectTo)\n_31\n}\n``\n\n11\nCreate private routes that can only be accessed by authenticated users. The routes in the <code>private</code> directory are protected by the route guard in <code>hooks.server.ts</code>.\n\nTo ensure that <code>hooks.server.ts</code> runs for every nested path, put a <code>+layout.server.ts</code> file in the <code>private</code> directory. This file can be empty, but must exist to protect routes that don't have their own <code>+layout|page.server.ts</code>.\n\nsrc/routes/private/+layout.server.ts\n\nsrc/routes/private/+layout.svelte\n\nSQL\n\nsrc/routes/private/+page.server.ts\n\nsrc/routes/private/+page.svelte\n\n``\n_10\n/**\n_10\n* This file is necessary to ensure protection of all routes in the <code>private</code>\n_10\n* directory. It makes the routes in this directory _dynamic_ routes, which\n_10\n* send a server request, and thus trigger <code>hooks.server.ts</code>.\n_10\n**/\n``\n"
    }
  },
  {
    "chunk_id": "207edd65-a92a-4802-8994-b8931e1f27cf",
    "metadata": {
      "token_count": 799,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/custom-access-token-hook",
      "page_title": "Custom Access Token Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Custom Access Token Hook",
        "h2": "Customize the access token issued by Supabase Auth",
        "h3": ""
      },
      "text": "Auth\nThe custom access token hook runs before a token is issued and allows you to add additional claims based on the authentication method used.\n\nClaims returned must conform to our specification. Supabase Auth will check for these claims after the hook is run and return an error if they are not present.\n\nThese are the fields currently available on an access token:\n\nRequired Claims: <code>aud</code>, <code>exp</code>, <code>iat</code>, <code>sub</code>, <code>email</code>, <code>phone</code>, <code>role</code>, <code>aal</code>, <code>session_id</code>\nOptional Claims: <code>jti</code>, <code>iss</code>, <code>nbf</code>, <code>app_metadata</code>, <code>user_metadata</code>, <code>amr</code>\n\n**Inputs**\n\n| Field | Type | Description |\n| --- | --- | --- |\n| <code>user_id</code> | <code>string</code> | Unique identifier for the user attempting to sign in. |\n| <code>claims</code> | <code>object</code> | Claims which are included in the access token. |\n| <code>authentication_method</code> | <code>string</code> | The authentication method used to request the access token. Possible values include: <code>oauth</code>, <code>password</code>, <code>otp</code>, <code>totp</code>, <code>recovery</code>, <code>invite</code>, <code>sso/saml</code>, <code>magiclink</code>, <code>email/signup</code>, <code>email_change</code>, <code>token_refresh</code>, <code>anonymous</code>. |\n\nJSONJSON Schema\n\n`\n1\n{\n2\n\"user_id\": \"8ccaa7af-909f-44e7-84cb-67cdccb56be6\",\n3\n\"claims\": {\n4\n    \"aud\": \"authenticated\",\n5\n    \"exp\": 1715690221,\n6\n    \"iat\": 1715686621,\n7\n    \"sub\": \"8ccaa7af-909f-44e7-84cb-67cdccb56be6\",\n8\n    \"email\": \"\",\n9\n    \"phone\": \"\",\n10\n    \"app_metadata\": {},\n11\n    \"user_metadata\": {},\n12\n    \"role\": \"authenticated\",\n13\n    \"aal\": \"aal1\",\n14\n    \"amr\": [ { \"method\": \"anonymous\", \"timestamp\": 1715686621 } ],\n15\n    \"session_id\": \"4b938a09-5372-4177-a314-cfa292099ea2\",\n16\n    \"is_anonymous\": true\n17\n},\n18\n\"authentication_method\": \"anonymous\"\n19\n}\n`\n\n**Outputs**\n\nReturn these only if your hook processed the input without errors.\n\n| Field | Type | Description |\n| --- | --- | --- |\n| <code>claims</code> | <code>object</code> | The updated claims after the hook has been run. |\n\nSQLHTTP\n\nAdd admin roleAdd claim via plv8Restrict access to SSO users\n\nYou can allow registered admin users to perform restricted actions by granting an <code>admin</code> claim to their token.\n\nCreate a profiles table with an <code>is_admin</code> flag:\n\n`\n1\ncreate table profiles (\n2\nuser_id uuid not null primary key references auth.users (id),\n3\nis_admin boolean not null default false\n4\n);\n`\n\nCreate a hook:\n\n`\n1\ncreate or replace function public.custom_access_token_hook(event jsonb)\n2\nreturns jsonb\n3\n"
    }
  },
  {
    "chunk_id": "346b0257-62b2-4685-a157-8603f12ff55b",
    "metadata": {
      "token_count": 379,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/custom-access-token-hook",
      "page_title": "Custom Access Token Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Custom Access Token Hook",
        "h2": "Customize the access token issued by Supabase Auth",
        "h3": ""
      },
      "text": " primary key references auth.users (id),\n3\nis_admin boolean not null default false\n4\n);\n`\n\nCreate a hook:\n\n`\n1\ncreate or replace function public.custom_access_token_hook(event jsonb)\n2\nreturns jsonb\n3\nlanguage plpgsql\n4\nas $$\n5\ndeclare\n6\n    claims jsonb;\n7\n    is_admin boolean;\n8\nbegin\n9\n    -- Check if the user is marked as admin in the profiles table\n10\n    select is_admin into is_admin from profiles where user_id = (event->>'user_id')::uuid;\n11\n12\n    -- Proceed only if the user is an admin\n13\n    if is_admin then\n14\n      claims := event->'claims';\n15\n16\n      -- Check if 'app_metadata' exists in claims\n17\n      if jsonb_typeof(claims->'app_metadata') is null then\n18\n        -- If 'app_metadata' does not exist, create an empty object\n19\n        claims := jsonb_set(claims, '{app_metadata}', '{}');\n20\n      end if;\n21\n22\n      -- Set a claim of 'admin'\n23\n      claims := jsonb_set(claims, '{app_metadata, admin}', 'true');\n24\n25\n      -- Update the 'claims' object in the original event\n26\n      event := jsonb_set(event, '{claims}', claims);\n27\n    end if;\n28\n29\n    -- Return the modified or original event\n30\n    return event;\n31\nend;\n32\n$$;\n33\n34\ngrant all\n35\non table public.profiles\n36\nto supabase_auth_admin;\n37\n38\nrevoke all\n39\non table public.profiles\n40\nfrom authenticated, anon, public;\n`\n"
    }
  },
  {
    "chunk_id": "0a463e8b-a26c-4dca-8b0c-49dc44c3fc69",
    "metadata": {
      "token_count": 796,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/send-email-hook",
      "page_title": "Send Email Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Send Email Hook",
        "h2": "Use a custom email provider to send authentication messages",
        "h3": ""
      },
      "text": "Auth\nThe Send Email Hook runs before an email is sent and allows for flexibility around email sending. You can use this hook to configure a back-up email provider or add internationalization to your emails.\n\n**Inputs**\n\n| Field | Type | Description |\n| --- | --- | --- |\n| <code>user</code> | [<code>User</code>](/docs/guides/auth/users#the-user-object) | The user attempting to sign in. |\n| <code>email</code> | <code>object</code> | Metadata specific to the email sending process. Includes the OTP and <code>token_hash</code>. |\n\nJSONJSON Schema\n\n`\n_49\n{\n_49\n\"user\": {\n_49\n    \"id\": \"8484b834-f29e-4af2-bf42-80644d154f76\",\n_49\n    \"aud\": \"authenticated\",\n_49\n    \"role\": \"authenticated\",\n_49\n    \"email\": \"john@soupbase.io\",\n_49\n    \"phone\": \"\",\n_49\n    \"app_metadata\": {\n_49\n      \"provider\": \"email\",\n_49\n      \"providers\": [\"email\"]\n_49\n    },\n_49\n    \"user_metadata\": {\n_49\n      \"email\": \"john@soupbase.io\",\n_49\n      \"email_verified\": false,\n_49\n      \"phone_verified\": false,\n_49\n      \"sub\": \"8484b834-f29e-4af2-bf42-80644d154f76\"\n_49\n    },\n_49\n    \"identities\": [\\\n_49\\\n      {\\\n_49\\\n        \"identity_id\": \"bc26d70b-517d-4826-bce4-413a5ff257e7\",\\\n_49\\\n        \"id\": \"8484b834-f29e-4af2-bf42-80644d154f76\",\\\n_49\\\n        \"user_id\": \"8484b834-f29e-4af2-bf42-80644d154f76\",\\\n_49\\\n        \"identity_data\": {\\\n_49\\\n          \"email\": \"john@soupbase.io\",\\\n_49\\\n          \"email_verified\": false,\\\n_49\\\n          \"phone_verified\": false,\\\n_49\\\n          \"sub\": \"8484b834-f29e-4af2-bf42-80644d154f76\"\\\n_49\\\n        },\\\n_49\\\n        \"provider\": \"email\",\\\n_49\\\n        \"last_sign_in_at\": \"2024-05-14T12:56:33.824231484Z\",\\\n_49\\\n        \"created_at\": \"2024-05-14T12:56:33.824261Z\",\\\n_49\\\n        \"updated_at\": \"2024-05-14T12:56:33.824261Z\",\\\n_49\\\n        \"email\": \"john@soupbase.io\"\\\n_49\\\n      }\\\n_49\\\n    ],\n_49\n    \"created_at\": \"2024-05-14T12:56:33.821567Z\",\n_49\n    \"updated_at\": \"2024-05-14T12:56:33.825595Z\",\n_49\n    \"is_anonymous\": false\n_49\n},\n_49\n\"email_data\": {\n_49\n    \"token\": \"305805\",\n_49\n    \"token_hash\": \"7d5b7b1964cf5d388340a7f04f1dbb5eeb6c7b52ef8270e1737a58d0\",\n_49\n    \"redirect_to\": \"http://localhost:3000/\",\n_49\n"
    }
  },
  {
    "chunk_id": "46ced9c7-28f5-416e-9a6b-ec45fae8403d",
    "metadata": {
      "token_count": 848,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/send-email-hook",
      "page_title": "Send Email Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Send Email Hook",
        "h2": "Use a custom email provider to send authentication messages",
        "h3": ""
      },
      "text": "5d388340a7f04f1dbb5eeb6c7b52ef8270e1737a58d0\",\n_49\n    \"redirect_to\": \"http://localhost:3000/\",\n_49\n    \"email_action_type\": \"signup\",\n_49\n    \"site_url\": \"http://localhost:9999\",\n_49\n    \"token_new\": \"\",\n_49\n    \"token_hash_new\": \"\"\n_49\n}\n_49\n}\n`\n\n**Outputs**\n\n- No outputs are required. An empty response with a status code of 200 is taken as a successful response.\n\nSQLHTTP\n\nUse Resend as an email providerAdd Internationalization for Email Templates\n\nYou can configure [Resend](https://resend.com/) as the custom email provider through the \"Send Email\" hook. This allows you to take advantage of Resend's developer-friendly APIs to send emails and leverage [React Email](https://react.email/) for managing your email templates. For a more advanced React Email tutorial, refer to [this guide](/docs/guides/functions/examples/auth-send-email-hook-react-email-resend).\n\nIf you want to send emails through the Supabase Resend integration, which uses Resend's SMTP server, check out [this integration](/partners/integrations/resend) instead.\n\nCreate a <code>.env</code> file with the following environment variables:\n\n`\n_10\nRESEND_API_KEY=your_resend_api_key\n_10\nSEND_EMAIL_HOOK_SECRET=<base64_secret>\n`\n\nYou can generate the secret in the [Auth Hooks](/dashboard/project/_/auth/hooks) section of the Supabase dashboard. Make sure to remove the <code>v1,whsec_</code> prefix!\n\nSet the secrets in your Supabase project:\n\n`\n_10\nsupabase secrets set --env-file .env\n`\n\nCreate a new edge function:\n\n`\n_10\nsupabase functions new send-email\n`\n\nAdd the following code to your edge function:\n\n``\n_61\nimport { Webhook } from \"https://esm.sh/standardwebhooks@1.0.0\";\n_61\nimport { Resend } from \"npm:resend\";\n_61\n_61\nconst resend = new Resend(Deno.env.get(\"RESEND_API_KEY\") as string);\n_61\nconst hookSecret = Deno.env.get(\"SEND_EMAIL_HOOK_SECRET\") as string;\n_61\n_61\nDeno.serve(async (req) => {\n_61\nif (req.method !== \"POST\") {\n_61\n    return new Response(\"not allowed\", { status: 400 });\n_61\n}\n_61\n_61\nconst payload = await req.text();\n_61\nconst headers = Object.fromEntries(req.headers);\n_61\nconst wh = new Webhook(hookSecret);\n_61\ntry {\n_61\n    const { user, email_data } = wh.verify(payload, headers) as {\n_61\n      user: {\n_61\n        email: string;\n_61\n      };\n_61\n      email_data: {\n_61\n        token: string;\n_61\n        token_hash: string;\n_61\n        redirect_to: string;\n_61\n        email_action_type: string;\n_61\n        site_url: string;\n_61\n        token_new: string;\n_61\n        token_hash_new: string;\n_61\n      };\n_61\n    };\n_61\n_61\n    const { error } = await resend.emails.send({\n_61\n      from: \"welcome <onboarding@example.com>\",\n_61\n      to: [user.email],\n_61\n      subject: \"Welcome to my site!\",\n_61\n      text: <code>Confirm you signup with this code: ${email_data.token}</code>,\n_61\n    });\n_61\n    if (error) {\n_61\n      throw error;\n_61\n    }\n_61\n} catch (error) {\n_61\n    return new Response(\n_61\n      JSON.stringify({\n_61\n"
    }
  },
  {
    "chunk_id": "38b64a47-8494-4841-9d98-2b1c7b9c0bab",
    "metadata": {
      "token_count": 232,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/send-email-hook",
      "page_title": "Send Email Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Send Email Hook",
        "h2": "Use a custom email provider to send authentication messages",
        "h3": ""
      },
      "text": "    });\n_61\n    if (error) {\n_61\n      throw error;\n_61\n    }\n_61\n} catch (error) {\n_61\n    return new Response(\n_61\n      JSON.stringify({\n_61\n        error: {\n_61\n          http_code: error.code,\n_61\n          message: error.message,\n_61\n        },\n_61\n      }),\n_61\n      {\n_61\n        status: 401,\n_61\n        headers: { \"Content-Type\": \"application/json\" },\n_61\n      },\n_61\n    );\n_61\n}\n_61\n_61\nconst responseHeaders = new Headers();\n_61\nresponseHeaders.set(\"Content-Type\", \"application/json\");\n_61\nreturn new Response(JSON.stringify({}), {\n_61\n    status: 200,\n_61\n    headers: responseHeaders,\n_61\n});\n_61\n});\n``\n\nDeploy your edge function and [configure it as a hook](/dashboard/project/_/auth/hooks):\n\n`\n_10\nsupabase functions deploy send-email --no-verify-jwt\n`\n"
    }
  },
  {
    "chunk_id": "e1b3ae53-ef0b-4568-8c4e-ba776dfd6384",
    "metadata": {
      "token_count": 801,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/send-sms-hook",
      "page_title": "Send SMS Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Send SMS Hook",
        "h2": "Use a custom SMS provider to send authentication messages",
        "h3": ""
      },
      "text": "Auth\nRuns before a message is sent. Use the hook to:\n\n- Use a regional SMS Provider\n- Use alternate messaging channels such as WhatsApp\n- Adjust the message body to include platform specific fields such as the [AppHash](https://developers.google.com/identity/sms-retriever/overview)\n\n**Inputs**\n\n| Field | Type | Description |\n| --- | --- | --- |\n| <code>user</code> | [<code>User</code>](/docs/guides/auth/users#the-user-object) | The user attempting to sign in. |\n| <code>sms</code> | <code>object</code> | Metadata specific to the SMS sending process. Includes the OTP. |\n\nJSONJSON Schema\n\n`\n_42\n{\n_42\n\"user\": {\n_42\n    \"id\": \"6481a5c1-3d37-4a56-9f6a-bee08c554965\",\n_42\n    \"aud\": \"authenticated\",\n_42\n    \"role\": \"authenticated\",\n_42\n    \"email\": \"\",\n_42\n    \"phone\": \"+1333363128\",\n_42\n    \"phone_confirmed_at\": \"2024-05-13T11:52:48.157306Z\",\n_42\n    \"confirmation_sent_at\": \"2024-05-14T12:31:52.824573Z\",\n_42\n    \"confirmed_at\": \"2024-05-13T11:52:48.157306Z\",\n_42\n    \"phone_change_sent_at\": \"2024-05-13T11:47:02.183064Z\",\n_42\n    \"last_sign_in_at\": \"2024-05-13T11:52:48.162518Z\",\n_42\n    \"app_metadata\": {\n_42\n      \"provider\": \"phone\",\n_42\n      \"providers\": [\"phone\"]\n_42\n    },\n_42\n    \"user_metadata\": {},\n_42\n    \"identities\": [\\\n_42\\\n      {\\\n_42\\\n        \"identity_id\": \"3be5e552-65aa-41d9-9db9-2a502f845459\",\\\n_42\\\n        \"id\": \"6481a5c1-3d37-4a56-9f6a-bee08c554965\",\\\n_42\\\n        \"user_id\": \"6481a5c1-3d37-4a56-9f6a-bee08c554965\",\\\n_42\\\n        \"identity_data\": {\\\n_42\\\n          \"email_verified\": false,\\\n_42\\\n          \"phone\": \"+1612341244428\",\\\n_42\\\n          \"phone_verified\": true,\\\n_42\\\n          \"sub\": \"6481a5c1-3d37-4a56-9f6a-bee08c554965\"\\\n_42\\\n        },\\\n_42\\\n        \"provider\": \"phone\",\\\n_42\\\n        \"last_sign_in_at\": \"2024-05-13T11:52:48.155562Z\",\\\n_42\\\n        \"created_at\": \"2024-05-13T11:52:48.155599Z\",\\\n_42\\\n        \"updated_at\": \"2024-05-13T11:52:48.159391Z\"\\\n_42\\\n      }\\\n_42\\\n    ],\n_42\n    \"created_at\": \"2024-05-13T11:45:33.7738Z\",\n_42\n    \"updated_at\": \"2024-05-14T12:31:52.82475Z\",\n_42\n    \"is_anonymous\": false\n_42\n},\n_42\n\"sms\": {\n_42\n"
    }
  },
  {
    "chunk_id": "a9cd4e26-4dcd-4f4c-add1-25b6584ac237",
    "metadata": {
      "token_count": 849,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/send-sms-hook",
      "page_title": "Send SMS Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Send SMS Hook",
        "h2": "Use a custom SMS provider to send authentication messages",
        "h3": ""
      },
      "text": "42\n    \"updated_at\": \"2024-05-14T12:31:52.82475Z\",\n_42\n    \"is_anonymous\": false\n_42\n},\n_42\n\"sms\": {\n_42\n    \"otp\": \"561166\"\n_42\n}\n_42\n}\n`\n\n**Outputs**\n\n- No outputs are required. An empty response with a status code of 200 is taken as a successful response.\n\nSQLHTTP\n\nQueue SMS Messages\n\nYour company uses a worker to manage all messaging related jobs. For performance reasons, the messaging system sends messages in intervals via a job queue. Instead of sending a message immediately, messages are queued and sent in periodic intervals via <code>pg_cron</code>.\n\nCreate a table to store jobs\n\n`\n_10\ncreate table job_queue (\n_10\njob_id uuid primary key default gen_random_uuid(),\n_10\njob_data jsonb not null,\n_10\ncreated_at timestamp default now(),\n_10\nstatus text default 'pending',\n_10\npriority int default 0,\n_10\nretry_count int default 0,\n_10\nmax_retries int default 2,\n_10\nscheduled_at timestamp default now()\n_10\n);\n`\n\nCreate the hook:\n\n`\n_31\ncreate or replace function send_sms(event jsonb) returns void as $$\n_31\ndeclare\n_31\n    job_data jsonb;\n_31\n    scheduled_time timestamp;\n_31\n    priority int;\n_31\nbegin\n_31\n    -- extract phone and otp from the event json\n_31\n    job_data := jsonb_build_object(\n_31\n        'phone', event->'user'->>'phone',\n_31\n        'otp', event->'sms'->>'otp'\n_31\n    );\n_31\n_31\n    -- calculate the nearest 5-minute window for scheduled_time\n_31\n    scheduled_time := date_trunc('minute', now()) + interval '5 minute' * floor(extract('epoch' from (now() - date_trunc('minute', now())) / 60) / 5);\n_31\n_31\n    -- assign priority dynamically (example logic: higher priority for earlier scheduled time)\n_31\n    priority := extract('epoch' from (scheduled_time - now()))::int;\n_31\n_31\n    -- insert the job into the job_queue table\n_31\n    insert into job_queue (job_data, priority, scheduled_at, max_retries)\n_31\n    values (job_data, priority, scheduled_time, 2);\n_31\nend;\n_31\n$$ language plpgsql;\n_31\n_31\ngrant all\n_31\non table public.job_queue\n_31\nto supabase_auth_admin;\n_31\n_31\nrevoke all\n_31\non table public.job_queue\n_31\nfrom authenticated, anon;\n`\n\nCreate a function to periodically run and dequeue all jobs\n\n`\n_42\ncreate or replace function dequeue_and_run_jobs() returns void as $$\n_42\ndeclare\n_42\n    job record;\n_42\nbegin\n_42\n    for job in\n_42\n        select * from job_queue\n_42\n        where status = 'pending'\n_42\n          and scheduled_at <= now()\n_42\n        order by priority desc, created_at\n_42\n        for update skip locked\n_42\n    loop\n_42\n        begin\n_42\n            -- add job processing logic here.\n_42\n            -- for demonstration, we'll just update the job status to 'completed'.\n_42\n            update job_queue\n_42\n            set status = 'completed'\n_42\n            where job_id = job.job_id;\n_42\n_42\n        exception when others then\n_42\n            -- handle job failure and retry logic\n_42\n            if job.retry_count < job.max_retries then\n_42\n                update job_queue\n_42\n                set retry_count = retry_count + 1,\n_42\n"
    }
  },
  {
    "chunk_id": "a5533c2c-1bf0-4776-9573-2388d4de9e63",
    "metadata": {
      "token_count": 333,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/send-sms-hook",
      "page_title": "Send SMS Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Send SMS Hook",
        "h2": "Use a custom SMS provider to send authentication messages",
        "h3": ""
      },
      "text": "\n            -- handle job failure and retry logic\n_42\n            if job.retry_count < job.max_retries then\n_42\n                update job_queue\n_42\n                set retry_count = retry_count + 1,\n_42\n                    scheduled_at = now() + interval '1 minute'  -- delay retry by 1 minute\n_42\n                where job_id = job.job_id;\n_42\n            else\n_42\n                update job_queue\n_42\n                set status = 'failed'\n_42\n                where job_id = job.job_id;\n_42\n            end if;\n_42\n        end;\n_42\n    end loop;\n_42\nend;\n_42\n$$ language plpgsql;\n_42\n_42\ngrant execute\n_42\non function public.dequeue_and_run_jobs\n_42\nto supabase_auth_admin;\n_42\n_42\nrevoke execute\n_42\non function public.dequeue_and_run_jobs\n_42\nfrom authenticated, anon;\n`\n\nConfigure <code>pg_cron</code> to run the job on an interval. You can use a tool like [crontab.guru](https://crontab.guru/) to check that your job is running on an appropriate schedule. Ensure that <code>pg_cron</code> is enabled under <code>Database > Extensions</code>\n\n`\n_10\nselect\n_10\ncron.schedule(\n_10\n    '* * * * *', -- this cron expression means every minute.\n_10\n    'select dequeue_and_run_jobs();'\n_10\n);\n`\n"
    }
  },
  {
    "chunk_id": "aad6184b-2e7d-4152-89b7-d4e69fd0cae9",
    "metadata": {
      "token_count": 150,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nLooking for guides on how to use Single Sign-On with the Supabase dashboard? Head on over to [Enable SSO for Your Organization](/docs/guides/platform/sso).\n\nSupabase Auth supports enterprise-level Single Sign-On (SSO) for any identity providers compatible with the SAML 2.0 protocol. This is a non-exclusive list of supported identity providers:\n\n- Google Workspaces (formerly known as GSuite)\n- Okta, Auth0\n- Microsoft Active Directory, Azure Active Directory, Microsoft Entra\n- PingIdentity\n- OneLogin\n\nIf you're having issues with identity provider software not on this list, please [open a support ticket](https://supabase.com/dashboard/support/new).\n"
    }
  },
  {
    "chunk_id": "6e17c72e-ec99-480e-86c1-1837552a2c1d",
    "metadata": {
      "token_count": 227,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Prerequisites \\#",
        "h3": ""
      },
      "text": " Active Directory, Azure Active Directory, Microsoft Entra\n- PingIdentity\n- OneLogin\n\nIf you're having issues with identity provider software not on this list, please [open a support ticket](https://supabase.com/dashboard/support/new).\nThis guide requires the use of the [Supabase CLI](/docs/guides/cli). Please make sure you're using version v1.46.4 or higher. You can use <code>supabase -v</code> to see the currently installed version.\n\nYou can use the <code>supabase sso</code> [subcommands](/docs/reference/cli/supabase-sso) to manage your project's configuration.\n\nSAML 2.0 support is disabled by default on Supabase projects. You can configure this on the [Auth Providers](https://supabase.com/dashboard/project/_/auth/providers) page on your project.\n\nPlease note that SAML 2.0 support is offered on plans Pro and above. Check the [Pricing](https://supabase.com/pricing) page for more information.\n"
    }
  },
  {
    "chunk_id": "3355c441-e316-42b0-8631-6d26b39dda69",
    "metadata": {
      "token_count": 619,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Terminology \\#",
        "h3": ""
      },
      "text": "/dashboard/project/_/auth/providers) page on your project.\n\nPlease note that SAML 2.0 support is offered on plans Pro and above. Check the [Pricing](https://supabase.com/pricing) page for more information.\nThe number of SAML and SSO acronyms can often be overwhelming. Here's a glossary which you can refer back to at any time:\n\n- **Identity Provider**, **IdP**, or **IDP**\nAn identity provider is a service that manages user accounts at a company or organization. It can verify the identity of a user and exchange that information with your Supabase project and other applications. It acts as a single source of truth for user identities and access rights. Commonly used identity providers are: Microsoft Active Directory (Azure AD, Microsoft Entra), Okta, Google Workspaces (GSuite), PingIdentity, OneLogin, and many others. There are also self-hosted and on-prem versions of identity providers, and sometimes they are accessible only by having access to a company VPN or being in a specific building.\n- **Service Provider**, **SP**\nThis is the software that is asking for user information from an identity provider. In Supabase, this is your project's Auth server.\n- **Assertion**\nAn assertion is a statement issued by an identity provider that contains information about a user.\n- **EntityID**\nA globally unique ID (usually a URL) that identifies an Identity Provider or Service Provider across the world.\n- **NameID**\nA unique ID (usually an email address) that identifies a user at an Identity Provider.\n- **Metadata**\nAn XML document that describes the features and configuration of an Identity Provider or Service Provider. It can be as a standalone document or as a URL. Usually (but not always) the <code>EntityID</code> is the URL at which you can access the Metadata.\n- **Certificate**\nSupabase Auth (the Service Provider) trusts assertions from an Identity Provider based on the signature attached to the assertion. The signature is verified according to the certificate present in the Metadata.\n- **Assertion Consumer Service (ACS) URL**\nThis is one of the most important SAML URLs. It is the URL where Supabase Auth will accept assertions from an identity provider. Basically, once the identity provider verifies the user's identity it will redirect to this URL and the redirect request will contain the assertion.\n- **Binding (Redirect, POST, or Artifact)**\nThis is a description of the way an identity provider communicates with Supabase Auth. When using the Redirect binding, the communication occurs using HTTP 301 redirects. When it's <code>POST</code>, it's using <code>POST</code> requests sent with <code><form></code> elements on a page. When using Artifact, it's using a more secure exchange over a Redirect or <code>POST</code>.\n- **RelayState**\nState used by Supabase Auth to hold information about a request to verify the identity of a user.\n"
    }
  },
  {
    "chunk_id": "c29eead6-f93f-4371-99ac-71b3134cb62c",
    "metadata": {
      "token_count": 389,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Important SAML 2.0 information \\#",
        "h3": ""
      },
      "text": ". When using Artifact, it's using a more secure exchange over a Redirect or <code>POST</code>.\n- **RelayState**\nState used by Supabase Auth to hold information about a request to verify the identity of a user.\nBelow is information about your project's SAML 2.0 configuration which you can share with the company or organization that you're trying to on-board.\n\n| Name | Value |\n| --- | --- |\n| EntityID | <code>https://<project>.supabase.co/auth/v1/sso/saml/metadata</code> |\n| Metadata URL | <code>https://<project>.supabase.co/auth/v1/sso/saml/metadata</code> |\n| Metadata URL<br>(download) | <code>https://<project>.supabase.co/auth/v1/sso/saml/metadata?download=true</code> |\n| ACS URL | <code>https://<project>.supabase.co/auth/v1/sso/saml/acs</code> |\n| SLO URL | <code>https://<project>.supabase.co/auth/v1/sso/slo</code> |\n| NameID | Required <code>emailAddress</code> or <code>persistent</code> |\n\nNote that SLO (Single Logout) is not supported at this time with Supabase Auth as it is a rarely supported feature by identity providers. However, the URL is registered and advertised for when this does become available.\n\nAppend <code>?download=true</code> to the Metadata URL to download the Metadata XML file. This is useful in cases where the identity provider requires a file.\n\nAlternatively, you can use the <code>supabase sso info --project-ref <your-project></code> [command](/docs/reference/cli/supabase-sso-info) to get setup information for your project.\n"
    }
  },
  {
    "chunk_id": "d5091403-309b-40af-9fe8-0994acb74362",
    "metadata": {
      "token_count": 248,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Important SAML 2.0 information \\#",
        "h3": "User accounts and identities \\#"
      },
      "text": " a file.\n\nAlternatively, you can use the <code>supabase sso info --project-ref <your-project></code> [command](/docs/reference/cli/supabase-sso-info) to get setup information for your project.\nUser accounts and identities created via SSO differ from regular (email, phone, password, social login...) accounts in these ways:\n\n- **No automatic linking.**\nEach user account verified using a SSO identity provider will not be automatically linked to existing user accounts in the system. That is, if a user <code>jane.doe@company.com</code> had signed up with a password, and then uses their company SSO login with your project, there will be two <code>jane.doe@company.com</code> user accounts in the system.\n- **Emails are not necessarily unique.**\nGiven the behavior with no automatic linking, email addresses are no longer a unique identifier for a user account. Please always use the user's UUID to correctly reference user accounts.\n- **Sessions may have a maximum duration.**\nDepending on the configuration of the identity provider, a login session established with SSO may forcibly log out a user after a certain period of time.\n"
    }
  },
  {
    "chunk_id": "08f75a25-e6cf-4a46-a5a4-ac7e0fb95d46",
    "metadata": {
      "token_count": 524,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Important SAML 2.0 information \\#",
        "h3": "Row Level Security \\#"
      },
      "text": " use the user's UUID to correctly reference user accounts.\n- **Sessions may have a maximum duration.**\nDepending on the configuration of the identity provider, a login session established with SSO may forcibly log out a user after a certain period of time.\nYou can use information about the SSO identity provider in Row Level Security policies.\n\nHere are some commonly used statements to extract SSO related information from the user's JWT:\n\n- <code>auth.jwt()#>>'{amr,0,method}'</code>\nReturns the name of the last method used to verify the identity of this user. With SAML SSO this is <code>sso/saml</code>.\n- <code>auth.jwt()#>>'{amr,0,provider}'</code>\nReturns the UUID of the SSO identity provider used by the user to sign-in.\n- <code>auth.jwt()#>>'{user_metadata,iss}'</code>\nReturns the identity provider's SAML 2.0 <code>EntityID</code>\n\nIf you use [Multi-Factor Authentication](/docs/guides/auth/auth-mfa) with SSO, the <code>amr</code> array may have a different method at index <code>0</code>!\n\nA common use case with SSO is to use the UUID of the identity provider as the identifier for the organization the user belongs to -- frequently known as a tenant. By associating the identity provider's UUID with your tenants, you can use restrictive RLS policies to scope down actions and data that a user is able to access.\n\nFor example, let's say you have a table like:\n\n`\n_10\ncreate table organization_settings (\n_10\n  -- the organization's unique ID\n_10\nid uuid not null primary key,\n_10\n  -- the organization's SSO identity provider\n_10\nsso_provider_id uuid unique,\n_10\n  -- name of the organization\n_10\nname text,\n_10\n  -- billing plan (paid, Free, Enterprise)\n_10\nbilling_plan text\n_10\n);\n`\n\nYou can use the information present in the user's JWT to scope down which rows from this table the user can see, without doing any additional user management:\n\n`\n_10\nCREATE POLICY \"View organization settings.\"\n_10\nON organization_settings\n_10\nAS RESTRICTIVE\n_10\nUSING (\n_10\n    sso_provider_id = (select auth.jwt()#>>'{amr,0,provider}')\n_10\n);\n`\n"
    }
  },
  {
    "chunk_id": "c047f0a3-2b40-43f3-b8b2-2dcabc71201c",
    "metadata": {
      "token_count": 788,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Managing SAML 2.0 connections \\#",
        "h3": "Add a connection \\#"
      },
      "text": "_10\nON organization_settings\n_10\nAS RESTRICTIVE\n_10\nUSING (\n_10\n    sso_provider_id = (select auth.jwt()#>>'{amr,0,provider}')\n_10\n);\n`\nOnce you've enabled SAML 2.0 support on your project via the [Auth Providers](https://supabase.com/dashboard/project/_/auth/providers) page in the dashboard, you can use the [Supabase CLI](/docs/reference/cli/supabase-sso) to add, update, remove and view information about identity providers.\nTo establish a connection to a SAML 2.0 Identity Provider (IdP) you will need:\n\n- A SAML 2.0 Metadata XML file, or a SAML 2.0 Metadata URL pointing to an XML file\n- (Optional) Email domains that the organization's IdP uses\n- (Optional) Attribute mappings between the user properties of the IdP and the claims stored by Supabase Auth\n\nYou should obtain the SAML 2.0 Metadata XML file or URL from the organization whose IdP you wish to connect. Most SAML 2.0 Identity Providers support the Metadata URL standard, and we recommend using a URL if this is available.\n\nCommonly used SAML 2.0 Identity Providers that support Metadata URLs:\n\n- Okta\n- Azure AD (Microsoft Entra)\n- PingIdentity\n\nCommonly used SAML 2.0 Identity Providers that only support Metadata XML files:\n\n- Google Workspaces (GSuite)\n- Any self-hosted or on-prem identity provider behind a VPN\n\nOnce you've obtained the SAML 2.0 Metadata XML file or URL you can [establish a connection](/docs/reference/cli/supabase-sso-add) with your project's Supabase Auth server by running:\n\n`\n_10\nsupabase sso add --type saml --project-ref <your-project> \\\n_10\n  --metadata-url 'https://company.com/idp/saml/metadata' \\\n_10\n  --domains company.com\n`\n\nIf you wish to use a Metadata XML file instead, you can use:\n\n`\n_10\nsupabase sso add --type saml --project-ref <your-project> \\\n_10\n  --metadata-file /path/to/saml/metadata.xml \\\n_10\n  --domains company.com\n`\n\nThis command will register a new identity provider with your project's Auth server. When successful, you will see the details of the provider such as it's SAML information and registered domains.\n\nPlease note that only persons with write access to the project can register, update or remove identity providers.\n\nOnce you've added an identity provider, users who have access to it can sign in to your application. With SAML 2.0 there are two ways that users can sign in to your project:\n\n- By signing-in from your application's user interface, commonly known as **SP (Service Provider) Initiated Flow**\n- By clicking on an icon in the application menu on the company intranet or identity provider page, commonly known as **Identity Provider Initiated (IdP) Flow**\n\nTo initiate a sign-in request from your application's user interface (i.e. the SP Initiated Flow), you can use:\n\nJavaScriptDartSwiftKotlin\n\n`\n_10\nsupabase.auth.signInWithSSO({\n_10\ndomain: 'company.com',\n_10\n})\n`\n\nCalling [<code>signInWithSSO</code>](/docs/reference/javascript/auth-signinwithsso) starts the sign-in process using the identity provider registered for the <code>company.com</code> domain name. It is not required that identity providers be assigned one or multiple domain names, in which case you can use the provider's unique ID instead.\n"
    }
  },
  {
    "chunk_id": "ab73ab47-c25b-4a77-9c91-ebc202c80e7a",
    "metadata": {
      "token_count": 832,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Managing SAML 2.0 connections \\#",
        "h3": "Understanding attribute mappings \\#"
      },
      "text": " the sign-in process using the identity provider registered for the <code>company.com</code> domain name. It is not required that identity providers be assigned one or multiple domain names, in which case you can use the provider's unique ID instead.\nWhen a user signs in using the SAML 2.0 Single Sign-On protocol, an XML document called the SAML Assertion is exchanged between the identity provider and Supabase Auth.\n\nThis assertion contains information about the user's identity and other authentication information, such as:\n\n- Unique ID of the user (called <code>NameID</code> in SAML)\n- Email address\n- Name of the user\n- Department or organization\n- Other attributes present in the users directory managed by the identity provider\n\nWith exception of the unique user ID, SAML does not require any other attributes in the assertion. Identity providers can be configured so that only select user information is shared with your project.\n\nYour project can be configured to recognize these attributes and map them into your project's database using a JSON structure. This process is called attribute mapping, and varies according to the configuration of the identity provider.\n\nFor example, the following JSON structure configures attribute mapping for the <code>email</code> and <code>first_name</code> user identity properties.\n\n`\n_10\n{\n_10\n\"keys\": {\n_10\n    \"email\": {\n_10\n      \"name\": \"mail\"\n_10\n    },\n_10\n    \"first_name\": {\n_10\n      \"name\": \"givenName\"\n_10\n    }\n_10\n}\n_10\n}\n`\n\nWhen creating or updating an identity provider with the [Supabase CLI](/docs/guides/cli) you can include this JSON as a file with the <code>--attribute-mapping-file /path/to/attribute/mapping.json</code> flag.\n\nFor example, to change the attribute mappings to an existing provider you can use:\n\n`\n_10\nsupabase sso update <provider-uuid> --project-ref <your-project> \\\n_10\n  --attribute-mapping-file /path/to/attribute/mapping.json\n`\n\nGiven a SAML 2.0 assertion that includes these attributes:\n\n`\n_21\n<saml:AttributeStatement>\n_21\n<!-- will be mapped to the email key -->\n_21\n<saml:Attribute\n_21\n    Name=\"mail\"\n_21\n    NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\"\n_21\n    >\n_21\n    <saml:AttributeValue xsi:type=\"xs:string\">\n_21\n      jane.doe@company.com\n_21\n    </saml:AttributeValue>\n_21\n</saml:Attribute>\n_21\n_21\n<!-- will be mapped to the first_name key -->\n_21\n<saml:Attribute\n_21\n    Name=\"givenName\"\n_21\n    NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\"\n_21\n    >\n_21\n    <saml:AttributeValue xsi:type=\"xs:string\">\n_21\n      Jane Doe\n_21\n    </saml:AttributeValue>\n_21\n</saml:Attribute>\n_21\n</saml:AttributeStatement>\n`\n\nWill result in the following claims in the user's identity in the database and JWT:\n\n`\n_10\n{\n_10\n\"email\": \"jane.doe@company.com\",\n_10\n\"custom_claims\": {\n_10\n    \"first_name\": \"Jane Doe\"\n_10\n}\n_10\n}\n`\n\nSupabase Auth does not require specifying attribute mappings if you only need access to the user's email. It will attempt to find an email attribute specified in the assertion. All other properties will not be automatically included, and it is those you need to map.\n\nAt this time it is not possible to have users without an email address, so SAML assertions without one will be rejected.\n\n"
    }
  },
  {
    "chunk_id": "0c7b985e-ca39-494d-95a5-55bcb1b33fd4",
    "metadata": {
      "token_count": 278,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Managing SAML 2.0 connections \\#",
        "h3": "Understanding attribute mappings \\#"
      },
      "text": " email attribute specified in the assertion. All other properties will not be automatically included, and it is those you need to map.\n\nAt this time it is not possible to have users without an email address, so SAML assertions without one will be rejected.\n\nMost SAML 2.0 identity providers use Lightweight Directory Access Protocol (LDAP) attribute names. However, due to their variability and complexity operators of identity providers are able to customize both the <code>Name</code> and attribute value that is sent to Supabase Auth in an assertion. Please refer to the identity provider's documentation and contact the operator for details on what attributes are mapped for your project.\n\n**Accessing the stored attributes**\n\nThe stored attributes, once mapped, show up in the access token (a JWT) of the user. If you need to look these values up in the database, you can find them in the <code>auth.identities</code> table under the <code>identity_data</code> JSON column. Identities created for SSO providers have <code>sso:<uuid-of-provider></code> in the <code>provider</code> column, while <code>id</code> contains the unique NameID of the user account.\n\nFurthermore, you can find the same identity data under <code>raw_app_meta_data</code> inside <code>auth.users</code>.\n"
    }
  },
  {
    "chunk_id": "eb7176e3-a9d4-4f89-b68f-b69f60030608",
    "metadata": {
      "token_count": 241,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Managing SAML 2.0 connections \\#",
        "h3": "Remove a connection \\#"
      },
      "text": "> column, while <code>id</code> contains the unique NameID of the user account.\n\nFurthermore, you can find the same identity data under <code>raw_app_meta_data</code> inside <code>auth.users</code>.\nOnce a connection to an identity provider is established, you can [remove it](/docs/reference/cli/supabase-sso-remove) by running:\n\n`\n_10\nsupabase sso remove <provider-id> --project-ref <your-project>\n`\n\nIf successful, the details of the removed identity provider will be shown. All user accounts from that identity provider will be immediately logged out. User information will remain in the system, but it will no longer be possible for any of those accounts to be accessed in the future, even if you add the connection again.\n\nIf you need to reassign those user accounts to another identity provider, please [open a support ticket](https://supabase.com/dashboard/support/new).\n\nA [list of all](/docs/reference/cli/supabase-sso-list) registered identity providers can be displayed by running:\n\n`\n_10\nsupabase sso list --project-ref <your-project>\n`\n"
    }
  },
  {
    "chunk_id": "d823b393-64e2-482c-9240-61482b089727",
    "metadata": {
      "token_count": 268,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Managing SAML 2.0 connections \\#",
        "h3": "Update a connection \\#"
      },
      "text": ".com/dashboard/support/new).\n\nA [list of all](/docs/reference/cli/supabase-sso-list) registered identity providers can be displayed by running:\n\n`\n_10\nsupabase sso list --project-ref <your-project>\n`\nYou may wish to update settings about a connection to a SAML 2.0 identity provider.\n\nCommonly this is necessary when:\n\n- Cryptographic keys are rotated or have expired\n- Metadata URL has changed, but is the same identity provider\n- Other SAML 2.0 Metadata attributes have changed, but it is still the same identity provider\n- You are updating the domains or attribute mapping\n\nYou can use this command to [update](/docs/reference/cli/supabase-sso-update) the configuration of an identity provider:\n\n`\n_10\nsupabase sso update <provider-id> --project-ref <your-project>\n`\n\nPlease use <code>--help</code> to see all available flags.\n\nIt is not possible to change the unique SAML identifier of the identity provider, known as <code>EntityID</code>. Everything else can be updated. If the SAML <code>EntityID</code> of your identity provider has changed, it is regarded as a new identity provider and you will have to register it like a new connection.\n"
    }
  },
  {
    "chunk_id": "1b1afa2e-db48-48b0-a0d7-4a4a895be977",
    "metadata": {
      "token_count": 200,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Managing SAML 2.0 connections \\#",
        "h3": "Retrieving information about a connection \\#"
      },
      "text": "EntityID</code>. Everything else can be updated. If the SAML <code>EntityID</code> of your identity provider has changed, it is regarded as a new identity provider and you will have to register it like a new connection.\nYou can always obtain a [list](/docs/reference/cli/supabase-sso-list) of all registered providers using:\n\n`\n_10\nsupabase sso list --project-ref <your-project>\n`\n\nThis list will only include basic information about each provider. To see [all of the information](/docs/reference/cli/supabase-sso-show) about a provider you can use:\n\n`\n_10\nsupabase sso show <provider-id> --project-ref <your-project>\n`\n\nYou can use the <code>-o json</code> flag to output the information as JSON, should you need to. Other formats may be supported, please use <code>--help</code> to see all available options.\n"
    }
  },
  {
    "chunk_id": "65fc6761-6086-454a-9f7b-88142fb84826",
    "metadata": {
      "token_count": 210,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Frequently asked questions \\#",
        "h3": "How do I publish my application to an identity provider's marketplace? \\#"
      },
      "text": "your-project>\n`\n\nYou can use the <code>-o json</code> flag to output the information as JSON, should you need to. Other formats may be supported, please use <code>--help</code> to see all available options.\nMany cloud-based identity providers offer a marketplace where you can register your application for easy on-boarding with customers. When you use Supabase Auth's SAML 2.0 support you can register your project in any one of these marketplaces.\n\nPlease refer to the relevant documentation for each cloud-based identity provider on how you can do this. Some common marketplaces are:\n\n- [Okta Integration Network](https://developer.okta.com/docs/guides/build-sso-integration/saml2/main/)\n- [Azure Active Directory App Gallery](https://learn.microsoft.com/en-us/azure/active-directory-b2c/publish-app-to-azure-ad-app-gallery)\n- [Google Workspaces Pre-integrated SAML apps catalog](https://support.google.com/a/table/9217027)\n"
    }
  },
  {
    "chunk_id": "30c2e6a4-ec4e-4938-ae6e-740fc5c65a42",
    "metadata": {
      "token_count": 303,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Frequently asked questions \\#",
        "h3": "Why do some users get: SAML assertion does not contain email address? \\#"
      },
      "text": "https://learn.microsoft.com/en-us/azure/active-directory-b2c/publish-app-to-azure-ad-app-gallery)\n- [Google Workspaces Pre-integrated SAML apps catalog](https://support.google.com/a/table/9217027)\nIdentity providers do not have to send back and email address for the user, though they often do. Supabase Auth requires that an email address is present.\n\nThe following list of commonly used SAML attribute names is inspected, in order of appearance, to discover the email address in the assertion:\n\n- <code>urn:oid:0.9.2342.19200300.100.1.3</code>\n- <code>http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress</code>\n- <code>http://schemas.xmlsoap.org/claims/EmailAddress</code>\n- <code>mail</code>\n- <code>email</code>\n\nFinally if there is no such attribute, it will use the SAML <code>NameID</code> value but only if the format is advertised as <code>urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress</code>.\n\nShould you run into this problem, it is most likely a misconfiguration issue **on the identity provider side.** Please instruct your contact at the company to map the user's email address to one of the above listed attribute names, typically <code>email</code>.\n"
    }
  },
  {
    "chunk_id": "f8b35e0b-eee2-4788-b302-e2a70a274e32",
    "metadata": {
      "token_count": 160,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso/auth-sso-saml",
      "page_title": "Single Sign-On with SAML 2.0 for Projects | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Single Sign-On with SAML 2.0 for Projects",
        "h2": "Frequently asked questions \\#",
        "h3": "How do I access the private key used for SAML in my project? \\#"
      },
      "text": " this problem, it is most likely a misconfiguration issue **on the identity provider side.** Please instruct your contact at the company to map the user's email address to one of the above listed attribute names, typically <code>email</code>.\nAt this time it is not possible to extract the RSA private key used by your project's Supabase Auth server. This is done to keep the private key as secure as possible, given that SAML does not offer an easy way to rotate keys without disrupting service. (Please use a SAML 2.0 Metadata URL whenever possible for this reason!)\n\nIf you really need access to the key, please [open a support ticket](https://supabase.com/dashboard/support/new) and we'll try to support you as best as possible.\n"
    }
  },
  {
    "chunk_id": "0fd8ede5-99d5-4589-aac8-b94fb0ea66eb",
    "metadata": {
      "token_count": 131,
      "source_url": "https://supabase.com/docs/guides/auth/jwts",
      "page_title": "JWTs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "JWTs",
        "h2": "JSON Web Tokens",
        "h3": ""
      },
      "text": "Auth\nA [JSON Web Token](https://jwt.io/introduction) is a type of data structure, represented as a string, that usually contains identity and authorization information about a user. It encodes information about its lifetime and is signed with a cryptographic key to make it tamper-resistant.\n\nSupabase Access Tokens are JWTs. The JWT is sent along with every request to Supabase services. By verifying the token and inspecting the included claims, you can allow or deny access to resources. [Row Level Security](/docs/guides/database/postgres/row-level-security) policies are based on the information present in JWTs.\n"
    }
  },
  {
    "chunk_id": "be5c8390-a75c-4588-99f4-c338b8940015",
    "metadata": {
      "token_count": 775,
      "source_url": "https://supabase.com/docs/guides/auth/jwts",
      "page_title": "JWTs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "JWTs",
        "h2": "Encoding and signing JWTs \\#",
        "h3": ""
      },
      "text": ". By verifying the token and inspecting the included claims, you can allow or deny access to resources. [Row Level Security](/docs/guides/database/postgres/row-level-security) policies are based on the information present in JWTs.\nJWTs are encoded and signed as follows.\n\nThe JSON object starts out looking something like this:\n\n`\n1\n{\n2\n\"sub\": \"0001\",\n3\n\"name\": \"Sam Vimes\",\n4\n\"iat\": 1516239022,\n5\n\"exp\": 1518239022\n6\n}\n`\n\n<code>sub</code> is the \"subject\", which is usually the UUID of the user. <code>name</code> is self-explanatory, and <code>iat</code> is the Unix timestamp at which the token was created. Many JWTs will also have an <code>exp</code>, which is the date at which the token is set to expire and can no longer be used. These are some of the standard fields you may find in a JWT, but you can pretty much store whatever you want in there, for example:\n\n`\n1\n{\n2\n\"sub\": \"0002\",\n3\n\"name\": \"V\u011bra Hrab\u00e1nkov\u00e1\",\n4\n\"iat\": 1516239022,\n5\n\"exp\": 1518239022,\n6\n\"theme\": {\n7\n      \"primary\" : \"#D80C14\",\n8\n      \"secondary\" : \"#FFFFFF\"\n9\n}\n10\n}\n`\n\nJust note that the more data you store in your token, the longer the encoded string will be.\n\nWhen we want to send the JWT to the user, we first encode the data using an algorithm such as <code>HS256</code>. There are many libraries (and several different algorithms) that can be used to do this encoding/decoding, such as [jsonwebtoken](https://www.npmjs.com/package/jsonwebtoken). The signing is as simple as:\n\n`\n1\n// from https://replit.com/@awalias/jsonwebtokens#index.js\n2\nlet token = jwt.sign({ name: 'Sam Vimes' }, 'some-secret')\n`\n\nAnd the resulting string will look like this:\n\n`\n1\neyJhbGciOiJIUzI1NiJ9\n2\n.eyJzdWIiOiIwMDAxIiwibmFtZSI6IlNhbSBWaW1lcyIsImlhdCI6MTUxNjIzOTAyMiwiZXhwIjoxNTE4MjM5MDIyfQ\n3\n.zMcHjKlkGhuVsiPIkyAkB2rjXzyzJsMMgpvEGvGtjvA\n`\n\nYou will notice that the string is actually made up of three components:\n\nThe first segment <code>eyJhbGciOiJIUzI1NiJ9</code> is known as the \"header\", and when decoded just tells us which algorithm was used to do the encoding:\n\n`\n1\n{\n2\n\"alg\": \"HS256\"\n3\n}\n`\n\nThe second segment <code>eyJzdWIiOiIwMDAxIiwibmFtZSI6IlNhbSBWaW1lcyIsImlhdCI6MTUxNjIzOTAyMiwiZXhwIjoxNTE4MjM5MDIyfQ</code> contains our original payload:\n\n`\n1\n{\n2\n\"sub\": \"0001\",\n3\n\"name\": \"Sam Vimes\",\n4\n\"iat\": 1516239022,\n5\n\"exp\": 1518239022\n6\n}\n`\n\n"
    }
  },
  {
    "chunk_id": "ed3d19ca-63ff-4028-926d-151efe8cdfb9",
    "metadata": {
      "token_count": 487,
      "source_url": "https://supabase.com/docs/guides/auth/jwts",
      "page_title": "JWTs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "JWTs",
        "h2": "Encoding and signing JWTs \\#",
        "h3": ""
      },
      "text": " payload:\n\n`\n1\n{\n2\n\"sub\": \"0001\",\n3\n\"name\": \"Sam Vimes\",\n4\n\"iat\": 1516239022,\n5\n\"exp\": 1518239022\n6\n}\n`\n\nThe last segment <code>zMcHjKlkGhuVsiPIkyAkB2rjXzyzJsMMgpvEGvGtjvA</code> is the signature itself, which is the part used by the website or service provider to verify that a token sent by some user is legitimate. It is produced in the first instance by running the cryptographic function HS256 on the following input:\n\n`\n1\nHMACSHA256(\n2\nbase64UrlEncode(header) + \".\" +\n3\nbase64UrlEncode(payload)\n4\n<jwt_secret>\n5\n)\n`\n\nYou can test out minting your own tokens on [https://jwt.io](https://jwt.io).\n\nIt is important to note that anyone who possesses the <code>jwt_secret</code> here can create new tokens, and also verify existing ones. More advanced JWT algorithms use two secrets: one for the creation of tokens, and a separate one to verify the validity of signed tokens.\n\nYou might wonder why JWTs are so popular all of a sudden. The answer is that with the mass adoption of microservice architecture, we were in a situation where several distinct microservices (APIs, websites, servers, etc.) want to easily validate that a user is who they say they are, or are in other words a \"logged-in\" user. Traditional session tokens are no use here, since they would require each microservice to either maintain a record of currently valid session tokens or to query a central database each time a user wants to access a resource in order to check the validity of the session token \u2013 very inefficient indeed. JWT-based auth in this sense is decentralized, since anyone with the <code>jwt_secret</code> can verify a token without needing access to a centralized database.\n\nNote: One downside of JWTs is that they are not easily voidable, like session tokens. If a JWT is leaked to a malicious actor, they will be able to redeem it anywhere until the expiry date is reached \u2013 unless of course the system owner updates the <code>jwt_secret</code> (which will of course invalidate _everyone's_ existing tokens).\n"
    }
  },
  {
    "chunk_id": "cf92fe36-385b-423c-a49f-6b7934838863",
    "metadata": {
      "token_count": 749,
      "source_url": "https://supabase.com/docs/guides/auth/jwts",
      "page_title": "JWTs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "JWTs",
        "h2": "JWTs in Supabase \\#",
        "h3": ""
      },
      "text": " leaked to a malicious actor, they will be able to redeem it anywhere until the expiry date is reached \u2013 unless of course the system owner updates the <code>jwt_secret</code> (which will of course invalidate _everyone's_ existing tokens).\nIn Supabase we issue JWTs for three different purposes:\n\n1. <code>anon key</code>: This key is used to bypass the Supabase API gateway and can be used in your client-side code.\n2. <code>service role key</code>: This key has super admin rights and can bypass your Row Level Security. Do not put it in your client-side code. Keep it private.\n3. <code>user specific jwts</code>: These are tokens we issue to users who log into your project/service/website. It's the modern equivalent of a session token, and can be used by a user to access content or permissions specific to them.\n\nThe first token here, the <code>anon key</code> token, is for developers to send along with their API requests whenever they want to interact with their Supabase database.\n\nLet's say you want to read the names of all the rows in a table <code>colors</code>. We would make a request like:\n\n`\n1\ncurl 'https://xscduanzzfseqszwzhcy.supabase.co/rest/v1/colors?select=name' \\\n2\n-H \"apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYxNDIwNTE3NCwiZXhwIjoxOTI5NzgxMTc0fQ.-NBR1WnZyQGpRLdXJfgfpszoZ0EeE6KHatJsDPLIX8c\"\n`\n\nIf we put this token into [https://jwt.io](https://jwt.io), we see it decodes to:\n\n`\n1\n{\n2\n\"role\": \"anon\",\n3\n\"iss\": \"supabase\",\n4\n\"iat\": 1614205174,\n5\n\"exp\": 1929781174\n6\n}\n`\n\nThis JWT is signed by a <code>jwt_secret</code> specific to the developer's Supabase token (you can find this secret alongside this encoded \"anon key\" on your Dashboard under Settings > API page) and is required to get past the Supabase API gateway and access the developer's project.\n\nThe idea with this particular key is that it's safe to put into your client, meaning it's okay if your end users see this key \u2013 but _only_ if you first enable Row Level Security.\n\nThe second key, <code>service role key</code>, should only ever be used on one of your own servers or environments, and should never be shared with end users. You might use this token to do things like make batch inserts of data.\n\nThe <code>user access token</code> is the JWT issued when you call for example:\n\n`\n1\nsupabase.auth.signIn({\n2\nemail: 'lao.gimmie@gov.sg',\n3\npassword: 'They_Live_1988!',\n4\n})\n`\n\nThis token should be passed in addition to the <code>apikey</code> header as an <code>Authorization Bearer</code> header like:\n\n`\n1\ncurl 'https://xscduanzzfseqszwzhcy.supabase.co/rest/v1/colors?select=name' \\\n2\n"
    }
  },
  {
    "chunk_id": "8804eff4-6cd4-4dac-b623-c96bb0256a2f",
    "metadata": {
      "token_count": 600,
      "source_url": "https://supabase.com/docs/guides/auth/jwts",
      "page_title": "JWTs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "JWTs",
        "h2": "JWTs in Supabase \\#",
        "h3": ""
      },
      "text": "code> header as an <code>Authorization Bearer</code> header like:\n\n`\n1\ncurl 'https://xscduanzzfseqszwzhcy.supabase.co/rest/v1/colors?select=name' \\\n2\n-H \"apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYxNDIwNTE3NCwiZXhwIjoxOTI5NzgxMTc0fQ.-NBR1WnZyQGpRLdXJfgfpszoZ0EeE6KHatJsDPLIX8c\" \\\n3\n-H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNjE1ODI0Mzg4LCJzdWIiOiIwMzM0NzQ0YS1mMmEyLTRhYmEtOGM4YS02ZTc0OGY2MmExNzIiLCJlbWFpbCI6InNvbWVvbmVAZW1haWwuY29tIiwiYXBwX21ldGFkYXRhIjp7InByb3ZpZGVyIjoiZW1haWwifSwidXNlcl9tZXRhZGF0YSI6bnVsbCwicm9sZSI6ImF1dGhlbnRpY2F0ZWQifQ.I-_oSsJamtinGxniPETBf-ezAUwDW2sY9bJIThvdX9s\"\n`\n\nYou'll notice that this token is quite a bit longer, since it contains information specific to the user such as:\n\n`\n1\n{\n2\n\"aud\": \"authenticated\",\n3\n\"exp\": 1615824388,\n4\n\"sub\": \"0334744a-f2a2-4aba-8c8a-6e748f62a172\",\n5\n\"email\": \"d.l.solove@gmail.com\",\n6\n\"app_metadata\": {\n7\n    \"provider\": \"email\"\n8\n},\n9\n\"user_metadata\": null,\n10\n\"role\": \"authenticated\"\n11\n}\n`\n\nNow that you understand what JWTs are and where they're used in Supabase, you can explore how to use them in combination with Row Level Security to start restricting access to certain tables, rows, and columns in your Postgres database.\n- JWT debugger: [https://jwt.io/](https://jwt.io/)\n"
    }
  },
  {
    "chunk_id": "9df9a317-cac9-4c01-b1b8-f1efe5b66db9",
    "metadata": {
      "token_count": 784,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/password-verification-hook",
      "page_title": "Password Verification Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password Verification Hook",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nYour company wishes to increase security beyond the requirements of the default password implementation in order to fulfill security or compliance requirements. You plan to track the status of a password sign-in attempt and take action via an email or a restriction on logins where necessary.\n\nAs this hook runs on unauthenticated requests, malicious users can abuse the hook by calling it multiple times. Pay extra care when using the hook as you can unintentionally block legitimate users from accessing your application.\n\nCheck if a password is valid prior to taking any additional action to ensure the user is legitimate. Where possible, send an email or notification instead of blocking the user.\n\n**Inputs**\n\n| Field | Type | Description |\n| --- | --- | --- |\n| <code>user_id</code> | <code>string</code> | Unique identifier for the user attempting to sign in. Correlate this to the <code>auth.users</code> table. |\n| <code>valid</code> | <code>boolean</code> | Whether the password verification attempt was valid. |\n\nJSONJSON Schema\n\n`\n_10\n{\n_10\n\"user_id\": \"3919cb6e-4215-4478-a960-6d3454326cec\",\n_10\n\"valid\": true\n_10\n}\n`\n\n**Outputs**\n\nReturn these only if your hook processed the input without errors.\n\n| Field | Type | Description |\n| --- | --- | --- |\n| <code>decision</code> | <code>string</code> | The decision on whether to allow authentication to move forward. Use <code>reject</code> to deny the verification attempt and log the user out of all active sessions. Use <code>continue</code> to use the default Supabase Auth behavior. |\n| <code>message</code> | <code>string</code> | The message to show the user if the decision was <code>reject</code>. |\n| <code>should_logout_user</code> | <code>boolean</code> | Whether to log out the user if a <code>reject</code> decision is issued. Has no effect when a <code>continue</code> decision is issued. |\n\n`\n_10\n{\n_10\n\"decision\": \"reject\",\n_10\n\"message\": \"You have exceeded maximum number of password sign-in attempts.\",\n_10\n\"should_logout_user\": \"false\"\n_10\n}\n`\n\nSQL\n\nLimit failed password verification attemptsSend email notification on failed password attempts\n\nAs part of new security measures within the company, users can only input an incorrect password every 10 seconds and not more than that. You want to write a hook to enforce this.\n\nCreate a table to record each user's last incorrect password verification attempt.\n\n`\n_10\ncreate table public.password_failed_verification_attempts (\n_10\nuser_id uuid not null,\n_10\nlast_failed_at timestamp not null default now(),\n_10\nprimary key (user_id)\n_10\n);\n`\n\nCreate a hook to read and write information to this table. For example:\n\n`\n_54\ncreate function public.hook_password_verification_attempt(event jsonb)\n_54\nreturns jsonb\n_54\nlanguage plpgsql\n_54\nas $$\n_54\ndeclare\n_54\n    last_failed_at timestamp;\n_54\nbegin\n_54\n    if event->'valid' is true then\n_54\n      -- password is valid, accept it\n_54\n      return jsonb_build_object('decision', 'continue');\n_54\n    end if;\n_54\n_54\n    select last_failed_at into last_failed_at\n_54\n      from public.password_failed_verification_attempts\n_54\n      where\n_54\n        user_id = event->'user_id';\n_54\n_54\n"
    }
  },
  {
    "chunk_id": "dc0210ec-c52f-419c-9dd0-70238111d555",
    "metadata": {
      "token_count": 372,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/password-verification-hook",
      "page_title": "Password Verification Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password Verification Hook",
        "h2": "",
        "h3": ""
      },
      "text": "\n_54\n    select last_failed_at into last_failed_at\n_54\n      from public.password_failed_verification_attempts\n_54\n      where\n_54\n        user_id = event->'user_id';\n_54\n_54\n    if last_failed_at is not null and now() - last_failed_at < interval '10 seconds' then\n_54\n      -- last attempt was done too quickly\n_54\n      return jsonb_build_object(\n_54\n        'error', jsonb_build_object(\n_54\n          'http_code', 429,\n_54\n          'message',   'Please wait a moment before trying again.'\n_54\n        )\n_54\n      );\n_54\n    end if;\n_54\n_54\n    -- record this failed attempt\n_54\n    insert into public.password_failed_verification_attempts\n_54\n      (\n_54\n        user_id,\n_54\n        last_failed_at\n_54\n      )\n_54\n      values\n_54\n      (\n_54\n        event->'user_id',\n_54\n        now()\n_54\n      )\n_54\n      on conflict do update\n_54\n        set last_failed_at = now();\n_54\n_54\n    -- finally let Supabase Auth do the default behavior for a failed attempt\n_54\n    return jsonb_build_object('decision', 'continue');\n_54\nend;\n_54\n$$;\n_54\n_54\n-- Assign appropriate permissions\n_54\ngrant all\n_54\non table public.password_failed_verification_attempts\n_54\nto supabase_auth_admin;\n_54\n_54\nrevoke all\n_54\non table public.password_failed_verification_attempts\n_54\nfrom authenticated, anon, public;\n`\n"
    }
  },
  {
    "chunk_id": "0037c078-d3b1-4d53-b8d5-9532e1a20d11",
    "metadata": {
      "token_count": 113,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/creating-a-client",
      "page_title": "Creating a Supabase client for SSR | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Creating a Supabase client for SSR",
        "h2": "Configure your Supabase client to use cookies",
        "h3": ""
      },
      "text": "Auth\nTo use Server-Side Rendering (SSR) with Supabase, you need to configure your Supabase client to use cookies. The <code>@supabase/ssr</code> package helps you do this for JavaScript/TypeScript applications.\nInstall the <code>@supabase/ssr</code> and <code>@supabase/supabase-js</code> packages:\n\nnpmyarnpnpm\n\n`\n_10\nnpm install @supabase/ssr @supabase/supabase-js\n`\n"
    }
  },
  {
    "chunk_id": "db2be384-7877-4817-9f5b-fea02dc6e20f",
    "metadata": {
      "token_count": 341,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/creating-a-client",
      "page_title": "Creating a Supabase client for SSR | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Creating a Supabase client for SSR",
        "h2": "Set environment variables \\#",
        "h3": "### Project URL"
      },
      "text": "r</code> and <code>@supabase/supabase-js</code> packages:\n\nnpmyarnpnpm\n\n`\n_10\nnpm install @supabase/ssr @supabase/supabase-js\n`\nIn your environment variables file, set your Supabase URL and Supabase Anon Key:\nLoading...\nLoading...\n\nNext.jsSvelteKitAstroRemixExpress\n\n.env.local\n\n`\n_10\nNEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url\n_10\nNEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key\n`\nYou'll need some one-time setup code to configure your Supabase client to use cookies. Once your utility code is set up, you can use your new <code>createClient</code> utility functions to get a properly configured Supabase client.\n\nUse the browser client in code that runs on the browser, and the server client in code that runs on the server.\n\nNext.jsSvelteKitAstroRemixExpress\n\nThe following code samples are for App Router. For help with Pages Router, see the [Next.js Server-Side Auth guide](/docs/guides/auth/server-side/nextjs?queryGroups=router&router=pages).\n\nClient-sideServer-sideMiddleware\n- Implement [Authentication using Email and Password](/docs/guides/auth/server-side/email-based-auth-with-pkce-flow-for-ssr)\n- Implement [Authentication using OAuth](/docs/guides/auth/server-side/oauth-with-pkce-flow-for-ssr)\n- [Learn more about SSR](/docs/guides/auth/server-side-rendering)\n"
    }
  },
  {
    "chunk_id": "8b54bcca-93e1-4b7b-b568-92af27eb885d",
    "metadata": {
      "token_count": 265,
      "source_url": "https://supabase.com/docs/guides/auth/auth-identity-linking",
      "page_title": "Identity Linking | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Identity Linking",
        "h2": "Identity linking strategies \\#",
        "h3": "Automatic linking \\#"
      },
      "text": "Auth\nCurrently, Supabase Auth supports 2 strategies to link an identity to a user:\n\n1. [Automatic Linking](#automatic-linking)\n2. [Manual Linking](#manual-linking-beta)\nSupabase Auth automatically links identities with the same email address to a single user. This helps to improve the user experience when multiple OAuth login options are presented since the user does not need to remember which OAuth account they used to sign up with. When a new user signs in with OAuth, Supabase Auth will attempt to look for an existing user that uses the same email address. If a match is found, the new identity is linked to the user.\n\nIn order for automatic linking to correctly identify the user for linking, Supabase Auth needs to ensure that all user emails are unique. It would also be an insecure practice to automatically link an identity to a user with an unverified email address since that could lead to pre-account takeover attacks. To prevent this from happening, when a new identity can be linked to an existing user, Supabase Auth will remove any other unconfirmed identities linked to an existing user.\n\nUsers that signed up with [SAML SSO](/docs/guides/auth/sso/auth-sso-saml) will not be considered as targets for automatic linking.\n"
    }
  },
  {
    "chunk_id": "cbec0023-6bb5-4383-8f0f-b3089a444533",
    "metadata": {
      "token_count": 235,
      "source_url": "https://supabase.com/docs/guides/auth/auth-identity-linking",
      "page_title": "Identity Linking | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Identity Linking",
        "h2": "Identity linking strategies \\#",
        "h3": "Manual linking (beta) \\#"
      },
      "text": "ase Auth will remove any other unconfirmed identities linked to an existing user.\n\nUsers that signed up with [SAML SSO](/docs/guides/auth/sso/auth-sso-saml) will not be considered as targets for automatic linking.\nJavaScriptDartSwiftKotlinPython\n\nSupabase Auth allows a user to initiate identity linking with a different email address when they are logged in. To link an OAuth identity to the user, call [<code>linkIdentity()</code>](/docs/reference/javascript/auth-linkidentity):\n\n`\n_10\nconst { data, error } = await supabase.auth.linkIdentity({ provider: 'google' })\n`\n\nIn the example above, the user will be redirected to Google to complete the OAuth2.0 flow. Once the OAuth2.0 flow has completed successfully, the user will be redirected back to the application and the Google identity will be linked to the user. You can enable manual linking from your project's authentication [configuration options](/dashboard/project/_/settings/auth) or by setting the environment variable <code>GOTRUE_SECURITY_MANUAL_LINKING_ENABLED: true</code> when self-hosting.\n"
    }
  },
  {
    "chunk_id": "9f22d867-4728-4686-b8b5-07822bc6770c",
    "metadata": {
      "token_count": 251,
      "source_url": "https://supabase.com/docs/guides/auth/auth-identity-linking",
      "page_title": "Identity Linking | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Identity Linking",
        "h2": "Unlink an identity \\#",
        "h3": ""
      },
      "text": " You can enable manual linking from your project's authentication [configuration options](/dashboard/project/_/settings/auth) or by setting the environment variable <code>GOTRUE_SECURITY_MANUAL_LINKING_ENABLED: true</code> when self-hosting.\nJavaScriptDartSwiftKotlinPython\n\nYou can use [<code>getUserIdentities()</code>](/docs/reference/javascript/auth-getuseridentities) to fetch all the identities linked to a user. Then, call [<code>unlinkIdentity()</code>](/docs/reference/javascript/auth-unlinkidentity) to unlink the identity. The user needs to be logged in and have at least 2 linked identities in order to unlink an existing identity.\n\n`\n_10\n// retrieve all identities linked to a user\n_10\nconst {\n_10\ndata: { identities },\n_10\n} = await supabase.auth.getUserIdentities()\n_10\n_10\n// find the google identity linked to the user\n_10\nconst googleIdentity = identities.find((identity) => identity.provider === 'google')\n_10\n_10\n// unlink the google identity from the user\n_10\nconst { data, error } = await supabase.auth.unlinkIdentity(googleIdentity)\n`\n"
    }
  },
  {
    "chunk_id": "01b414a2-421f-4eea-90b1-8660ba230f6c",
    "metadata": {
      "token_count": 127,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/nextjs",
      "page_title": "Setting up Server-Side Auth for Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for Next.js",
        "h2": "",
        "h3": "Install Supabase packages"
      },
      "text": "Auth\nNext.js comes in two flavors: the [App Router](https://nextjs.org/docs/app) and the [Pages Router](https://nextjs.org/docs/pages). You can set up Server-Side Auth with either strategy. You can even use both in the same application.\n\nApp RouterPages RouterHybrid router strategies\n\n1\nInstall the <code>@supabase/supabase-js</code> package and the helper <code>@supabase/ssr</code> package.\n\n`\n_10\nnpm install @supabase/supabase-js @supabase/ssr\n`\n\n2\n"
    }
  },
  {
    "chunk_id": "c56fa5b7-cd06-44cf-ba0c-55c4068a88ed",
    "metadata": {
      "token_count": 378,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/nextjs",
      "page_title": "Setting up Server-Side Auth for Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for Next.js",
        "h2": "",
        "h3": "Set up environment variables"
      },
      "text": "/supabase-js</code> package and the helper <code>@supabase/ssr</code> package.\n\n`\n_10\nnpm install @supabase/supabase-js @supabase/ssr\n`\n\n2\nCreate a <code>.env.local</code> file in your project root directory.\n\nFill in your <code>NEXT_PUBLIC_SUPABASE_URL</code> and <code>NEXT_PUBLIC_SUPABASE_ANON_KEY</code>:\nLoading...\nLoading...\n\n.env.local\n\n`\n_10\nNEXT_PUBLIC_SUPABASE_URL=<your_supabase_project_url>\n_10\nNEXT_PUBLIC_SUPABASE_ANON_KEY=<your_supabase_anon_key>\n`\n\n3\nTo access Supabase from your Next.js app, you need 2 types of Supabase clients:\n\n1. **Client Component client** \\- To access Supabase from Client Components, which run in the browser.\n2. **Server Component client** \\- To access Supabase from Server Components, Server Actions, and Route Handlers, which run only on the server.\n\nCreate a <code>utils/supabase</code> folder with a file for each type of client. Then copy the utility functions for each client type.\n\nWhat does the \\<code>cookies\\</code> object do?\n\nDo I need to create a new client for every route?\n\nutils/supabase/client.ts\n\nutils/supabase/server.ts\n\n`\n_10\nimport { createBrowserClient } from '@supabase/ssr'\n_10\n_10\nexport function createClient() {\n_10\nreturn createBrowserClient(\n_10\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n_10\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n_10\n)\n_10\n}\n`\n\n4\n"
    }
  },
  {
    "chunk_id": "3df7ee13-48f2-4e61-92fc-19d5283df757",
    "metadata": {
      "token_count": 569,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/nextjs",
      "page_title": "Setting up Server-Side Auth for Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for Next.js",
        "h2": "",
        "h3": "Hook up middleware"
      },
      "text": " {\n_10\nreturn createBrowserClient(\n_10\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n_10\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n_10\n)\n_10\n}\n`\n\n4\nCreate a <code>middleware.ts</code> file at the root of your project.\n\nSince Server Components can't write cookies, you need middleware to refresh expired Auth tokens and store them.\n\nThe middleware is responsible for:\n\n1. Refreshing the Auth token (by calling <code>supabase.auth.getUser</code>).\n2. Passing the refreshed Auth token to Server Components, so they don't attempt to refresh the same token themselves. This is accomplished with <code>request.cookies.set</code>.\n3. Passing the refreshed Auth token to the browser, so it replaces the old token. This is accomplished with <code>response.cookies.set</code>.\n\nCopy the middleware code for your app.\n\nAdd a [matcher](https://nextjs.org/docs/app/building-your-application/routing/middleware#matching-paths) so the middleware doesn't run on routes that don't access Supabase.\n\nBe careful when protecting pages. The server gets the user session from the cookies, which can be spoofed by anyone.\n\nAlways use <code>supabase.auth.getUser()</code> to protect pages and user data.\n\n_Never_ trust <code>supabase.auth.getSession()</code> inside server code such as middleware. It isn't guaranteed to revalidate the Auth token.\n\nIt's safe to trust <code>getUser()</code> because it sends a request to the Supabase Auth server every time to revalidate the Auth token.\n\nmiddleware.ts\n\nutils/supabase/middleware.ts\n\n`\n_19\nimport { type NextRequest } from 'next/server'\n_19\nimport { updateSession } from '@/utils/supabase/middleware'\n_19\n_19\nexport async function middleware(request: NextRequest) {\n_19\nreturn await updateSession(request)\n_19\n}\n_19\n_19\nexport const config = {\n_19\nmatcher: [\\\n_19\\\n    /*\\\n_19\\\n     * Match all request paths except for the ones starting with:\\\n_19\\\n     * - _next/static (static files)\\\n_19\\\n     * - _next/image (image optimization files)\\\n_19\\\n     * - favicon.ico (favicon file)\\\n_19\\\n     * Feel free to modify this pattern to include more paths.\\\n_19\\\n     */\\\n_19\\\n    '/((?!_next/static|_next/image|favicon.ico|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',\\\n_19\\\n],\n_19\n}\n`\n\n5\n"
    }
  },
  {
    "chunk_id": "bd2cf4a0-1fd3-4a7e-835a-885f63ca2e0b",
    "metadata": {
      "token_count": 374,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/nextjs",
      "page_title": "Setting up Server-Side Auth for Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for Next.js",
        "h2": "",
        "h3": "Create a login page"
      },
      "text": "_19\\\n    '/((?!_next/static|_next/image|favicon.ico|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',\\\n_19\\\n],\n_19\n}\n`\n\n5\nCreate a login page for your app. Use a Server Action to call the Supabase signup function.\n\nSince Supabase is being called from an Action, use the client defined in <code>@/utils/supabase/server.ts</code>.\n\nNote that <code>cookies</code> is called before any calls to Supabase, which opts fetch calls out of Next.js's caching. This is important for authenticated data fetches, to ensure that users get access only to their own data.\n\nSee the Next.js docs to learn more about [opting out of data caching](https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#opting-out-of-data-caching).\n\napp/login/page.tsx\n\napp/login/actions.ts\n\napp/error/page.tsx\n\n`\n_14\nimport { login, signup } from './actions'\n_14\n_14\nexport default function LoginPage() {\n_14\nreturn (\n_14\n    <form>\n_14\n      <label htmlFor=\"email\">Email:</label>\n_14\n      <input id=\"email\" name=\"email\" type=\"email\" required />\n_14\n      <label htmlFor=\"password\">Password:</label>\n_14\n      <input id=\"password\" name=\"password\" type=\"password\" required />\n_14\n      <button formAction={login}>Log in</button>\n_14\n      <button formAction={signup}>Sign up</button>\n_14\n    </form>\n_14\n)\n_14\n}\n`\n\n6\n"
    }
  },
  {
    "chunk_id": "3a79846c-53ce-4d88-879b-2b2593e7fa3f",
    "metadata": {
      "token_count": 160,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/nextjs",
      "page_title": "Setting up Server-Side Auth for Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for Next.js",
        "h2": "",
        "h3": "Change the Auth confirmation path"
      },
      "text": "_14\n      <button formAction={login}>Log in</button>\n_14\n      <button formAction={signup}>Sign up</button>\n_14\n    </form>\n_14\n)\n_14\n}\n`\n\n6\nIf you have email confirmation turned on (the default), a new user will receive an email confirmation after signing up.\n\nChange the email template to support a server-side authentication flow.\n\nGo to the [Auth templates](https://supabase.com/dashboard/project/_/auth/templates) page in your dashboard. In the <code>Confirm signup</code> template, change <code>{{ .ConfirmationURL }}</code> to <code>{{ .SiteURL }}/auth/confirm?token_hash={{ .TokenHash }}&type=signup</code>.\n\n7\n"
    }
  },
  {
    "chunk_id": "eab73137-71e9-46b4-908f-9b17755197a1",
    "metadata": {
      "token_count": 403,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/nextjs",
      "page_title": "Setting up Server-Side Auth for Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for Next.js",
        "h2": "",
        "h3": "Create a route handler for Auth confirmation"
      },
      "text": " In the <code>Confirm signup</code> template, change <code>{{ .ConfirmationURL }}</code> to <code>{{ .SiteURL }}/auth/confirm?token_hash={{ .TokenHash }}&type=signup</code>.\n\n7\nCreate a Route Handler for <code>auth/confirm</code>. When a user clicks their confirmation email link, exchange their secure code for an Auth token.\n\nSince this is a Router Handler, use the Supabase client from <code>@/utils/supabase/server.ts</code>.\n\napp/auth/confirm/route.ts\n\n`\n_28\nimport { type EmailOtpType } from '@supabase/supabase-js'\n_28\nimport { type NextRequest } from 'next/server'\n_28\n_28\nimport { createClient } from '@/utils/supabase/server'\n_28\nimport { redirect } from 'next/navigation'\n_28\n_28\nexport async function GET(request: NextRequest) {\n_28\nconst { searchParams } = new URL(request.url)\n_28\nconst token_hash = searchParams.get('token_hash')\n_28\nconst type = searchParams.get('type') as EmailOtpType | null\n_28\nconst next = searchParams.get('next') ?? '/'\n_28\n_28\nif (token_hash && type) {\n_28\n    const supabase = createClient()\n_28\n_28\n    const { error } = await supabase.auth.verifyOtp({\n_28\n      type,\n_28\n      token_hash,\n_28\n    })\n_28\n    if (!error) {\n_28\n      // redirect user to specified redirect URL or root of app\n_28\n      redirect(next)\n_28\n    }\n_28\n}\n_28\n_28\n// redirect the user to an error page with some instructions\n_28\nredirect('/error')\n_28\n}\n`\n\n8\n"
    }
  },
  {
    "chunk_id": "e041ccd2-e3ab-44ab-a874-63f7faaa9c32",
    "metadata": {
      "token_count": 363,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/nextjs",
      "page_title": "Setting up Server-Side Auth for Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for Next.js",
        "h2": "",
        "h3": "Access user info from Server Component"
      },
      "text": " app\n_28\n      redirect(next)\n_28\n    }\n_28\n}\n_28\n_28\n// redirect the user to an error page with some instructions\n_28\nredirect('/error')\n_28\n}\n`\n\n8\nServer Components can read cookies, so you can get the Auth status and user info.\n\nSince you're calling Supabase from a Server Component, use the client created in <code>@/utils/supabase/server.ts</code>.\n\nCreate a <code>private</code> page that users can only access if they're logged in. The page displays their email.\n\nBe careful when protecting pages. The server gets the user session from the cookies, which can be spoofed by anyone.\n\nAlways use <code>supabase.auth.getUser()</code> to protect pages and user data.\n\n_Never_ trust <code>supabase.auth.getSession()</code> inside Server Components. It isn't guaranteed to revalidate the Auth token.\n\nIt's safe to trust <code>getUser()</code> because it sends a request to the Supabase Auth server every time to revalidate the Auth token.\n\napp/private/page.tsx\n\n`\n_14\nimport { redirect } from 'next/navigation'\n_14\n_14\nimport { createClient } from '@/utils/supabase/server'\n_14\n_14\nexport default async function PrivatePage() {\n_14\nconst supabase = createClient()\n_14\n_14\nconst { data, error } = await supabase.auth.getUser()\n_14\nif (error || !data?.user) {\n_14\n    redirect('/login')\n_14\n}\n_14\n_14\nreturn <p>Hello {data.user.email}</p>\n_14\n}\n`\n"
    }
  },
  {
    "chunk_id": "b2c66abf-2f41-450f-b642-32879a1ac14f",
    "metadata": {
      "token_count": 156,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/nextjs",
      "page_title": "Setting up Server-Side Auth for Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Setting up Server-Side Auth for Next.js",
        "h2": "Congratulations \\#",
        "h3": ""
      },
      "text": ".auth.getUser()\n_14\nif (error || !data?.user) {\n_14\n    redirect('/login')\n_14\n}\n_14\n_14\nreturn <p>Hello {data.user.email}</p>\n_14\n}\n`\nYou're done! To recap, you've successfully:\n\n- Called Supabase from a Server Action.\n- Called Supabase from a Server Component.\n- Set up a Supabase client utility to call Supabase from a Client Component. You can use this if you need to call Supabase from a Client Component, for example to set up a realtime subscription.\n- Set up middleware to automatically refresh the Supabase Auth session.\n\nYou can now use any Supabase features from your client or server code!\n"
    }
  },
  {
    "chunk_id": "64c857df-0d81-4350-ad49-5cf2af8c2da2",
    "metadata": {
      "token_count": 793,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/mfa-verification-hook",
      "page_title": "MFA Verification Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "MFA Verification Hook",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nYou can add additional checks to the [Supabase MFA implementation](/docs/guides/auth/auth-mfa) with hooks. For example, you can:\n\n- Limit the number of verification attempts performed over a period of time.\n- Sign out users who have too many invalid verification attempts.\n- Count, rate limit, or ban sign-ins.\n\n**Inputs**\n\nSupabase Auth will send a payload containing these fields to your hook:\n\n| Field | Type | Description |\n| --- | --- | --- |\n| <code>factor_id</code> | <code>string</code> | Unique identifier for the MFA factor being verified |\n| <code>factor_type</code> | <code>string</code> | <code>totp</code> or <code>phone</code> |\n| <code>user_id</code> | <code>string</code> | Unique identifier for the user |\n| <code>valid</code> | <code>boolean</code> | Whether the verification attempt was valid. For TOTP, this means that the six digit code was correct (true) or incorrect (false). |\n\nJSONJSON Schema\n\n`\n_10\n{\n_10\n\"factor_id\": \"6eab6a69-7766-48bf-95d8-bd8f606894db\",\n_10\n\"user_id\": \"3919cb6e-4215-4478-a960-6d3454326cec\",\n_10\n\"valid\": true\n_10\n}\n`\n\n**Outputs**\n\nReturn this if your hook processed the input without errors.\n\n| Field | Type | Description |\n| --- | --- | --- |\n| <code>decision</code> | <code>string</code> | The decision on whether to allow authentication to move forward. Use <code>reject</code> to deny the verification attempt and log the user out of all active sessions. Use <code>continue</code> to use the default Supabase Auth behavior. |\n| <code>message</code> | <code>string</code> | The message to show the user if the decision was <code>reject</code>. |\n\n`\n_10\n{\n_10\n\"decision\": \"reject\",\n_10\n\"message\": \"You have exceeded maximum number of MFA attempts.\"\n_10\n}\n`\n\nSQL\n\nLimit failed MFA verification attempts\n\nYour company requires that a user can input an incorrect MFA Verification code no more than once every 2 seconds.\n\nCreate a table to record the last time a user had an incorrect MFA verification attempt for a factor.\n\n`\n_10\ncreate table public.mfa_failed_verification_attempts (\n_10\nuser_id uuid not null,\n_10\nfactor_id uuid not null,\n_10\nlast_failed_at timestamp not null default now(),\n_10\nprimary key (user_id, factor_id)\n_10\n);\n`\n\nCreate a hook to read and write information to this table. For example:\n\n`\n_58\ncreate function public.hook_mfa_verification_attempt(event jsonb)\n_58\nreturns jsonb\n_58\nlanguage plpgsql\n_58\nas $$\n_58\ndeclare\n_58\n    last_failed_at timestamp;\n_58\nbegin\n_58\n    if event->'valid' is true then\n_58\n      -- code is valid, accept it\n_58\n      return jsonb_build_object('decision', 'continue');\n_58\n    end if;\n_58\n_58\n    select last_failed_at into last_failed_at\n_58\n      from public.mfa_failed_verification_attempts\n_58\n      where\n_58\n        user_id = event->'user_id'\n_58\n          and\n_58\n        factor_id = event->'factor_id';\n_58\n_58\n"
    }
  },
  {
    "chunk_id": "014946dd-19b1-4af4-bd09-da96fc37d10b",
    "metadata": {
      "token_count": 397,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks/mfa-verification-hook",
      "page_title": "MFA Verification Hook | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "MFA Verification Hook",
        "h2": "",
        "h3": ""
      },
      "text": ".mfa_failed_verification_attempts\n_58\n      where\n_58\n        user_id = event->'user_id'\n_58\n          and\n_58\n        factor_id = event->'factor_id';\n_58\n_58\n    if last_failed_at is not null and now() - last_failed_at < interval '2 seconds' then\n_58\n      -- last attempt was done too quickly\n_58\n      return jsonb_build_object(\n_58\n        'error', jsonb_build_object(\n_58\n          'http_code', 429,\n_58\n          'message',   'Please wait a moment before trying again.'\n_58\n        )\n_58\n      );\n_58\n    end if;\n_58\n_58\n    -- record this failed attempt\n_58\n    insert into public.mfa_failed_verification_attempts\n_58\n      (\n_58\n        user_id,\n_58\n        factor_id,\n_58\n        last_refreshed_at\n_58\n      )\n_58\n      values\n_58\n      (\n_58\n        event->'user_id',\n_58\n        event->'factor_id',\n_58\n        now()\n_58\n      )\n_58\n      on conflict do update\n_58\n        set last_refreshed_at = now();\n_58\n_58\n    -- finally let Supabase Auth do the default behavior for a failed attempt\n_58\n    return jsonb_build_object('decision', 'continue');\n_58\nend;\n_58\n$$;\n_58\n_58\n-- Assign appropriate permissions and revoke access\n_58\ngrant all\n_58\non table public.mfa_failed_verification_attempts\n_58\nto supabase_auth_admin;\n_58\n_58\nrevoke all\n_58\non table public.mfa_failed_verification_attempts\n_58\nfrom authenticated, anon, public;\n`\n"
    }
  },
  {
    "chunk_id": "e8339639-89f1-4f44-9be1-1f9ad460afca",
    "metadata": {
      "token_count": 126,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nMulti-factor authentication (MFA), sometimes called two-factor authentication (2FA), adds an additional layer of security to your application by verifying their identity through additional verification steps.\n\nIt is considered a best practice to use MFA for your applications.\n\nUsers with weak passwords or compromised social login accounts are prone to malicious account takeovers. These can be prevented with MFA because they require the user to provide proof of both of these:\n\n- Something they know.\nPassword, or access to a social-login account.\n- Something they have.\nAccess to an authenticator app (a.k.a. TOTP) or a mobile phone.\n"
    }
  },
  {
    "chunk_id": "dd08b0a2-5d35-4589-a040-74ad8535697b",
    "metadata": {
      "token_count": 568,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Overview \\#",
        "h3": ""
      },
      "text": " require the user to provide proof of both of these:\n\n- Something they know.\nPassword, or access to a social-login account.\n- Something they have.\nAccess to an authenticator app (a.k.a. TOTP) or a mobile phone.\nSupabase Auth implements MFA via two methods: App Authenticator, which makes use of a Time based-one Time Password, and phone messaging, which makes use of a code generated by Supabase Auth.\n\nApplications using MFA require two important flows:\n\n1. **Enrollment flow.**\nThis lets users set up and control MFA in your app.\n2. **Authentication flow.**\nThis lets users sign in using any factors after the conventional login step.\n\nSupabase Auth provides:\n\n- **Enrollment API** \\- build rich user interfaces for adding and removing factors.\n- **Challenge and Verify APIs** \\- securely verify that the user has access to a factor.\n- **List Factors API** \\- build rich user interfaces for signing in with additional factors.\n\nYou can control access to the Enrollment API as well as the Challenge and Verify APIs via the Supabase Dashboard. A setting of <code>Verification Disabled</code> will disable both the challenge API and the verification API.\n\nThese sets of APIs let you control the MFA experience that works for you. You can create flows where MFA is optional, mandatory for all, or only specific groups of users.\n\nOnce users have enrolled or signed-in with a factor, Supabase Auth adds additional metadata to the user's access token (JWT) that your application can use to allow or deny access.\n\nThis information is represented by an [Authenticator Assurance Level](https://pages.nist.gov/800-63-3-Implementation-Resources/63B/AAL/), a standard measure about the assurance of the user's identity Supabase Auth has for that particular session. There are two levels recognized today:\n\n1. **Assurance Level 1: <code>aal1</code>**\nMeans that the user's identity was verified using a conventional login method\nsuch as email+password, magic link, one-time password, phone auth or social\nlogin.\n2. **Assurance Level 2: <code>aal2</code>**\nMeans that the user's identity was additionally verified using at least one\nsecond factor, such as a TOTP code or One-Time Password code.\n\nThis assurance level is encoded in the <code>aal</code> claim in the JWT associated with the user. By decoding this value you can create custom authorization rules in your frontend, backend, and database that will enforce the MFA policy that works for your application. JWTs without an <code>aal</code> claim are at the <code>aal1</code> level.\n"
    }
  },
  {
    "chunk_id": "a58ac608-8d82-45ac-9245-ce42cd5fff04",
    "metadata": {
      "token_count": 337,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Adding to your app \\#",
        "h3": ""
      },
      "text": " create custom authorization rules in your frontend, backend, and database that will enforce the MFA policy that works for your application. JWTs without an <code>aal</code> claim are at the <code>aal1</code> level.\nAdding MFA to your app involves these four steps:\n\n1. **Add enrollment flow.**\nYou need to provide a UI within your app that your users will be able to set-up\nMFA in. You can add this right after sign-up, or as part of a separate flow in\nthe settings portion of your app.\n2. **Add unenroll flow.**\nYou need to support a UI through which users can see existing devices and unenroll\ndevices which are no longer relevant.\n3. **Add challenge step to login.**\nIf a user has set-up MFA, your app's login flow needs to present a challenge\nscreen to the user asking them to prove they have access to the additional\nfactor.\n4. **Enforce rules for MFA logins.**\nOnce your users have a way to enroll and log in with MFA, you need to enforce\nauthorization rules across your app: on the frontend, backend, API servers or\nRow-Level Security policies.\n\nThe enrollment flow and the challenge steps differ by factor and are covered on a separate page. Visit the [Phone](/docs/guides/auth/auth-mfa/phone) or [App Authenticator](/docs/guides/auth/auth-mfa/totp) pages to see how to add the flows for the respective factors. You can combine both flows and allow for use of both Phone and App Authenticator Factors.\n"
    }
  },
  {
    "chunk_id": "8563d547-08e0-4a60-a5da-5de78e83bf3a",
    "metadata": {
      "token_count": 220,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Adding to your app \\#",
        "h3": "Add unenroll flow \\#"
      },
      "text": ") or [App Authenticator](/docs/guides/auth/auth-mfa/totp) pages to see how to add the flows for the respective factors. You can combine both flows and allow for use of both Phone and App Authenticator Factors.\nThe unenroll process is the same for both Phone and TOTP factors.\n\nAn unenroll flow provides a UI for users to manage and unenroll factors linked to their accounts. Most applications do so via a factor management page where users can view and unlink selected factors.\n\nWhen a user unenrolls a factor, call <code>supabase.auth.mfa.unenroll()</code> with the ID of the factor. For example, call:\n\n`\n_10\nsupabase.auth.mfa.unenroll({factorId: \"d30fd651-184e-4748-a928-0a4b9be1d429\"})\n`\n\nto unenroll a factor with ID <code>d30fd651-184e-4748-a928-0a4b9be1d429</code>.\n"
    }
  },
  {
    "chunk_id": "148a6c43-c5b7-41cf-83c6-b1415ace6738",
    "metadata": {
      "token_count": 246,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Adding to your app \\#",
        "h3": "Enforce rules for MFA logins \\#"
      },
      "text": "8-a928-0a4b9be1d429\"})\n`\n\nto unenroll a factor with ID <code>d30fd651-184e-4748-a928-0a4b9be1d429</code>.\nAdding MFA to your app's UI does not in-and-of-itself offer a higher level of security to your users. You also need to enforce the MFA rules in your application's database, APIs, and server-side rendering.\n\nDepending on your application's needs, there are three ways you can choose to enforce MFA.\n\n1. **Enforce for all users (new and existing).**\nAny user account will have to enroll MFA to continue using your app.\nThe application will not allow access without going through MFA first.\n2. **Enforce for new users only.**\nOnly new users will be forced to enroll MFA, while old users will be encouraged\nto do so.\nThe application will not allow access for new users without going through MFA\nfirst.\n3. **Enforce only for users that have opted-in.**\nUsers that want MFA can enroll in it and the application will not allow access\nwithout going through MFA first.\n"
    }
  },
  {
    "chunk_id": "d5c11703-dcf2-4dd5-bb8a-3e7280fcc295",
    "metadata": {
      "token_count": 778,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Adding to your app \\#",
        "h3": "# Example: React \\#"
      },
      "text": " access for new users without going through MFA\nfirst.\n3. **Enforce only for users that have opted-in.**\nUsers that want MFA can enroll in it and the application will not allow access\nwithout going through MFA first.\nBelow is an example that creates a new <code>UnenrollMFA</code> component that illustrates the important pieces of the MFA enrollment flow. Note that users can only unenroll a factor after completing the enrollment flow and obtaining an <code>aal2</code> JWT claim. Here are some points of note:\n\n- When the component appears on screen, the <code>supabase.auth.mfa.listFactors()</code> endpoint\nfetches all existing factors together with their details.\n- The existing factors for a user are displayed in a table.\n- Once the user has selected a factor to unenroll, they can type in the factorId and click **Unenroll**\nwhich creates a confirmation modal.\n\nUnenrolling a factor will downgrade the assurance level from <code>aal2</code> to <code>aal1</code> only after the refresh interval has lapsed. For an immediate downgrade from <code>aal2</code> to <code>aal1</code> after enrolling one will need to manually call <code>refreshSession()</code>\n\n`\n_46\n/**\n_46\n* UnenrollMFA shows a simple table with the list of factors together with a button to unenroll.\n_46\n* When a user types in the factorId of the factor that they wish to unenroll and clicks unenroll\n_46\n* the corresponding factor will be unenrolled.\n_46\n*/\n_46\nexport function UnenrollMFA() {\n_46\nconst [factorId, setFactorId] = useState('')\n_46\nconst [factors, setFactors] = useState([])\n_46\nconst [error, setError] = useState('') // holds an error message\n_46\n_46\nuseEffect(() => {\n_46\n    ;(async () => {\n_46\n      const { data, error } = await supabase.auth.mfa.listFactors()\n_46\n      if (error) {\n_46\n        throw error\n_46\n      }\n_46\n_46\n      setFactors([...data.totp, ...data.phone])\n_46\n    })()\n_46\n}, [])\n_46\n_46\nreturn (\n_46\n    <>\n_46\n      {error && <div className=\"error\">{error}</div>}\n_46\n      <tbody>\n_46\n        <tr>\n_46\n          <td>Factor ID</td>\n_46\n          <td>Friendly Name</td>\n_46\n          <td>Factor Status</td>\n_46\n          <td>Phone Number</td>\n_46\n        </tr>\n_46\n        {factors.map((factor) => (\n_46\n          <tr>\n_46\n            <td>{factor.id}</td>\n_46\n            <td>{factor.friendly_name}</td>\n_46\n            <td>{factor.factor_type}</td>\n_46\n            <td>{factor.status}</td>\n_46\n            <td>{factor.phone}</td>\n_46\n          </tr>\n_46\n        ))}\n_46\n      </tbody>\n_46\n      <input type=\"text\" value={verifyCode} onChange={(e) => setFactorId(e.target.value.trim())} />\n_46\n      <button onClick={() => supabase.auth.mfa.unenroll({ factorId })}>Unenroll</button>\n_46\n    </>\n_46\n)\n_46\n}\n`\n"
    }
  },
  {
    "chunk_id": "140ebcf5-45de-4ddb-b9bf-8f89a266b321",
    "metadata": {
      "token_count": 250,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Adding to your app \\#",
        "h3": "# Database \\#"
      },
      "text": "(e.target.value.trim())} />\n_46\n      <button onClick={() => supabase.auth.mfa.unenroll({ factorId })}>Unenroll</button>\n_46\n    </>\n_46\n)\n_46\n}\n`\nYour app should sufficiently deny or allow access to tables or rows based on the user's current and possible authenticator levels.\n\nPostgreSQL has two types of policies: permissive and restrictive. This guide uses restrictive policies. Make sure you don't omit the <code>as restrictive</code> clause.\nIf your app falls under this case, this is a template Row Level Security policy you can apply to all your tables:\n\n`\n_10\ncreate policy \"Policy name.\"\n_10\non table_name\n_10\nas restrictive\n_10\nto authenticated\n_10\nusing ((select auth.jwt()->>'aal') = 'aal2');\n`\n\n- Here the policy will not accept any JWTs with an <code>aal</code> claim other than\n<code>aal2</code>, which is the highest authenticator assurance level.\n- **Using <code>as restrictive</code> ensures this policy will restrict all commands on the**\n**table regardless of other policies!**\n"
    }
  },
  {
    "chunk_id": "d6355863-1a43-45a5-b7b5-bfd8a0274d5c",
    "metadata": {
      "token_count": 361,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Adding to your app \\#",
        "h3": "## Enforce for new users only"
      },
      "text": " claim other than\n<code>aal2</code>, which is the highest authenticator assurance level.\n- **Using <code>as restrictive</code> ensures this policy will restrict all commands on the**\n**table regardless of other policies!**\nIf your app falls under this case, the rules get more complex. User accounts created past a certain timestamp must have a <code>aal2</code> level to access the database.\n\n`\n_13\ncreate policy \"Policy name.\"\n_13\non table_name\n_13\nas restrictive -- very important!\n_13\nto authenticated\n_13\nusing\n_13\n    (array[(select auth.jwt()->>'aal')] <@ (\n_13\n       select\n_13\n         case\n_13\n           when created_at >= '2022-12-12T00:00:00Z' then array['aal2']\n_13\n           else array['aal1', 'aal2']\n_13\n         end as aal\n_13\n       from auth.users\n_13\n       where (select auth.uid()) = id));\n`\n\n- The policy will accept both <code>aal1</code> and <code>aal2</code> for users with a <code>created_at</code>\ntimestamp prior to 12th December 2022 at 00:00 UTC, but will only accept\n<code>aal2</code> for all other timestamps.\n- The <code><@</code> operator is PostgreSQL's [\"contained in\"\\\\\noperator.](https://www.postgresql.org/docs/current/functions-array.html)\n- **Using <code>as restrictive</code> ensures this policy will restrict all commands on the**\n**table regardless of other policies!**\n"
    }
  },
  {
    "chunk_id": "064c8fa4-9ebc-4133-8aee-ec009e9e9be9",
    "metadata": {
      "token_count": 333,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Adding to your app \\#",
        "h3": "## Enforce only for users that have opted-in"
      },
      "text": " [\"contained in\"\\\\\noperator.](https://www.postgresql.org/docs/current/functions-array.html)\n- **Using <code>as restrictive</code> ensures this policy will restrict all commands on the**\n**table regardless of other policies!**\nUsers that have enrolled MFA on their account are expecting that your\napplication only works for them if they've gone through MFA.\n\n`\n_14\ncreate policy \"Policy name.\"\n_14\non table_name\n_14\nas restrictive -- very important!\n_14\nto authenticated\n_14\nusing (\n_14\n    array[(select auth.jwt()->>'aal')] <@ (\n_14\n      select\n_14\n          case\n_14\n            when count(id) > 0 then array['aal2']\n_14\n            else array['aal1', 'aal2']\n_14\n          end as aal\n_14\n        from auth.mfa_factors\n_14\n        where ((select auth.uid()) = user_id) and status = 'verified'\n_14\n    ));\n`\n\n- The policy will only accept only <code>aal2</code> when the user has at least one MFA\nfactor verified.\n- Otherwise, it will accept both <code>aal1</code> and <code>aal2</code>.\n- The <code><@</code> operator is PostgreSQL's [\"contained in\"\\\\\noperator.](https://www.postgresql.org/docs/current/functions-array.html)\n- **Using <code>as restrictive</code> ensures this policy will restrict all commands on the**\n**table regardless of other policies!**\n"
    }
  },
  {
    "chunk_id": "23d7a337-558a-4647-8811-e6807f158204",
    "metadata": {
      "token_count": 304,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Adding to your app \\#",
        "h3": "Server-Side Rendering \\#"
      },
      "text": " [\"contained in\"\\\\\noperator.](https://www.postgresql.org/docs/current/functions-array.html)\n- **Using <code>as restrictive</code> ensures this policy will restrict all commands on the**\n**table regardless of other policies!**\nWhen using the Supabase JavaScript library in a server-side rendering context, make sure you always create a new object for each request! This will prevent you from accidentally rendering and serving content belonging to different users.\n\nIt is possible to enforce MFA on the Server-Side Rendering level. However, this can be tricky do to well.\n\nYou can use the <code>supabase.auth.mfa.getAuthenticatorAssuranceLevel()</code> and <code>supabase.auth.mfa.listFactors()</code> APIs to identify the AAL level of the session and any factors that are enabled for a user, similar to how you would use these on the browser.\n\nHowever, encountering a different AAL level on the server may not actually be a security problem. Consider these likely scenarios:\n\n1. User signed-in with a conventional method but closed their tab on the MFA\nflow.\n2. User forgot a tab open for a very long time. (This happens more often than\nyou might imagine.)\n3. User has lost their authenticator device and is confused about the next\nsteps.\n\nWe thus recommend you redirect users to a page where they can authenticate using their additional factor, instead of rendering a HTTP 401 Unauthorized or HTTP 403 Forbidden content.\n"
    }
  },
  {
    "chunk_id": "2e5cb9a5-c500-4e15-8aa9-045a9650eea6",
    "metadata": {
      "token_count": 251,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa",
      "page_title": "Multi-Factor Authentication | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication",
        "h2": "Adding to your app \\#",
        "h3": "APIs \\#"
      },
      "text": ". User has lost their authenticator device and is confused about the next\nsteps.\n\nWe thus recommend you redirect users to a page where they can authenticate using their additional factor, instead of rendering a HTTP 401 Unauthorized or HTTP 403 Forbidden content.\nIf your application uses the Supabase Database, Storage or Edge Functions, just using Row Level Security policies will give you sufficient protection. In the event that you have other APIs that you wish to protect, follow these general guidelines:\n\n1. **Use a good JWT verification and parsing library for your language.**\nThis will let you securely parse JWTs and extract their claims.\n2. **Retrieve the <code>aal</code> claim from the JWT and compare its value according to**\n**your needs.**\nIf you've encountered an AAL level that can be increased, ask the user to\ncontinue the login process instead of logging them out.\n3. **Use the <code>https://<project-ref>.supabase.co/rest/v1/auth/factors</code> REST**\n**endpoint to identify if the user has enrolled any MFA factors.**\nOnly <code>verified</code> factors should be acted upon.\nHow do I check when a user went through MFA?\n"
    }
  },
  {
    "chunk_id": "34bbe5ce-705b-4b04-8b26-7f1aaea177c3",
    "metadata": {
      "token_count": 86,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/nextjs",
      "page_title": "Supabase Auth with the Next.js App Router | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Supabase Auth with the Next.js App Router",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nThe <code>auth-helpers</code> package has been replaced with the <code>@supabase/ssr</code> package. We recommend setting up Auth for your Next.js app with <code>@supabase/ssr</code> instead. See the [Next.js Server-Side Auth guide](/docs/guides/auth/server-side/nextjs) to learn how.\n\nSee legacy docs\n"
    }
  },
  {
    "chunk_id": "9b84af24-4c91-4c06-b368-3a7b21e152f6",
    "metadata": {
      "token_count": 334,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks",
      "page_title": "Auth Hooks | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth Hooks",
        "h2": "What is a hook \\#",
        "h3": ""
      },
      "text": "Auth\nA hook is an endpoint that allows you to alter the default Supabase Auth flow at specific execution points. Developers can use hooks to add custom behavior that's not supported natively.\n\nHooks help you:\n\n- Track the origin of user signups by adding metadata\n- Improve security by adding additional checks to password and multi-factor authentication\n- Support legacy systems by integrating with identity credentials from external authentication systems\n- Add additional custom claims to your JWT\n- Send authentication emails or SMS messages through a custom provider\n\nThe following hooks are available:\n\n| Hook | Available on Plan |\n| --- | --- |\n| [Custom Access Token](/docs/guides/auth/auth-hooks/custom-access-token-hook) | Free, Pro |\n| [Send SMS](/docs/guides/auth/auth-hooks/send-sms-hook) | Free, Pro |\n| [Send Email](/docs/guides/auth/auth-hooks/send-email-hook) | Free, Pro |\n| [MFA Verification Attempt](/docs/guides/auth/auth-hooks/mfa-verification-hook) | Teams and Enterprise |\n| [Password Verification Attempt](/docs/guides/auth/auth-hooks/password-verification-hook) | Teams and Enterprise |\n\nSupabase supports 2 ways to [configure a hook](/dashboard/project/_/auth/hooks) in your project:\n\nPostgres FunctionHTTP Endpoint\n\nA [postgres function](/docs/guides/database/functions) can be configured as a hook. The function should take in a single argument -- the event of type JSONB -- and return a JSONB object. Since the postgres function runs on your database, the request does not leave your project's instance.\n"
    }
  },
  {
    "chunk_id": "593aa41d-2d2b-41bd-b20f-b095b732e0bc",
    "metadata": {
      "token_count": 305,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks",
      "page_title": "Auth Hooks | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth Hooks",
        "h2": "Security Model \\#",
        "h3": ""
      },
      "text": ") can be configured as a hook. The function should take in a single argument -- the event of type JSONB -- and return a JSONB object. Since the postgres function runs on your database, the request does not leave your project's instance.\nSign the payload and grant permissions selectively in order to guard the integrity of the payload.\n\nSQLHTTP\n\nWhen you configure a postgres function as a hook, Supabase will automatically apply the following grants to the function for these reasons:\n\n- Allow the <code>supabase_auth_admin</code> role to execute the function. The <code>supabase_auth_admin</code> role is the postgres role that is used by Supabase Auth to make requests to your database.\n- Revoke permissions from other roles (e.g. <code>anon</code>, <code>authenticated</code>, <code>public</code>) to ensure the function is not accessible by Supabase Data APIs.\n\n`\n1\n-- Grant access to function to supabase_auth_admin\n2\ngrant execute\n3\non function public.custom_access_token_hook\n4\nto supabase_auth_admin;\n5\n6\n-- Grant access to schema to supabase_auth_admin\n7\ngrant usage on schema public to supabase_auth_admin;\n8\n9\n-- Revoke function permissions from authenticated, anon and public\n10\nrevoke execute\n11\non function public.custom_access_token_hook\n12\nfrom authenticated, anon, public;\n`\n"
    }
  },
  {
    "chunk_id": "1f984b82-d29a-40ee-8ab8-98184b92187a",
    "metadata": {
      "token_count": 886,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks",
      "page_title": "Auth Hooks | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth Hooks",
        "h2": "Security Model \\#",
        "h3": "## Create postgres functions with security invoker"
      },
      "text": " public to supabase_auth_admin;\n8\n9\n-- Revoke function permissions from authenticated, anon and public\n10\nrevoke execute\n11\non function public.custom_access_token_hook\n12\nfrom authenticated, anon, public;\n`\nWe do not recommend creating postgres functions with the <code>security definer</code> tag. The <code>security definer</code> tag specifies that the function is to be executed with the privileges of the user that owns it. Read more about the <code>security definer</code> tag [in our database guide](/docs/guides/database/functions#security-definer-vs-invoker).\nLet us develop a Hook locally and then deploy it to the cloud. As a recap, here\u2019s a list of available Hooks\n\n| Hook | Suggested Function Name | When it is called | What it Does |\n| --- | --- | --- | --- |\n| Send SMS | <code>send_sms</code> | Each time an SMS is sent | Allows you to customize message content and SMS Provider |\n| Send Email | <code>send_email</code> | Each time an Email is sent | Allows you to customize message content and Email Provider |\n| Custom Access Token | <code>custom_access_token</code> | Each time a new JWT is created | Returns the claims you wish to be present in the JWT. |\n| MFA Verification Attempt | <code>mfa_verification_attempt</code> | Each time a user tries to verify an MFA factor. | Returns a decision on whether to reject the attempt and future ones, or to allow the user to keep trying. |\n| Password Verification Attempt | <code>password_verification_attempt</code> | Each time a user tries to sign in with a password. | Return a decision whether to allow the user to reject the attempt, or to allow the user to keep trying. |\n\nEdit <code>config.toml</code> to set up the Auth Hook locally.\n\nSQLHTTP\n\nModify the <code>auth.hook.<hook_name></code> field and set <code>uri</code> to a value of <code>pg-functions://postgres/<schema>/<function_name></code>\n\n`\n1\n[auth.hook.<hook_name>]\n2\nenabled = true\n3\nuri = \"pg-functions://....\"\n`\n\nYou need to assign additional permissions so that Supabase Auth can access the hook as well as the tables it interacts with.\n\nThe <code>supabase_auth_admin</code> role does not have permissions to the <code>public</code> schema. You need to grant the role permission to execute your hook:\n\n`\n1\ngrant execute\n2\non function public.custom_access_token_hook\n3\nto supabase_auth_admin;\n`\n\nYou also need to grant usage to <code>supabase_auth_admin</code>:\n\n`\n1\ngrant usage on schema public to supabase_auth_admin;\n`\n\nAlso revoke permissions from the <code>authenticated</code> and <code>anon</code> roles to ensure the function is not accessible by Supabase Serverless APIs.\n\n`\n1\nrevoke execute\n2\non function public.custom_access_token_hook\n3\nfrom authenticated, anon;\n`\n\nFor security, we recommend against the use the <code>security definer</code> tag. The <code>security definer</code> tag specifies that the function is to be executed with the privileges of the user that owns it. When a function is created via the Supabase dashboard with the tag, it will have the extensive permissions of the <code>postgres</code> role which make it easier for undesirable actions to occur.\n\nWe recommend that you do not use any tag and explicitly grant permissions to <code>supabase_auth_admin</code> as described above.\n\nRead more about <code>security definer</code> tag [in our database guide](/docs/guides/database/functions#security-definer-vs-invoker).\n\nThere are no restrictions as to what language can be used to write a Postgres Hook. If [PL/pgSQL](https://www.postgresql.org/docs/current/plpgsql.html) is too difficult consider using the [plv8](/docs/guides/database/extensions/plv8) extension which lets you use JavaScript to define functions.\n\n"
    }
  },
  {
    "chunk_id": "1f2660d4-2539-4c42-9d9d-8f9783244358",
    "metadata": {
      "token_count": 261,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks",
      "page_title": "Auth Hooks | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth Hooks",
        "h2": "Using Hooks \\#",
        "h3": "Developing \\#"
      },
      "text": " If [PL/pgSQL](https://www.postgresql.org/docs/current/plpgsql.html) is too difficult consider using the [plv8](/docs/guides/database/extensions/plv8) extension which lets you use JavaScript to define functions.\n\nOnce done, save your Auth Hook as a migration in order to version the Auth Hook and share it with other team members. Run [<code>supabase migration new</code>](/docs/reference/cli/supabase-migration-new) to create a migration.\n\nIf you're using the Supabase SQL Editor, there's an issue when using the <code>?</code> ( _Does the string exist as a top-level key within the JSON value?_) operator. Use a direct connection to the database if you need to use it when defining a function.\n\nHere is an example hook signature:\n\n`\n1\ncreate or replace function public.custom_access_token_hook(event jsonb)\n2\nreturns jsonb\n3\nlanguage plpgsql\n4\nas $$\n5\ndeclare\n6\n  -- Insert variables here\n7\nbegin\n8\n  -- Insert logic here\n9\nreturn event;\n10\nend;\n11\n$$;\n`\n\nYou can visit <code>SQL Editor > Templates</code> for hook templates.\n"
    }
  },
  {
    "chunk_id": "eaf37388-7670-4f7e-8633-ac11d868c845",
    "metadata": {
      "token_count": 434,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks",
      "page_title": "Auth Hooks | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth Hooks",
        "h2": "Using Hooks \\#",
        "h3": "Deploying \\#"
      },
      "text": "\n  -- Insert variables here\n7\nbegin\n8\n  -- Insert logic here\n9\nreturn event;\n10\nend;\n11\n$$;\n`\n\nYou can visit <code>SQL Editor > Templates</code> for hook templates.\nIn the dashboard, navigate to [<code>Authentication > Hooks</code>](/dashboard/project/_/auth/hooks) and select the appropriate function type (SQL or HTTP) from the dropdown menu.\nYou should return an error when facing a runtime error. Runtime errors are specific to your application and arise from specific business rules rather than programmer errors.\n\nRuntime errors could happen when:\n\n- The user does not have appropriate permissions\n- The event payload received does not have required claims.\n- The user has performed an action which violates a business rule.\n- The email or phone provider used in the webhook returned an error.\n\nSQLHTTP\n\nThe error is a JSON object and has the following properties:\n\n- <code>error</code> An object that contains information about the error.\n  - <code>http_code</code> A number indicating the HTTP code to be returned. If not set, the code is HTTP 500 Internal Server Error.\n  - <code>message</code> A message to be returned in the HTTP response. Required.\n\nHere's an example:\n\n`\n1\n{\n2\n\"error\": {\n3\n    \"http_code\": 429,\n4\n    \"message\": \"You can only verify a factor once every 10 seconds.\"\n5\n}\n6\n}\n`\n\nErrors returned from a Postgres Hook are not retry-able. When an error is returned, the error is propagated from the hook to Supabase Auth and translated into a HTTP error which is returned to your application. Supabase Auth will only take into account the error and disregard the rest of the payload.\n\nOutside of runtime errors, both HTTP Hooks and Postgres Hooks return timeout errors. Postgres Hooks have 2 seconds to complete processing while HTTP Hooks should complete in 5 seconds. Both HTTP Hooks and Postgres Hooks are run in a transaction do limit the duration of execution to avoid delays in authentication process.\n"
    }
  },
  {
    "chunk_id": "cba620f3-3446-4c62-aeb6-d948db2a7b2d",
    "metadata": {
      "token_count": 271,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks",
      "page_title": "Auth Hooks | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth Hooks",
        "h2": "Available Hooks \\#",
        "h3": ""
      },
      "text": " Hooks return timeout errors. Postgres Hooks have 2 seconds to complete processing while HTTP Hooks should complete in 5 seconds. Both HTTP Hooks and Postgres Hooks are run in a transaction do limit the duration of execution to avoid delays in authentication process.\nEach Hook description contains an example JSONSchema which you can use in conjunction with [JSONSchema Faker](https://json-schema-faker.js.org/) in order to generate a mock payload. For HTTP Hooks, you can also use [the Standard Webhooks Testing Tool](https://www.standardwebhooks.com/simulate) to simulate a request.\n\n[Custom Access Token\\\\\n\\\\\nCustomize the access token issued by Supabase Auth](/docs/guides/auth/auth-hooks/custom-access-token-hook)\n\n[Send SMS\\\\\n\\\\\nUse a custom SMS provider to send authentication messages](/docs/guides/auth/auth-hooks/send-sms-hook)\n\n[Send Email\\\\\n\\\\\nUse a custom email provider to send authentication messages](/docs/guides/auth/auth-hooks/send-email-hook)\n\n[MFA Verification\\\\\n\\\\\nAdd additional checks to the MFA verification flow](/docs/guides/auth/auth-hooks/mfa-verification-hook)\n\n[Password verification\\\\\n\\\\\nAdd additional checks to the password verification flow](/docs/guides/auth/auth-hooks/password-verification-hook)\n"
    }
  },
  {
    "chunk_id": "38d33a7c-48e9-4147-b198-6e2ad2dd58a1",
    "metadata": {
      "token_count": 171,
      "source_url": "https://supabase.com/docs/guides/auth/auth-hooks",
      "page_title": "Auth Hooks | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth Hooks",
        "h2": "Available Hooks \\#",
        "h3": "Is this helpful?"
      },
      "text": " to the MFA verification flow](/docs/guides/auth/auth-hooks/mfa-verification-hook)\n\n[Password verification\\\\\n\\\\\nAdd additional checks to the password verification flow](/docs/guides/auth/auth-hooks/password-verification-hook)\nYesNo\n\nThanks for your feedback!\n\n- [What is a hook](#what-is-a-hook)\n- [Security Model](#security-model)\n- [Using Hooks](#using-hooks)\n- [Developing](#developing)\n- [Deploying](#deploying)\n- [Error Handling](#error-handling)\n- [Available Hooks](#available-hooks)\n\n1. We only collect analytics essential to ensuring smooth operation of our services. [Learn more](https://supabase.com/privacy)\n\n   AcceptOpt out[Learn more](https://supabase.com/privacy)\n"
    }
  },
  {
    "chunk_id": "da936f04-80e6-4606-9000-0ac533e8cc72",
    "metadata": {
      "token_count": 247,
      "source_url": "https://supabase.com/docs/guides/auth/sessions",
      "page_title": "User sessions | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User sessions",
        "h2": "What is a session? \\#",
        "h3": ""
      },
      "text": "Auth\nSupabase Auth provides fine-grained control over your user's sessions.\n\nSome security sensitive applications, or those that need to be SOC 2, HIPAA, PCI-DSS or ISO27000 compliant will require some sort of additional session controls to enforce timeouts or provide additional security guarantees. Supabase Auth makes it easy to build compliant applications.\nA session is created when a user signs in. By default, it lasts indefinitely and a user can have an unlimited number of active sessions on as many devices.\n\nA session is represented by the Supabase Auth access token in the form of a JWT, and a refresh token which is a unique string.\n\nAccess tokens are designed to be short lived, usually between 5 minutes and 1 hour while refresh tokens never expire but can only be used once. You can exchange a refresh token only once to get a new access and refresh token pair.\n\nThis process is called **refreshing the session.**\n\nA session terminates, depending on configuration, when:\n\n- The user clicks sign out.\n- The user changes their password or performs a security sensitive action.\n- It times out due to inactivity.\n- It reaches its maximum lifetime.\n- A user signs in on another device.\n"
    }
  },
  {
    "chunk_id": "0ef3e16f-82e9-4efd-be53-34a5f2bef6f6",
    "metadata": {
      "token_count": 183,
      "source_url": "https://supabase.com/docs/guides/auth/sessions",
      "page_title": "User sessions | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User sessions",
        "h2": "Access token (JWT) claims \\#",
        "h3": ""
      },
      "text": " on configuration, when:\n\n- The user clicks sign out.\n- The user changes their password or performs a security sensitive action.\n- It times out due to inactivity.\n- It reaches its maximum lifetime.\n- A user signs in on another device.\nEvery access token contains a <code>session_id</code> claim, a UUID, uniquely identifying the session of the user. You can correlate this ID with the primary key of the <code>auth.sessions</code> table.\nA session is initiated when a user signs in. The session is stored in the <code>auth.sessions</code> table, and your app should receive the access and refresh tokens.\n\nThere are two flows for initiating a session and receiving the tokens:\n\n- [Implicit flow](/docs/guides/auth/sessions/implicit-flow)\n- [PKCE flow](/docs/guides/auth/sessions/pkce-flow)\n"
    }
  },
  {
    "chunk_id": "e51cb2d3-2daa-45a0-8b81-8068be29341e",
    "metadata": {
      "token_count": 481,
      "source_url": "https://supabase.com/docs/guides/auth/sessions",
      "page_title": "User sessions | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User sessions",
        "h2": "Limiting session lifetime and number of allowed sessions per user \\#",
        "h3": ""
      },
      "text": ".\n\nThere are two flows for initiating a session and receiving the tokens:\n\n- [Implicit flow](/docs/guides/auth/sessions/implicit-flow)\n- [PKCE flow](/docs/guides/auth/sessions/pkce-flow)\nThis feature is only available on Pro Plans and up.\n\nSupabase Auth can be configured to limit the lifetime of a user's session. By default, all sessions are active until the user signs out or performs some other action that terminates a session.\n\nIn some applications, it's useful or required for security to ensure that users authenticate often, or that sessions are not left active on devices for too long.\n\nThere are three ways to limit the lifetime of a session:\n\n- Time-boxed sessions, which terminate after a fixed amount of time.\n- Set an inactivity timeout, which terminates sessions that haven't been refreshed within the timeout duration.\n- Enforce a single-session per user, which only keeps the most recently active session.\n\nTo make sure that users are required to re-authenticate periodically, you can set a positive value for the **Time-box user sessions** option in the [Auth settings](/dashboard/project/_/settings/auth) for your project.\n\nTo make sure that sessions expire after a period of inactivity, you can set a positive duration for the **Inactivity timeout** option in the [Auth settings](/dashboard/project/_/settings/auth).\n\nYou can also enforce only one active session per user per device or browser. When this is enabled, the session from the most recent sign in will remain active, while the rest are terminated. Enable this via the _Single session per user_ option in the [Auth settings](/dashboard/project/_/settings/auth).\n\nSessions are not proactively destroyed when you change these settings, but rather the check is enforced whenever a session is refreshed next. This can confuse developers because the actual duration of a session is the configured timeout plus the JWT expiration time. For single session per user, the effect will only be noticed at intervals of the JWT expiration time. Please make sure you adjust this setting depending on your needs. We do not recommend going below 5 minutes for the JWT expiration time.\n\nOtherwise sessions are progressively deleted from the database 24 hours after they expire, which prevents you from causing a high load on your project by accident and allows you some freedom to undo changes without adversely affecting all users.\n"
    }
  },
  {
    "chunk_id": "f522241b-2b38-4f5f-8b1e-67591fe9f80c",
    "metadata": {
      "token_count": 278,
      "source_url": "https://supabase.com/docs/guides/auth/sessions",
      "page_title": "User sessions | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User sessions",
        "h2": "Frequently asked questions \\#",
        "h3": "What are recommended values for access token (JWT) expiration? \\#"
      },
      "text": "5 minutes for the JWT expiration time.\n\nOtherwise sessions are progressively deleted from the database 24 hours after they expire, which prevents you from causing a high load on your project by accident and allows you some freedom to undo changes without adversely affecting all users.\nMost applications should use the default expiration time of 1 hour. This can be customized in your project's [Auth settings](/dashboard/project/_/settings/auth) in the Advanced Settings section.\n\nSetting a value over 1 hour is generally discouraged for security reasons, but it may make sense in certain situations.\n\nValues below 5 minutes, and especially below 2 minutes, should not be used in most situations because:\n\n- The shorter the expiration time, the more frequently refresh tokens are used, which increases the load on the Auth server.\n- Time is not absolute. Servers can often be off sync for tens of seconds, but user devices like laptops, desktops or mobile devices can sometimes be off by minutes or even hours. Having too short expiration time can cause difficult-to-debug errors due to clock skew.\n- Supabase's client libraries always try to refresh the session ahead of time, which won't be possible if the expiration time is too short.\n- Access tokens should generally be valid for at least as long as the longest running request in your application. This helps you avoid issues where the access token becomes invalid midway through processing.\n"
    }
  },
  {
    "chunk_id": "0c9b08a2-ea81-430c-b892-523077431847",
    "metadata": {
      "token_count": 478,
      "source_url": "https://supabase.com/docs/guides/auth/sessions",
      "page_title": "User sessions | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User sessions",
        "h2": "Frequently asked questions \\#",
        "h3": "What is refresh token reuse detection and what does it protect from? \\#"
      },
      "text": ", which won't be possible if the expiration time is too short.\n- Access tokens should generally be valid for at least as long as the longest running request in your application. This helps you avoid issues where the access token becomes invalid midway through processing.\nAs your users continue using your app, refresh tokens are being constantly exchanged for new access tokens.\n\nThe general rule is that a refresh token can only be used once. However, strictly enforcing this can cause certain issues to arise. There are two exceptions to this design to prevent the early and unexpected termination of user's sessions:\n\n- A refresh token can be used more than once within a defined reuse interval. By default this is 10 seconds and we do not recommend changing this value. This exception is granted for legitimate situations such as:\n  - Using server-side rendering where the same refresh token needs to be reused on the server and soon after on the client\n  - To allow some leeway for bugs or issues with serializing access to the refresh token request\n- If the parent of the currently active refresh token for the user's session is being used, the active token will be returned. This exception solves an important and often common situation:\n  - All clients such as browsers, mobile or desktop apps, and even some servers are inherently unreliable due to network issues. A request does not indicate that they received a response or even processed the response they received.\n  - If a refresh token is revoked after being used only once, and the response wasn't received and processed by the client, when the client comes back online, it will attempt to use the refresh token that was already used. Since this might happen outside of the reuse interval, it can cause sudden and unexpected session termination.\n\nShould the reuse attempt not fall under these two exceptions, the whole session is regarded as terminated and all refresh tokens belonging to it are marked as revoked. You can disable this behavior in the Advanced Settings of the [Auth settings](/dashboard/project/_/settings/auth) page, though it is generally not recommended.\n\nThe purpose of this mechanism is to guard against potential security issues where a refresh token could have been stolen from the user, for example by exposing it accidentally in logs that leak (like logging cookies, request bodies or URL params) or via vulnerable third-party servers. It does not guard against the case where a user's session is stolen from their device.\n"
    }
  },
  {
    "chunk_id": "1fe904bd-7f1a-4f97-b4e3-ee24609c96d6",
    "metadata": {
      "token_count": 310,
      "source_url": "https://supabase.com/docs/guides/auth/sessions",
      "page_title": "User sessions | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User sessions",
        "h2": "Frequently asked questions \\#",
        "h3": "What are the benefits of using access and refresh tokens instead of traditional sessions? \\#"
      },
      "text": " from the user, for example by exposing it accidentally in logs that leak (like logging cookies, request bodies or URL params) or via vulnerable third-party servers. It does not guard against the case where a user's session is stolen from their device.\nTraditionally user sessions were implemented by using a unique string stored in cookies that identified the authorization that the user had on a specific browser. Applications would use this unique string to constantly fetch the attached user information on every API call.\n\nThis approach has some tradeoffs compared to using a JWT-based approach:\n\n- If the authentication server or its database crashes or is unavailable for even a few seconds, the whole application goes down. Scheduling maintenance or dealing with transient errors becomes very challenging.\n- A failing authentication server can cause a chain of failures across other systems and APIs, paralyzing the whole application system.\n- All requests that require authentication has to be routed through the authentication, which adds an additional latency overhead to all requests.\n\nSupabase Auth prefers a JWT-based approach using access and refresh tokens are because the session information is encoded in a short-lived token -- the access token -- which can be transferred across APIs and systems without relying on the availability or performance of a central server. An application can thus tolerate transient failures or performance issues a lot better. By trying to refresh the access token ahead of time, your application can safely continue to function even with larger outages.\n\nIt's better for cost optimization and scaling as well, as the authentication system's servers and database only handle traffic for this use case.\n"
    }
  },
  {
    "chunk_id": "c069effb-ec00-4cdd-b851-a93f02d6a967",
    "metadata": {
      "token_count": 216,
      "source_url": "https://supabase.com/docs/guides/auth/sessions",
      "page_title": "User sessions | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User sessions",
        "h2": "Frequently asked questions \\#",
        "h3": "How do I make sure that an access token (JWT) cannot be used after a user clicks sign out? \\#"
      },
      "text": " trying to refresh the access token ahead of time, your application can safely continue to function even with larger outages.\n\nIt's better for cost optimization and scaling as well, as the authentication system's servers and database only handle traffic for this use case.\nMost applications rarely need such strong guarantees. Consider adjusting the JWT expiry time to an acceptable value. If this is still necessary, you should try to use this validation logic only for the most sensitive actions within your application.\n\nWhen a user signs out, the sessions affected by the logout are removed from the database entirely. You can check that the <code>session_id</code> claim in the JWT corresponds to a row in the <code>auth.sessions</code> table. If such a row does not exist, it means that the user has logged out.\n\nNote that sessions are not proactively terminated when their maximum lifetime (time-box) or inactivity timeout are reached. These sessions are cleaned up progressively 24 hours after reaching that status. This allows you to tweak the values or roll back changes without causing unintended user friction.\n"
    }
  },
  {
    "chunk_id": "236b21a5-8381-4929-be44-bdd26d2818c7",
    "metadata": {
      "token_count": 446,
      "source_url": "https://supabase.com/docs/guides/auth/sessions",
      "page_title": "User sessions | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User sessions",
        "h2": "Frequently asked questions \\#",
        "h3": "Can I use HTTP-Only cookies to store the access and refresh tokens? \\#"
      },
      "text": " not proactively terminated when their maximum lifetime (time-box) or inactivity timeout are reached. These sessions are cleaned up progressively 24 hours after reaching that status. This allows you to tweak the values or roll back changes without causing unintended user friction.\nThis is possible, but only for apps that use the traditional server-only web app approach where all of the application logic is implemented on the server and it returns rendered HTML only.\n\nIf your app uses any client side JavaScript to build a rich user experience, using HTTP-Only cookies is not feasible since only your server will be able to read and refresh the session of the user. The browser will not have access to the access and refresh tokens.\n\nBecause of this, the Supabase JavaScript libraries provide only limited support. You can override the <code>storage</code> option when creating the Supabase client **on the server** to store the values in cookies or your preferred storage choice, for example:\n\n`\n_10\nimport { createClient } from '@supabase/supabase-js'\n_10\n_10\nconst supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {\n_10\nauth: {\n_10\n    storage: customStorageObject,\n_10\n},\n_10\n})\n`\n\nThe <code>customStorageObject</code> should implement the <code>getItem</code>, <code>setItem</code>, and <code>removeItem</code> methods from the [<code>Storage</code> interface](https://developer.mozilla.org/en-US/docs/Web/API/Storage). Async versions of these methods are also supported.\n\nWhen using cookies to store access and refresh tokens, make sure that the [<code>Expires</code> or <code>Max-Age</code> attributes](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes) of the cookies is set to a timestamp very far into the future. Browsers will clear the cookies, but the session will remain active in Supabase Auth. Therefore it's best to let Supabase Auth control the validity of these tokens and instruct the browser to always store the cookies indefinitely.\n"
    }
  },
  {
    "chunk_id": "b24a5d0c-6464-4617-b94b-c1c3d767308a",
    "metadata": {
      "token_count": 327,
      "source_url": "https://supabase.com/docs/guides/auth/auth-anonymous",
      "page_title": "Anonymous Sign-Ins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Anonymous Sign-Ins",
        "h2": "Create and use anonymous users to authenticate with Supabase",
        "h3": "## Anonymous user vs the anon key"
      },
      "text": "Auth\n[Enable Anonymous Sign-Ins](/dashboard/project/_/settings/auth) to build apps which provide users an authenticated experience without requiring users to enter an email address, password, use an OAuth provider or provide any other PII (Personally Identifiable Information). Later, when ready, the user can link an authentication method to their account.\nCalling <code>signInAnonymously()</code> creates an anonymous user. It's just like a permanent user, except the user can't access their account if they sign out, clear browsing data, or use another device.\n\nLike permanent users, the <code>authenticated</code> Postgres role will be used when using the Data APIs to access your project. JWTs for these users will have an <code>is_anonymous</code> claim which you can use to distinguish in RLS policies.\n\nThis is different from the <code>anon</code> API key which does not create a user and can be used to implement public access to your database as it uses the <code>anonymous</code> Postgres role.\n\nAnonymous sign-ins can be used to build:\n\n- E-commerce applications, such as shopping carts before check-out\n- Full-feature demos without collecting personal information\n- Temporary or throw-away accounts\n\nReview your existing RLS policies before enabling anonymous sign-ins. Anonymous users use the <code>authenticated</code> role. To distinguish between anonymous users and permanent users, your policies need to check the <code>is_anonymous</code> field of the user's JWT.\n\nSee the [Access control section](#access-control) for more details.\n"
    }
  },
  {
    "chunk_id": "61203931-8cc5-4879-accb-ec1507c9d011",
    "metadata": {
      "token_count": 180,
      "source_url": "https://supabase.com/docs/guides/auth/auth-anonymous",
      "page_title": "Anonymous Sign-Ins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Anonymous Sign-Ins",
        "h2": "Create and use anonymous users to authenticate with Supabase",
        "h3": "## Use Dynamic Rendering with Next.js"
      },
      "text": "code> role. To distinguish between anonymous users and permanent users, your policies need to check the <code>is_anonymous</code> field of the user's JWT.\n\nSee the [Access control section](#access-control) for more details.\nThe Supabase team has received reports of user metadata being cached across unique anonymous users as a result of Next.js static page rendering. For the best user experience, utilize dynamic page rendering.\nFor self-hosting, you can update your project configuration using the files and environment variables provided. See the [local development docs](/docs/guides/cli/config) for more details.\nJavaScriptFlutterSwiftKotlinPython\n\nCall the [<code>signInAnonymously()</code>](/docs/reference/javascript/auth-signinanonymously) method:\n\n`\n_10\nconst { data, error } = await supabase.auth.signInAnonymously()\n`\n"
    }
  },
  {
    "chunk_id": "9199c913-d3a6-4fff-9548-8930a18e1283",
    "metadata": {
      "token_count": 281,
      "source_url": "https://supabase.com/docs/guides/auth/auth-anonymous",
      "page_title": "Anonymous Sign-Ins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Anonymous Sign-Ins",
        "h2": "Convert an anonymous user to a permanent user \\#",
        "h3": "Link an Email / Phone identity \\#"
      },
      "text": "otlinPython\n\nCall the [<code>signInAnonymously()</code>](/docs/reference/javascript/auth-signinanonymously) method:\n\n`\n_10\nconst { data, error } = await supabase.auth.signInAnonymously()\n`\nConverting an anonymous user to a permanent user requires [linking an identity](/docs/guides/auth/auth-identity-linking#manual-linking-beta) to the user. This requires you to [enable manual linking](/dashboard/project/_/settings/auth) in your Supabase project.\nJavaScriptFlutterSwiftKotlinPython\n\nYou can use the [<code>updateUser()</code>](/docs/reference/javascript/auth-updateuser) method to link an email or phone identity to the anonymous user. To add a password for the anonymous user, the user's email or phone number needs to be verified first.\n\n`\n_10\nconst { data, error } = await supabase.auth.updateUser({ email: 'example@email.com' })\n_10\n_10\n// verify the user's email by clicking on the email change link\n_10\n// or entering the 6-digit OTP sent to the email address\n_10\n_10\n// once the user has been verified, update the password\n_10\nconst { data, error } = await supabase.auth.updateUser({ password: 'password' })\n`\n"
    }
  },
  {
    "chunk_id": "b54bdce4-a009-4bbf-b037-17c8864475c3",
    "metadata": {
      "token_count": 281,
      "source_url": "https://supabase.com/docs/guides/auth/auth-anonymous",
      "page_title": "Anonymous Sign-Ins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Anonymous Sign-Ins",
        "h2": "Convert an anonymous user to a permanent user \\#",
        "h3": "Link an OAuth identity \\#"
      },
      "text": " OTP sent to the email address\n_10\n_10\n// once the user has been verified, update the password\n_10\nconst { data, error } = await supabase.auth.updateUser({ password: 'password' })\n`\nJavaScriptFlutterSwiftKotlinPython\n\nYou can use the [<code>linkIdentity()</code>](/docs/reference/javascript/auth-linkidentity) method to link an oauth identity to the anonymous user.\n\n`\n_10\nconst { data, error } = await supabase.auth.linkIdentity({ provider: 'google' })\n`\nAn anonymous user assumes the <code>authenticated</code> role just like a permanent user. You can use row-level security (RLS) policies to differentiate between an anonymous user and a permanent user by checking for the <code>is_anonymous</code> claim in the JWT returned by <code>auth.jwt()</code>:\n\n`\n_10\ncreate policy \"Only permanent users can post to the news feed\"\n_10\non news_feed as restrictive for insert\n_10\nto authenticated\n_10\nwith check ((select (auth.jwt()->>'is_anonymous')::boolean) is false );\n_10\n_10\ncreate policy \"Anonymous and permanent users can view the news feed\"\n_10\non news_feed for select\n_10\nto authenticated\n_10\nusing ( true );\n`\n"
    }
  },
  {
    "chunk_id": "c22954ff-c4e8-4ee9-a661-4334875054b6",
    "metadata": {
      "token_count": 225,
      "source_url": "https://supabase.com/docs/guides/auth/auth-anonymous",
      "page_title": "Anonymous Sign-Ins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Anonymous Sign-Ins",
        "h2": "Access control \\#",
        "h3": "## Use restrictive policies"
      },
      "text": "onymous')::boolean) is false );\n_10\n_10\ncreate policy \"Anonymous and permanent users can view the news feed\"\n_10\non news_feed for select\n_10\nto authenticated\n_10\nusing ( true );\n`\nRLS policies are permissive by default, which means that they are combined using an \"OR\" operator when multiple policies are applied. It is important to construct restrictive policies to ensure that the checks for an anonymous user are always enforced when combined with other policies.\nDepending on your application requirements, data conflicts can arise when an anonymous user is converted to a permanent user. For example, in the context of an e-commerce application, an anonymous user would be allowed to add items to the shopping cart without signing up / signing in. When they decide to sign-in to an existing account, you will need to decide how you want to resolve data conflicts in the shopping cart:\n\n1. Overwrite the items in the cart with those in the existing account\n2. Overwrite the items in the cart with those from the anonymous user\n3. Merge the items in the cart together\n"
    }
  },
  {
    "chunk_id": "892191e7-eab5-4288-bf6a-84d81e4e48d1",
    "metadata": {
      "token_count": 177,
      "source_url": "https://supabase.com/docs/guides/auth/auth-anonymous",
      "page_title": "Anonymous Sign-Ins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Anonymous Sign-Ins",
        "h2": "Abuse prevention and rate limits \\#",
        "h3": ""
      },
      "text": " resolve data conflicts in the shopping cart:\n\n1. Overwrite the items in the cart with those in the existing account\n2. Overwrite the items in the cart with those from the anonymous user\n3. Merge the items in the cart together\nSince anonymous users are stored in your database, bad actors can abuse the endpoint to increase your database size drastically. It is strongly recommended to [enable invisible Captcha or Cloudflare Turnstile](/docs/guides/auth/auth-captcha) to prevent abuse for anonymous sign-ins. An IP-based rate limit is enforced at 30 requests per hour which can be modified in your [dashboard](/dashboard/project/_/auth/rate-limits). You can refer to the full list of rate limits [here](/docs/guides/platform/going-into-prod#rate-limiting-resource-allocation--abuse-prevention).\n"
    }
  },
  {
    "chunk_id": "97f64bfd-1857-40fd-bbd2-739624689d45",
    "metadata": {
      "token_count": 209,
      "source_url": "https://supabase.com/docs/guides/auth/auth-anonymous",
      "page_title": "Anonymous Sign-Ins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Anonymous Sign-Ins",
        "h2": "Automatic cleanup \\#",
        "h3": ""
      },
      "text": "](/dashboard/project/_/auth/rate-limits). You can refer to the full list of rate limits [here](/docs/guides/platform/going-into-prod#rate-limiting-resource-allocation--abuse-prevention).\nAutomatic cleanup of anonymous users is currently not available. Instead, you can delete anonymous users from your project by running the following SQL:\n\n`\n_10\n-- deletes anonymous users created more than 30 days ago\n_10\ndelete from auth.users\n_10\nwhere is_anonymous is true and created_at < now() - interval '30 days';\n`\n- [Supabase - Get started for free](https://supabase.com)\n- [Supabase JS Client](https://github.com/supabase/supabase-js)\n- [Supabase Flutter Client](https://github.com/supabase/supabase-flutter)\n- [Supabase Kotlin Client](https://github.com/supabase-community/supabase-kt)\n"
    }
  },
  {
    "chunk_id": "3ebb602b-eb08-44df-aaab-3f02417b79f2",
    "metadata": {
      "token_count": 132,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nAs of 7th Feb 2024, [this repository](https://github.com/supabase-community/auth-ui) is no longer maintained by the Supabase Team. At the moment, the team does not have capacity to give the expected level of care to this repository. We may revisit Auth UI in the future but regrettably have to leave it on hold for now as we focus on other priorities such as improving the Server-Side Rendering (SSR) package and advanced Auth primitives.\n\nAuth UI is a pre-built React component for authenticating users.\nIt supports custom themes and extensible styles to match your brand and aesthetic.\n"
    }
  },
  {
    "chunk_id": "5c35f35b-a6fe-4b8a-abad-6af859293d49",
    "metadata": {
      "token_count": 418,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Set up Auth UI \\#",
        "h3": "Import the Auth component \\#"
      },
      "text": " focus on other priorities such as improving the Server-Side Rendering (SSR) package and advanced Auth primitives.\n\nAuth UI is a pre-built React component for authenticating users.\nIt supports custom themes and extensible styles to match your brand and aesthetic.\nInstall the latest version of [supabase-js](/docs/reference/javascript) and the Auth UI package:\n\n`\n_10\nnpm install @supabase/supabase-js @supabase/auth-ui-react @supabase/auth-ui-shared\n`\nPass <code>supabaseClient</code> from <code>@supabase/supabase-js</code> as a prop to the component.\n\n/src/index.js\n\n`\n_10\nimport { createClient } from '@supabase/supabase-js'\n_10\nimport { Auth } from '@supabase/auth-ui-react'\n_10\n_10\nconst supabase = createClient('<INSERT PROJECT URL>', '<INSERT PROJECT ANON API KEY>')\n_10\n_10\nconst App = () => <Auth supabaseClient={supabase} />\n`\n\nThis renders the Auth component without any styling.\nWe recommend using one of the predefined themes to style the UI.\nImport the theme you want to use and pass it to the <code>appearance.theme</code> prop.\n\n`\n_18\nimport { Auth } from '@supabase/auth-ui-react'\n_18\nimport {\n_18\n// Import predefined theme\n_18\nThemeSupa,\n_18\n} from '@supabase/auth-ui-shared'\n_18\n_18\nconst supabase = createClient(\n_18\n'<INSERT PROJECT URL>',\n_18\n'<INSERT PROJECT ANON API KEY>'\n_18\n)\n_18\n_18\nconst App = () => (\n_18\n<Auth\n_18\n    supabaseClient={supabase}\n_18\n    {/* Apply predefined theme */}\n_18\n    appearance={{ theme: ThemeSupa }}\n_18\n/>\n_18\n)\n`\n"
    }
  },
  {
    "chunk_id": "c1afd5de-b766-4244-abb3-2977bbb124c1",
    "metadata": {
      "token_count": 213,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Set up Auth UI \\#",
        "h3": "Social providers \\#"
      },
      "text": " (\n_18\n<Auth\n_18\n    supabaseClient={supabase}\n_18\n    {/* Apply predefined theme */}\n_18\n    appearance={{ theme: ThemeSupa }}\n_18\n/>\n_18\n)\n`\nThe Auth component also supports login with [official social providers](../../auth#providers).\n\n`\n_13\nimport { createClient } from '@supabase/supabase-js'\n_13\nimport { Auth } from '@supabase/auth-ui-react'\n_13\nimport { ThemeSupa } from '@supabase/auth-ui-shared'\n_13\n_13\nconst supabase = createClient('<INSERT PROJECT URL>', '<INSERT PROJECT ANON API KEY>')\n_13\n_13\nconst App = () => (\n_13\n<Auth\n_13\n    supabaseClient={supabase}\n_13\n    appearance={{ theme: ThemeSupa }}\n_13\n    providers={['google', 'facebook', 'twitter']}\n_13\n/>\n_13\n)\n`\n"
    }
  },
  {
    "chunk_id": "414874bc-8c12-4995-b38e-3f6b77b40f7a",
    "metadata": {
      "token_count": 253,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Set up Auth UI \\#",
        "h3": "Options \\#"
      },
      "text": "Auth\n_13\n    supabaseClient={supabase}\n_13\n    appearance={{ theme: ThemeSupa }}\n_13\n    providers={['google', 'facebook', 'twitter']}\n_13\n/>\n_13\n)\n`\nOptions are available via <code>queryParams</code>:\n\n`\n_10\n<Auth\n_10\nsupabaseClient={supabase}\n_10\nproviders={['google']}\n_10\nqueryParams={{\n_10\n    access_type: 'offline',\n_10\n    prompt: 'consent',\n_10\n    hd: 'domain.com',\n_10\n}}\n_10\nonlyThirdPartyProviders\n_10\n/>\n`\nProvider Scopes can be requested through <code>providerScope</code>;\n\n`\n_12\n<Auth\n_12\nsupabaseClient={supabase}\n_12\nproviders={['google']}\n_12\nqueryParams={{\n_12\n    access_type: 'offline',\n_12\n    prompt: 'consent',\n_12\n    hd: 'domain.com',\n_12\n}}\n_12\nproviderScopes={{\n_12\n    google: 'https://www.googleapis.com/auth/calendar.readonly',\n_12\n}}\n_12\n/>\n`\n"
    }
  },
  {
    "chunk_id": "96c47aef-7fe1-4621-a602-7a3df823d602",
    "metadata": {
      "token_count": 229,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Set up Auth UI \\#",
        "h3": "Supported views \\#"
      },
      "text": "consent',\n_12\n    hd: 'domain.com',\n_12\n}}\n_12\nproviderScopes={{\n_12\n    google: 'https://www.googleapis.com/auth/calendar.readonly',\n_12\n}}\n_12\n/>\n`\nThe Auth component is currently shipped with the following views:\n\n- [Email Login](../auth-email)\n- [Magic Link login](../auth-magic-link)\n- [Social Login](../social-login)\n- Update password\n- Forgotten password\n\nWe are planning on adding more views in the future. Follow along on that [repo](https://github.com/supabase/auth-ui).\nThere are several ways to customize Auth UI:\n\n- Use one of the [predefined themes](#predefined-themes) that comes with Auth UI\n- Extend a theme by [overriding the variable tokens](#override-themes) in a theme\n- [Create your own theme](#create-theme)\n- [Use your own CSS classes](#custom-css-classes)\n- [Use inline styles](#custom-inline-styles)\n- [Use your own labels](#custom-labels)\n"
    }
  },
  {
    "chunk_id": "4edf7c9b-9201-4747-b893-530637782021",
    "metadata": {
      "token_count": 299,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Customization \\#",
        "h3": "Predefined themes \\#"
      },
      "text": "\n- [Create your own theme](#create-theme)\n- [Use your own CSS classes](#custom-css-classes)\n- [Use inline styles](#custom-inline-styles)\n- [Use your own labels](#custom-labels)\nAuth UI comes with several themes to customize the appearance. Each predefined theme comes with at least two variations, a <code>default</code> variation, and a <code>dark</code> variation. You can switch between these themes using the <code>theme</code> prop. Import the theme you want to use and pass it to the <code>appearance.theme</code> prop.\n\n`\n_16\nimport { createClient } from '@supabase/supabase-js'\n_16\nimport { Auth } from '@supabase/auth-ui-react'\n_16\nimport { ThemeSupa } from '@supabase/auth-ui-shared'\n_16\n_16\nconst supabase = createClient(\n_16\n'<INSERT PROJECT URL>',\n_16\n'<INSERT PROJECT ANON API KEY>'\n_16\n)\n_16\n_16\nconst App = () => (\n_16\n<Auth\n_16\n    supabaseClient={supabase}\n_16\n    {/* Apply predefined theme */}\n_16\n    appearance={{ theme: ThemeSupa }}\n_16\n/>\n_16\n)\n`\n\nCurrently there is only one predefined theme available, but we plan to add more.\n"
    }
  },
  {
    "chunk_id": "8afbfc29-5c3e-458c-8fb1-cda6a178fe23",
    "metadata": {
      "token_count": 322,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Customization \\#",
        "h3": "Switch theme variations \\#"
      },
      "text": "supabase}\n_16\n    {/* Apply predefined theme */}\n_16\n    appearance={{ theme: ThemeSupa }}\n_16\n/>\n_16\n)\n`\n\nCurrently there is only one predefined theme available, but we plan to add more.\nAuth UI comes with two theme variations: <code>default</code> and <code>dark</code>. You can switch between these themes with the <code>theme</code> prop.\n\n`\n_17\nimport { createClient } from '@supabase/supabase-js'\n_17\nimport { Auth } from '@supabase/auth-ui-react'\n_17\nimport { ThemeSupa } from '@supabase/auth-ui-shared'\n_17\n_17\nconst supabase = createClient(\n_17\n'<INSERT PROJECT URL>',\n_17\n'<INSERT PROJECT ANON API KEY>'\n_17\n)\n_17\n_17\nconst App = () => (\n_17\n<Auth\n_17\n    supabaseClient={supabase}\n_17\n    appearance={{ theme: ThemeSupa }}\n_17\n    {/* Set theme to dark */}\n_17\n    theme=\"dark\"\n_17\n/>\n_17\n)\n`\n\nIf you don't pass a value to <code>theme</code> it uses the <code>\"default\"</code> theme. You can pass <code>\"dark\"</code> to the theme prop to switch to the <code>dark</code> theme. If your theme has other variations, use the name of the variation in this prop.\n"
    }
  },
  {
    "chunk_id": "83d65755-78ee-473d-8d19-d2493a07a8d8",
    "metadata": {
      "token_count": 303,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Customization \\#",
        "h3": "Override themes \\#"
      },
      "text": "default\"</code> theme. You can pass <code>\"dark\"</code> to the theme prop to switch to the <code>dark</code> theme. If your theme has other variations, use the name of the variation in this prop.\nAuth UI themes can be overridden using variable tokens. See the [list of variable tokens](https://github.com/supabase/auth-ui/blob/main/packages/shared/src/theming/Themes.ts).\n\n`\n_22\nimport { createClient } from '@supabase/supabase-js'\n_22\nimport { Auth } from '@supabase/auth-ui-react'\n_22\nimport { ThemeSupa } from '@supabase/auth-ui-shared'\n_22\n_22\nconst supabase = createClient('<INSERT PROJECT URL>', '<INSERT PROJECT ANON API KEY>')\n_22\n_22\nconst App = () => (\n_22\n<Auth\n_22\n    supabaseClient={supabase}\n_22\n    appearance={{\n_22\n      theme: ThemeSupa,\n_22\n      variables: {\n_22\n        default: {\n_22\n          colors: {\n_22\n            brand: 'red',\n_22\n            brandAccent: 'darkred',\n_22\n          },\n_22\n        },\n_22\n      },\n_22\n    }}\n_22\n/>\n_22\n)\n`\n\nIf you created your own theme, you may not need to override any of them.\n"
    }
  },
  {
    "chunk_id": "5fd90f4a-eeb0-4f4f-8978-12dfe4239b3a",
    "metadata": {
      "token_count": 521,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Customization \\#",
        "h3": "Create your own theme \\#"
      },
      "text": " 'darkred',\n_22\n          },\n_22\n        },\n_22\n      },\n_22\n    }}\n_22\n/>\n_22\n)\n`\n\nIf you created your own theme, you may not need to override any of them.\nYou can create your own theme by following the same structure within a <code>appearance.theme</code> property.\nSee the list of [tokens within a theme](https://github.com/supabase/auth-ui/blob/main/packages/shared/src/theming/Themes.ts).\n\n/src/index.js\n\n`\n_40\nimport { createClient } from '@supabase/supabase-js'\n_40\nimport { Auth } from '@supabase/auth-ui-react'\n_40\n_40\nconst supabase = createClient('<INSERT PROJECT URL>', '<INSERT PROJECT ANON API KEY>')\n_40\n_40\nconst customTheme = {\n_40\ndefault: {\n_40\n    colors: {\n_40\n      brand: 'hsl(153 60.0% 53.0%)',\n_40\n      brandAccent: 'hsl(154 54.8% 45.1%)',\n_40\n      brandButtonText: 'white',\n_40\n      // ..\n_40\n    },\n_40\n},\n_40\ndark: {\n_40\n    colors: {\n_40\n      brandButtonText: 'white',\n_40\n      defaultButtonBackground: '#2e2e2e',\n_40\n      defaultButtonBackgroundHover: '#3e3e3e',\n_40\n      //..\n_40\n    },\n_40\n},\n_40\n// You can also add more theme variations with different names.\n_40\nevenDarker: {\n_40\n    colors: {\n_40\n      brandButtonText: 'white',\n_40\n      defaultButtonBackground: '#1e1e1e',\n_40\n      defaultButtonBackgroundHover: '#2e2e2e',\n_40\n      //..\n_40\n    },\n_40\n},\n_40\n}\n_40\n_40\nconst App = () => (\n_40\n<Auth\n_40\n    supabaseClient={supabase}\n_40\n    theme=\"default\" // can also be \"dark\" or \"evenDarker\"\n_40\n    appearance={{ theme: customTheme }}\n_40\n/>\n_40\n)\n`\n\nYou can switch between different variations of your theme with the [\"theme\" prop](#switch-theme-variations).\n"
    }
  },
  {
    "chunk_id": "ba5505ad-8452-4844-9e24-08d4e2e00589",
    "metadata": {
      "token_count": 314,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Customization \\#",
        "h3": "Custom CSS classes \\#"
      },
      "text": "dark\" or \"evenDarker\"\n_40\n    appearance={{ theme: customTheme }}\n_40\n/>\n_40\n)\n`\n\nYou can switch between different variations of your theme with the [\"theme\" prop](#switch-theme-variations).\nYou can use custom CSS classes for the following elements:\n<code>\"button\"</code>, <code>\"container\"</code>, <code>\"anchor\"</code>, <code>\"divider\"</code>, <code>\"label\"</code>, <code>\"input\"</code>, <code>\"loader\"</code>, <code>\"message\"</code>.\n\n/src/index.js\n\n`\n_20\nimport { createClient } from '@supabase/supabase-js'\n_20\nimport { Auth } from '@supabase/auth-ui-react'\n_20\n_20\nconst supabase = createClient('<INSERT PROJECT URL>', '<INSERT PROJECT ANON API KEY>')\n_20\n_20\nconst App = () => (\n_20\n<Auth\n_20\n    supabaseClient={supabase}\n_20\n    appearance={{\n_20\n      // If you want to extend the default styles instead of overriding it, set this to true\n_20\n      extend: false,\n_20\n      // Your custom classes\n_20\n      className: {\n_20\n        anchor: 'my-awesome-anchor',\n_20\n        button: 'my-awesome-button',\n_20\n        //..\n_20\n      },\n_20\n    }}\n_20\n/>\n_20\n)\n`\n"
    }
  },
  {
    "chunk_id": "342de4ef-32c1-4567-85b6-e887f3ebdb3d",
    "metadata": {
      "token_count": 284,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Customization \\#",
        "h3": "Custom inline CSS \\#"
      },
      "text": " className: {\n_20\n        anchor: 'my-awesome-anchor',\n_20\n        button: 'my-awesome-button',\n_20\n        //..\n_20\n      },\n_20\n    }}\n_20\n/>\n_20\n)\n`\nYou can use custom CSS inline styles for the following elements:\n<code>\"button\"</code>, <code>\"container\"</code>, <code>\"anchor\"</code>, <code>\"divider\"</code>, <code>\"label\"</code>, <code>\"input\"</code>, <code>\"loader\"</code>, <code>\"message\"</code>.\n\n/src/index.js\n\n`\n_17\nimport { createClient } from '@supabase/supabase-js'\n_17\nimport { Auth } from '@supabase/auth-ui-react'\n_17\n_17\nconst supabase = createClient('<INSERT PROJECT URL>', '<INSERT PROJECT ANON API KEY>')\n_17\n_17\nconst App = () => (\n_17\n<Auth\n_17\n    supabaseClient={supabase}\n_17\n    appearance={{\n_17\n      style: {\n_17\n        button: { background: 'red', color: 'white' },\n_17\n        anchor: { color: 'blue' },\n_17\n        //..\n_17\n      },\n_17\n    }}\n_17\n/>\n_17\n)\n`\n"
    }
  },
  {
    "chunk_id": "10952dfd-84cf-44b6-9693-b16b98494b74",
    "metadata": {
      "token_count": 446,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Customization \\#",
        "h3": "Custom labels \\#"
      },
      "text": " { background: 'red', color: 'white' },\n_17\n        anchor: { color: 'blue' },\n_17\n        //..\n_17\n      },\n_17\n    }}\n_17\n/>\n_17\n)\n`\nYou can use custom labels with <code>localization.variables</code> like so:\n\n`\n_18\nimport { createClient } from '@supabase/supabase-js'\n_18\nimport { Auth } from '@supabase/auth-ui-react'\n_18\n_18\nconst supabase = createClient('<INSERT PROJECT URL>', '<INSERT PROJECT ANON API KEY>')\n_18\n_18\nconst App = () => (\n_18\n<Auth\n_18\n    supabaseClient={supabase}\n_18\n    localization={{\n_18\n      variables: {\n_18\n        sign_in: {\n_18\n          email_label: 'Your email address',\n_18\n          password_label: 'Your strong password',\n_18\n        },\n_18\n      },\n_18\n    }}\n_18\n/>\n_18\n)\n`\n\nA full list of the available variables is below:\n\nSign UpSign InMagic LinkForgotten PasswordUpdate PasswordVerify OTP\n\n| Label Tag | Default Label |\n| --- | --- |\n| <code>email_label</code> | Email address |\n| <code>password_label</code> | Create a Password |\n| <code>email_input_placeholder</code> | Your email address |\n| <code>password_input_placeholder</code> | Your password |\n| <code>button_label</code> | Sign up |\n| <code>loading_button_label</code> | Signing up ... |\n| <code>social_provider_text</code> | Sign in with <code>{{provider}}</code> |\n| <code>link_text</code> | Don't have an account? Sign up |\n| <code>confirmation_text</code> | Check your email for the confirmation link |\n\nCurrently, translating error messages (e.g. \"Invalid credentials\") is not supported. Check [related issue.](https://github.com/supabase/auth-ui/issues/86)\n"
    }
  },
  {
    "chunk_id": "1df527a7-606f-4d77-9827-dccb7e70ebbb",
    "metadata": {
      "token_count": 279,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/auth-ui",
      "page_title": "Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth UI",
        "h2": "Customization \\#",
        "h3": "Hiding links \\#"
      },
      "text": "_text</code> | Check your email for the confirmation link |\n\nCurrently, translating error messages (e.g. \"Invalid credentials\") is not supported. Check [related issue.](https://github.com/supabase/auth-ui/issues/86)\nYou can hide links by setting the <code>showLinks</code> prop to <code>false</code>\n\n`\n_10\nimport { createClient } from '@supabase/supabase-js'\n_10\nimport { Auth } from '@supabase/auth-ui-react'\n_10\n_10\nconst supabase = createClient('<INSERT PROJECT URL>', '<INSERT PROJECT ANON API KEY>')\n_10\n_10\nconst App = () => <Auth supabaseClient={supabase} showLinks={false} />\n`\n\nSetting <code>showLinks</code> to <code>false</code> will hide the following links:\n\n- Don't have an account? Sign up\n- Already have an account? Sign in\n- Send a magic link email\n- Forgot your password?\nAdd <code>sign_in</code> or <code>sign_up</code> views with the <code>view</code> prop:\n\n`\n_10\n<Auth\n_10\nsupabaseClient={supabase}\n_10\nview=\"sign_up\"\n_10\n/>\n`\n"
    }
  },
  {
    "chunk_id": "6fa900b5-1f14-46aa-9e1d-96eac5cec5a8",
    "metadata": {
      "token_count": 124,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-passwordless",
      "page_title": "Passwordless email logins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Passwordless email logins",
        "h2": "Email logins using Magic Links or One-Time Passwords (OTPs)",
        "h3": ""
      },
      "text": "Auth\nSupabase Auth provides several passwordless login methods. Passwordless logins allow users to sign in without a password, by clicking a confirmation link or entering a verification code.\n\nPasswordless login can:\n\n- Improve the user experience by not requiring users to create and remember a password\n- Increase security by reducing the risk of password-related security breaches\n- Reduce support burden of dealing with password resets and other password-related flows\n\nSupabase Auth offers two passwordless login methods that use the user's email address:\n\n- [Magic Link](#with-magic-link)\n- [OTP](#with-otp)\n"
    }
  },
  {
    "chunk_id": "be321ced-a65b-4b0a-be6a-36578ba5010e",
    "metadata": {
      "token_count": 207,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-passwordless",
      "page_title": "Passwordless email logins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Passwordless email logins",
        "h2": "With Magic Link \\#",
        "h3": "Enabling Magic Link \\#"
      },
      "text": " burden of dealing with password resets and other password-related flows\n\nSupabase Auth offers two passwordless login methods that use the user's email address:\n\n- [Magic Link](#with-magic-link)\n- [OTP](#with-otp)\nMagic Links are a form of passwordless login where users click on a link sent to their email address to log in to their accounts. Magic Links only work with email addresses and are one-time use only.\nEmail authentication methods, including Magic Links, are enabled by default.\n\nConfigure the Site URL and any additional redirect URLs. These are the only URLs that are allowed as redirect destinations after the user clicks a Magic Link. You can change the URLs on the [Auth Providers page](/dashboard/project/_/auth/providers) for hosted projects, or in the [configuration file](/docs/guides/cli/config#auth.additional_redirect_urls) for self-hosted projects.\n\nBy default, a user can only request a magic link once every 60 seconds and they expire after 1 hour.\n"
    }
  },
  {
    "chunk_id": "fd35cae4-56bb-4279-a01d-331b006fa8e5",
    "metadata": {
      "token_count": 409,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-passwordless",
      "page_title": "Passwordless email logins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Passwordless email logins",
        "h2": "With Magic Link \\#",
        "h3": "Signing in with Magic Link \\#"
      },
      "text": " or in the [configuration file](/docs/guides/cli/config#auth.additional_redirect_urls) for self-hosted projects.\n\nBy default, a user can only request a magic link once every 60 seconds and they expire after 1 hour.\nCall the \"sign in with OTP\" method from the client library.\n\nThough the method is labelled \"OTP\", it sends a Magic Link by default. The two methods differ only in the content of the confirmation email sent to the user.\n\nIf the user hasn't signed up yet, they are automatically signed up by default. To prevent this, set the <code>shouldCreateUser</code> option to <code>false</code>.\n\nJavaScriptExpo React NativeDartSwiftKotlinPython\n\n`\n_10\nasync function signInWithEmail() {\n_10\nconst { data, error } = await supabase.auth.signInWithOtp({\n_10\n    email: 'example@email.com',\n_10\n    options: {\n_10\n      // set this to false if you do not want the user to be automatically signed up\n_10\n      shouldCreateUser: false,\n_10\n      emailRedirectTo: 'https://example.com/welcome',\n_10\n    },\n_10\n})\n_10\n}\n`\n\nThat's it for the implicit flow.\n\nIf you're using PKCE flow, edit the Magic Link [email template](/docs/guides/auth/auth-email-templates) to send a token hash:\n\n`\n_10\n<h2>Magic Link</h2>\n_10\n_10\n<p>Follow this link to login:</p>\n_10\n<p><a href=\"{{ .SiteURL }}/auth/confirm?token_hash={{ .TokenHash }}&type=magiclink\">Log In</a></p>\n`\n\nAt the <code>/auth/confirm</code> endpoint, exchange the hash for the session:\n\n`\n_10\nconst { error } = await supabase.auth.verifyOtp({ token_hash, type })\n`\n"
    }
  },
  {
    "chunk_id": "2e8ef9ac-988a-4e6a-becc-a489acf0b60b",
    "metadata": {
      "token_count": 344,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-passwordless",
      "page_title": "Passwordless email logins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Passwordless email logins",
        "h2": "With OTP \\#",
        "h3": "Enabling Email OTP \\#"
      },
      "text": "</a></p>\n`\n\nAt the <code>/auth/confirm</code> endpoint, exchange the hash for the session:\n\n`\n_10\nconst { error } = await supabase.auth.verifyOtp({ token_hash, type })\n`\nEmail one-time passwords (OTP) are a form of passwordless login where users key in a six digit code sent to their email address to log in to their accounts.\nEmail authentication methods, including Email OTPs, are enabled by default.\n\nEmail OTPs share an implementation with Magic Links. To send an OTP instead of a Magic Link, alter the **Magic Link** email template. For a hosted Supabase project, go to [Email Templates](/dashboard/project/_/auth/templates) in the Dashboard. For a self-hosted project or local development, see the [Email Templates guide](/docs/guides/auth/auth-email-templates).\n\nModify the template to include the <code>{{ .Token }}</code> variable, for example:\n\n`\n_10\n<h2>One time login code</h2>\n_10\n_10\n<p>Please enter this code: {{ .Token }}</p>\n`\n\nBy default, a user can only request an OTP once every 60 seconds and they expire after 1 hour. This is configurable via <code>Auth > Providers > Email > Email OTP Expiration</code>. An expiry duration of more than 86400 seconds (one day) is disallowed to guard against brute force attacks. The longer an OTP remains valid, the more time an attacker has to attempt brute force attacks. If the OTP is valid for several days, an attacker might have more opportunities to guess the correct OTP through repeated attempts.\n"
    }
  },
  {
    "chunk_id": "0a521a85-8558-490b-b65e-dc86facb5aa0",
    "metadata": {
      "token_count": 302,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-passwordless",
      "page_title": "Passwordless email logins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Passwordless email logins",
        "h2": "With OTP \\#",
        "h3": "# Step 1: Send the user an OTP code \\#"
      },
      "text": " to guard against brute force attacks. The longer an OTP remains valid, the more time an attacker has to attempt brute force attacks. If the OTP is valid for several days, an attacker might have more opportunities to guess the correct OTP through repeated attempts.\nGet the user's email and call the \"sign in with OTP\" method from your client library.\n\nIf the user hasn't signed up yet, they are automatically signed up by default. To prevent this, set the <code>shouldCreateUser</code> option to <code>false</code>.\n\nJavaScriptDartSwiftKotlinPython\n\n`\n_10\nconst { data, error } = await supabase.auth.signInWithOtp({\n_10\nemail: 'example@email.com',\n_10\noptions: {\n_10\n    // set this to false if you do not want the user to be automatically signed up\n_10\n    shouldCreateUser: false,\n_10\n},\n_10\n})\n`\n\nIf the request is successful, you receive a response with <code>error: null</code> and a <code>data</code> object where both <code>user</code> and <code>session</code> are null. Let the user know to check their email inbox.\n\n`\n_10\n{\n_10\n\"data\": {\n_10\n    \"user\": null,\n_10\n    \"session\": null\n_10\n},\n_10\n\"error\": null\n_10\n}\n`\n"
    }
  },
  {
    "chunk_id": "cd6dc701-ae5c-4a13-9575-dc75ee1ae982",
    "metadata": {
      "token_count": 496,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-passwordless",
      "page_title": "Passwordless email logins | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Passwordless email logins",
        "h2": "With OTP \\#",
        "h3": "# Step 2: Verify the OTP to create a session \\#"
      },
      "text": " their email inbox.\n\n`\n_10\n{\n_10\n\"data\": {\n_10\n    \"user\": null,\n_10\n    \"session\": null\n_10\n},\n_10\n\"error\": null\n_10\n}\n`\nProvide an input field for the user to enter their one-time code.\n\nCall the \"verify OTP\" method from your client library with the user's email address, the code, and a type of <code>email</code>:\n\nJavaScriptSwiftKotlinPython\n\n`\n_10\nconst {\n_10\ndata: { session },\n_10\nerror,\n_10\n} = await supabase.auth.verifyOtp({\n_10\nemail,\n_10\ntoken: '123456',\n_10\ntype: 'email',\n_10\n})\n`\n\nIf successful, the user is now logged in, and you receive a valid session that looks like:\n\n`\n_10\n{\n_10\n\"access_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNjI3MjkxNTc3LCJzdWIiOiJmYTA2NTQ1Zi1kYmI1LTQxY2EtYjk1NC1kOGUyOTg4YzcxOTEiLCJlbWFpbCI6IiIsInBob25lIjoiNjU4NzUyMjAyOSIsImFwcF9tZXRhZGF0YSI6eyJwcm92aWRlciI6InBob25lIn0sInVzZXJfbWV0YWRhdGEiOnt9LCJyb2xlIjoiYXV0aGVudGljYXRlZCJ9.1BqRi0NbS_yr1f6hnr4q3s1ylMR3c1vkiJ4e_N55dhM\",\n_10\n\"token_type\": \"bearer\",\n_10\n\"expires_in\": 3600,\n_10\n\"refresh_token\": \"LSp8LglPPvf0DxGMSj-vaQ\",\n_10\n\"user\": {...}\n_10\n}\n`\n"
    }
  },
  {
    "chunk_id": "fa0656e5-ad80-467a-a7fe-c5a55fc4669f",
    "metadata": {
      "token_count": 338,
      "source_url": "https://supabase.com/docs/guides/auth/signout",
      "page_title": "Signing out | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Signing out",
        "h2": "Signing out a user",
        "h3": ""
      },
      "text": "Auth\nSigning out a user works the same way no matter what method they used to sign in.\n\nCall the sign out method from the client library. It removes the active session and clears Auth data from the storage medium.\n\nJavaScriptDartSwiftKotlinPython\n\n`\n_10\nasync function signOut() {\n_10\nconst { error } = await supabase.auth.signOut()\n_10\n}\n`\nSupabase Auth allows you to specify three different scopes for when a user invokes the [sign out API](/docs/reference/javascript/auth-signout) in your application:\n\n- <code>global</code> (default) when all sessions active for the user are terminated.\n- <code>local</code> which only terminates the current session for the user but keep sessions on other devices or browsers active.\n- <code>others</code> to terminate all but the current session for the user.\n\nYou can invoke these by providing the <code>scope</code> option:\n\nJavaScriptDartKotlin\n\n`\n_10\n// defaults to the global scope\n_10\nawait supabase.auth.signOut()\n_10\n_10\n// sign out from the current session only\n_10\nawait supabase.auth.signOut({ scope: 'local' })\n`\n\nUpon sign out, all refresh tokens and potentially other database objects related to the affected sessions are destroyed and the client library removes the session stored in the local storage medium.\n\nAccess Tokens of revoked sessions remain valid until their expiry time, encoded in the <code>exp</code> claim. The user won't be immediately logged out and will only be logged out when the Access Token expires.\n"
    }
  },
  {
    "chunk_id": "2b9ed8e0-56dc-42a1-a2ab-f7a149f98eb8",
    "metadata": {
      "token_count": 259,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/advanced-guide",
      "page_title": "Advanced guide | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Advanced guide",
        "h2": "Details about SSR Auth flows and implementation for advanced users.",
        "h3": ""
      },
      "text": "Auth\nWhen a user authenticates with Supabase Auth, two pieces of information are issued by the server:\n\n1. **Access token** in the form of a JWT.\n2. **Refresh token** which is a randomly generated string.\n\nThe default behavior if you're not using SSR is to store this information in local storage. Local storage isn't accessible by the server, so for SSR, the tokens instead need to be stored in a secure cookie. The cookie can then be passed back and forth between your app code in the client and your app code in the server.\n\nIf you're not using SSR, you might also be using the [implicit flow](/docs/guides/auth/sessions/implicit-flow) to get the access and refresh tokens. The server can't access the tokens in this flow, so for SSR, you should change to the [PKCE flow](/docs/guides/auth/sessions/pkce-flow). You can change the flow type when initiating your Supabase client if your client library provides this option.\n\nIn the <code>@supabase/ssr</code> package, Supabase clients are initiated to use the PKCE flow by default. They are also automatically configured to handle the saving and retrieval of session information in cookies.\n"
    }
  },
  {
    "chunk_id": "a7e670f5-ad50-40c2-b83a-d0209b3d1b91",
    "metadata": {
      "token_count": 216,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/advanced-guide",
      "page_title": "Advanced guide | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Advanced guide",
        "h2": "How it works \\#",
        "h3": ""
      },
      "text": " this option.\n\nIn the <code>@supabase/ssr</code> package, Supabase clients are initiated to use the PKCE flow by default. They are also automatically configured to handle the saving and retrieval of session information in cookies.\nIn the PKCE flow, a redirect is made to your app, with an Auth Code contained in the URL. When you exchange this code using <code>exchangeCodeForSession</code>, you receive the session information, which contains the access and refresh tokens.\n\nTo maintain the session, these tokens must be stored in a storage medium securely shared between client and server, which is traditionally cookies. Whenever the session is refreshed, the auth and refresh tokens in the shared storage medium must be updated. Supabase client libraries provide a customizable <code>storage</code> option when a client is initiated, allowing you to change where tokens are stored.\n\nFor an implementation example, see the [@supabase/ssr](https://github.com/supabase/auth-helpers/blob/main/packages/ssr/src/index.ts) package.\n"
    }
  },
  {
    "chunk_id": "8e0acc62-99b1-4124-8725-531050b5a41a",
    "metadata": {
      "token_count": 184,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/advanced-guide",
      "page_title": "Advanced guide | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Advanced guide",
        "h2": "Frequently asked questions \\#",
        "h3": "No session on the server side with Next.js route prefetching? \\#"
      },
      "text": " a client is initiated, allowing you to change where tokens are stored.\n\nFor an implementation example, see the [@supabase/ssr](https://github.com/supabase/auth-helpers/blob/main/packages/ssr/src/index.ts) package.\nWhen you use route prefetching in Next.js using <code><Link href=\"/...\"></code> components or the <code>Router.push()</code> APIs can send server-side requests before the browser processes the access and refresh tokens. This means that those requests may not have any cookies set and your server code will render unauthenticated content.\n\nTo improve experience for your users, we recommend redirecting users to one specific page after sign-in that does not include any route prefetching from Next.js. Once the Supabase client library running in the browser has obtained the access and refresh tokens from the URL fragment, you can send users to any pages that use prefetching.\n"
    }
  },
  {
    "chunk_id": "c8510799-e503-466a-84f7-df1a8c423cc9",
    "metadata": {
      "token_count": 181,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/advanced-guide",
      "page_title": "Advanced guide | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Advanced guide",
        "h2": "Frequently asked questions \\#",
        "h3": "How do I make the cookies <code>HttpOnly</code>? \\#"
      },
      "text": " after sign-in that does not include any route prefetching from Next.js. Once the Supabase client library running in the browser has obtained the access and refresh tokens from the URL fragment, you can send users to any pages that use prefetching.\nThis is not necessary. Both the access token and refresh token are designed to be passed around to different components in your application. The browser-based side of your application needs access to the refresh token to properly maintain a browser session anyway.\nIt is likely that the refresh token sent from the browser to your server is stale. Make sure the <code>onAuthStateChange</code> listener callback is free of bugs and is registered relatively early in your application's lifetime\n\nWhen you receive this error on the server-side, try to defer rendering to the browser where the client library can access an up-to-date refresh token and present the user with a better experience.\n"
    }
  },
  {
    "chunk_id": "eb7ff62f-33cd-435f-b7f8-721c101e93cf",
    "metadata": {
      "token_count": 162,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/advanced-guide",
      "page_title": "Advanced guide | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Advanced guide",
        "h2": "Frequently asked questions \\#",
        "h3": "Should I set a shorter <code>Max-Age</code> parameter on the cookies? \\#"
      },
      "text": " bugs and is registered relatively early in your application's lifetime\n\nWhen you receive this error on the server-side, try to defer rendering to the browser where the client library can access an up-to-date refresh token and present the user with a better experience.\nThe <code>Max-Age</code> or <code>Expires</code> cookie parameters only control whether the browser sends the value to the server. Since a refresh token represents the long-lived authentication session of the user on that browser, setting a short <code>Max-Age</code> or <code>Expires</code> parameter on the cookies only results in a degraded user experience.\n\nThe only way to ensure that a user has logged out or their session has ended is to get the user's details with <code>getUser()</code>.\n"
    }
  },
  {
    "chunk_id": "ca117890-6896-4cb1-b204-e2b0c7a3f059",
    "metadata": {
      "token_count": 155,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/advanced-guide",
      "page_title": "Advanced guide | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Advanced guide",
        "h2": "Frequently asked questions \\#",
        "h3": "What should I use for the <code>SameSite</code> property? \\#"
      },
      "text": " <code>Expires</code> parameter on the cookies only results in a degraded user experience.\n\nThe only way to ensure that a user has logged out or their session has ended is to get the user's details with <code>getUser()</code>.\nMake sure you [understand the behavior of the property in different situations](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite) as some properties can degrade the user experience.\n\nA good default is to use <code>Lax</code> which sends cookies when users are navigating to your site. Cookies typically require the <code>Secure</code> attribute, which only sends them over HTTPS. However, this can be a problem when developing on <code>localhost</code>.\n"
    }
  },
  {
    "chunk_id": "6c865814-0a7d-44df-8f1b-9541f2bb7b69",
    "metadata": {
      "token_count": 218,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/advanced-guide",
      "page_title": "Advanced guide | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Advanced guide",
        "h2": "Frequently asked questions \\#",
        "h3": "Can I use server-side rendering with a CDN or cache? \\#"
      },
      "text": "code> which sends cookies when users are navigating to your site. Cookies typically require the <code>Secure</code> attribute, which only sends them over HTTPS. However, this can be a problem when developing on <code>localhost</code>.\nYes, but you need to be careful to include at least the refresh token cookie value in the cache key. Otherwise you may be accidentally serving pages with data belonging to different users!\n\nAlso be sure you set proper cache control headers. We recommend invalidating cache keys every hour or less.\nAt present, PKCE is supported on the Magic Link, OAuth, Sign Up, and Password Recovery routes. These correspond to the <code>signInWithOtp</code>, <code>signInWithOAuth</code>, <code>signUp</code>, and <code>resetPasswordForEmail</code> methods on the Supabase client library. When using PKCE with Phone and Email OTPs, there is no behavior change with respect to the implicit flow - an access token will be returned in the body when a request is successful.\n"
    }
  },
  {
    "chunk_id": "099e6838-2d01-4810-9900-67ac40a55696",
    "metadata": {
      "token_count": 167,
      "source_url": "https://supabase.com/docs/guides/auth/passwords",
      "page_title": "Password-based Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password-based Auth",
        "h2": "Allow users to sign in with a password connected to their email or phone number.",
        "h3": "Enabling email and password-based authentication \\#"
      },
      "text": "Auth\nUsers often expect to sign in to your site with a password. Supabase Auth helps you implement password-based auth safely, using secure configuration options and best practices for storing and verifying passwords.\n\nUsers can associate a password with their identity using their [email address](#with-email) or a [phone number](#with-phone).\nEmail authentication is enabled by default.\n\nYou can configure whether users need to verify their email to sign in. On hosted Supabase projects, this is true by default. On self-hosted projects or in local development, this is false by default.\n\nChange this setting on the [Auth Providers page](/dashboard/project/_/auth/providers) for hosted projects, or in the [configuration file](/docs/guides/cli/config#auth.email.enable_confirmations) for self-hosted projects.\n"
    }
  },
  {
    "chunk_id": "f97eae0f-c9af-4d5b-b4f5-817e947c2f61",
    "metadata": {
      "token_count": 438,
      "source_url": "https://supabase.com/docs/guides/auth/passwords",
      "page_title": "Password-based Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password-based Auth",
        "h2": "With email \\#",
        "h3": "Signing up with an email and password \\#"
      },
      "text": ".\n\nChange this setting on the [Auth Providers page](/dashboard/project/_/auth/providers) for hosted projects, or in the [configuration file](/docs/guides/cli/config#auth.email.enable_confirmations) for self-hosted projects.\nThere are two possible flows for email signup: [implicit flow](/docs/guides/auth/sessions#implicit-flow) and [PKCE flow](/docs/guides/auth/sessions#pkce-flow). If you're using SSR, you're using the PKCE flow. If you're using client-only code, the default flow depends upon the client library. The implicit flow is the default in JavaScript and Dart, and the PKCE flow is the default in Swift.\n\nThe instructions in this section assume that email confirmations are enabled.\n\nImplicit flowPKCE flow\n\nThe implicit flow only works for client-only apps. Your site directly receives the access token after the user confirms their email.\n\nJavaScriptDartSwiftKotlinPython\n\nTo sign up the user, call [signUp()](/docs/reference/javascript/auth-signup) with their email address and password.\n\nYou can optionally specify a URL to redirect to after the user clicks the confirmation link. This URL must be configured as a [Redirect URL](/docs/guides/auth/redirect-urls), which you can do in the [dashboard](/dashboard/project/_/auth/url-configuration) for hosted projects, or in the [configuration file](/docs/guides/cli/config#auth.additional_redirect_urls) for self-hosted projects.\n\nIf you don't specify a redirect URL, the user is automatically redirected to your site URL. This defaults to <code>localhost:3000</code>, but you can also configure this.\n\n`\n_10\nasync function signUpNewUser() {\n_10\nconst { data, error } = await supabase.auth.signUp({\n_10\n    email: 'example@email.com',\n_10\n    password: 'example-password',\n_10\n    options: {\n_10\n      emailRedirectTo: 'https://example.com/welcome',\n_10\n    },\n_10\n})\n_10\n}\n`\n"
    }
  },
  {
    "chunk_id": "9b7dbd77-22b5-4ec3-af65-8068fc8e80e2",
    "metadata": {
      "token_count": 153,
      "source_url": "https://supabase.com/docs/guides/auth/passwords",
      "page_title": "Password-based Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password-based Auth",
        "h2": "With email \\#",
        "h3": "Signing in with an email and password \\#"
      },
      "text": "example@email.com',\n_10\n    password: 'example-password',\n_10\n    options: {\n_10\n      emailRedirectTo: 'https://example.com/welcome',\n_10\n    },\n_10\n})\n_10\n}\n`\nJavaScriptDartSwiftKotlinPython\n\nWhen your user signs in, call [signInWithPassword()](/docs/reference/javascript/auth-signinwithpassword) with their email address and password:\n\n`\n_10\nasync function signInWithEmail() {\n_10\nconst { data, error } = await supabase.auth.signInWithPassword({\n_10\n    email: 'example@email.com',\n_10\n    password: 'example-password',\n_10\n})\n_10\n}\n`\nImplicit flowPKCE flow\n"
    }
  },
  {
    "chunk_id": "4567cd0d-5634-482a-9e57-a9bc4d2aa6c2",
    "metadata": {
      "token_count": 164,
      "source_url": "https://supabase.com/docs/guides/auth/passwords",
      "page_title": "Password-based Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password-based Auth",
        "h2": "With email \\#",
        "h3": "# Step 1: Create a reset password page \\#"
      },
      "text": " data, error } = await supabase.auth.signInWithPassword({\n_10\n    email: 'example@email.com',\n_10\n    password: 'example-password',\n_10\n})\n_10\n}\n`\nImplicit flowPKCE flow\nCreate a **reset password** page. This page should be publicly accessible.\n\nCollect the user's email address and request a password reset email. Specify the redirect URL, which should point to the URL of a **change password** page. This URL needs to be configured in your [redirect URLs](/docs/guides/auth/redirect-urls).\n\nJavaScriptSwiftKotlinPython\n\n`\n_10\nawait supabase.auth.resetPasswordForEmail('hello@example.com', {\n_10\nredirectTo: 'http://example.com/account/update-password',\n_10\n})\n`\n"
    }
  },
  {
    "chunk_id": "a38dd4aa-3467-4d88-9dda-50c468ae7113",
    "metadata": {
      "token_count": 221,
      "source_url": "https://supabase.com/docs/guides/auth/passwords",
      "page_title": "Password-based Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password-based Auth",
        "h2": "With email \\#",
        "h3": "# Step 2: Create a change password page \\#"
      },
      "text": "/auth/redirect-urls).\n\nJavaScriptSwiftKotlinPython\n\n`\n_10\nawait supabase.auth.resetPasswordForEmail('hello@example.com', {\n_10\nredirectTo: 'http://example.com/account/update-password',\n_10\n})\n`\nCreate a **change password** page at the URL you specified in the previous step. This page should be accessible only to authenticated users.\n\nCollect the user's new password and call <code>updateUser</code> to update their password.\n\nJavaScriptSwiftKotlinPython\n\n`\n_10\nawait supabase.auth.updateUser({ password: new_password })\n`\nThe signup confirmation and password reset flows require an SMTP server to send emails.\n\nThe Supabase platform comes with a default email-sending service for you to try out. The service has a rate limit of 2 emails per hour, and availability is on a best-effort basis. For production use, you should consider configuring a custom SMTP server.\n\nConsider configuring a custom SMTP server for production.\n\nSee the [Custom SMTP guide](/docs/guides/auth/auth-smtp) for instructions.\n"
    }
  },
  {
    "chunk_id": "58cf1975-ddbe-446b-b42b-c3f9c1b6b6f0",
    "metadata": {
      "token_count": 217,
      "source_url": "https://supabase.com/docs/guides/auth/passwords",
      "page_title": "Password-based Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password-based Auth",
        "h2": "With email \\#",
        "h3": "# Local development with Inbucket \\#"
      },
      "text": " is on a best-effort basis. For production use, you should consider configuring a custom SMTP server.\n\nConsider configuring a custom SMTP server for production.\n\nSee the [Custom SMTP guide](/docs/guides/auth/auth-smtp) for instructions.\nYou can test email flows on your local machine. The Supabase CLI automatically captures emails sent locally by using [Inbucket](https://github.com/inbucket/inbucket).\n\nIn your terminal, run <code>supabase status</code> to get the Inbucket URL. Go to this URL in your browser, and follow the instructions to find your emails.\nYou can use a user's mobile phone number as an identifier, instead of an email address, when they sign up with a password.\n\nThis practice is usually discouraged because phone networks recycle mobile phone numbers. Anyone receiving a recycled phone number gets access to the original user's account. To mitigate this risk, [implement MFA](/docs/guides/auth/auth-mfa).\n\nProtect users who use a phone number as a password-based auth identifier by enabling MFA.\n"
    }
  },
  {
    "chunk_id": "f4da1494-1747-4aff-9130-65ab0c8e54a7",
    "metadata": {
      "token_count": 165,
      "source_url": "https://supabase.com/docs/guides/auth/passwords",
      "page_title": "Password-based Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password-based Auth",
        "h2": "With phone \\#",
        "h3": "Enabling phone and password-based authentication \\#"
      },
      "text": " recycled phone number gets access to the original user's account. To mitigate this risk, [implement MFA](/docs/guides/auth/auth-mfa).\n\nProtect users who use a phone number as a password-based auth identifier by enabling MFA.\nEnable phone authentication on the [Auth Providers page](/dashboard/project/_/auth/providers) for hosted Supabase projects.\n\nFor self-hosted projects or local development, use the [configuration file](/docs/guides/cli/config#auth.sms.enable_signup). See the configuration variables namespaced under <code>auth.sms</code>.\n\nIf you want users to confirm their phone number on signup, you need to set up an SMS provider. Each provider has its own configuration. Supported providers include MessageBird, Twilio, Vonage, and TextLocal (community-supported).\n"
    }
  },
  {
    "chunk_id": "0328c9c8-a643-4e0c-9bf7-cb5407bae40b",
    "metadata": {
      "token_count": 424,
      "source_url": "https://supabase.com/docs/guides/auth/passwords",
      "page_title": "Password-based Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password-based Auth",
        "h2": "With phone \\#",
        "h3": "Configuring SMS Providers"
      },
      "text": "</code>.\n\nIf you want users to confirm their phone number on signup, you need to set up an SMS provider. Each provider has its own configuration. Supported providers include MessageBird, Twilio, Vonage, and TextLocal (community-supported).\n![MessageBird Icon](https://supabase.com/docs/img/icons/messagebird-icon.svg)\n![Twilio Icon](https://supabase.com/docs/img/icons/twilio-icon.svg)\n![Vonage Icon](https://supabase.com/docs/img/icons/vonage-icon-light.svg)\n![Textlocal (Community Supported) Icon](https://supabase.com/docs/guides/auth/Community%20Supported)\nTo sign up the user, call [<code>signUp()</code>](/docs/reference/javascript/auth-signup) with their phone number and password:\n\nJavaScriptSwiftKotlinPythonHTTP\n\n`\n_10\nconst { data, error } = await supabase.auth.signUp({\n_10\nphone: '+13334445555',\n_10\npassword: 'some-password',\n_10\n})\n`\n\nIf you have phone verification turned on, the user receives an SMS with a 6-digit pin that you must verify within 60 seconds:\n\nJavaScriptSwiftKotlinPythonHTTP\n\nYou should present a form to the user so they can input the 6 digit pin, then send it along with the phone number to <code>verifyOtp</code>:\n\n`\n_10\nconst {\n_10\ndata: { session },\n_10\nerror,\n_10\n} = await supabase.auth.verifyOtp({\n_10\nphone: '+13334445555',\n_10\ntoken: '123456',\n_10\ntype: 'sms',\n_10\n})\n`\nCall the function to sign in with the user's phone number and password:\n\nJavaScriptSwiftKotlinPythonHTTP\n\n`\n_10\nconst { user, error } = await supabase.auth.signInWithPassword({\n_10\nphone: '+13334445555',\n_10\npassword: 'some-password',\n_10\n})\n`\n"
    }
  },
  {
    "chunk_id": "6c49afd5-c607-42a9-8b88-0e05e34f5f71",
    "metadata": {
      "token_count": 90,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/nextjs-pages",
      "page_title": "Supabase Auth with Next.js Pages Directory | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Supabase Auth with Next.js Pages Directory",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nThe <code>auth-helpers</code> package has been replaced with the <code>@supabase/ssr</code> package. We recommend setting up Auth for your Next.js app with <code>@supabase/ssr</code> instead. See the [Next.js Server-Side Auth guide](/docs/guides/auth/server-side/nextjs?router=pages) to learn how.\n\nSee legacy docs\n"
    }
  },
  {
    "chunk_id": "ea12edf7-4fc7-4ccf-857f-1626d8ba0d6c",
    "metadata": {
      "token_count": 216,
      "source_url": "https://supabase.com/docs/guides/auth/redirect-urls",
      "page_title": "Redirect URLs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Redirect URLs",
        "h2": "Overview \\#",
        "h3": ""
      },
      "text": "Auth\nWhen using [passwordless sign-ins](/docs/reference/javascript/auth-signinwithotp) or [third-party providers](/docs/reference/javascript/auth-signinwithoauth#sign-in-using-a-third-party-provider-with-redirect), the Supabase client library methods provide a <code>redirectTo</code> parameter to specify where to redirect the user to after authentication. By default, the user will be redirected to the [<code>SITE_URL</code>](/docs/guides/auth/redirect-urls) but you can modify the <code>SITE_URL</code> or add additional redirect URLs to the allow list. Once you've added necessary URLs to the allow list, you can specify the URL you want the user to be redirected to in the <code>redirectTo</code> parameter.\n\nTo edit the allow list, go to the [URL Configuration](/dashboard/project/_/auth/url-configuration) page. In local development or self-hosted projects, use the [configuration file](/docs/guides/cli/config#auth.additional_redirect_urls).\n"
    }
  },
  {
    "chunk_id": "ea47fff4-00b4-4635-a1d3-13e61f54ad38",
    "metadata": {
      "token_count": 498,
      "source_url": "https://supabase.com/docs/guides/auth/redirect-urls",
      "page_title": "Redirect URLs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Redirect URLs",
        "h2": "Use wildcards in redirect URLs \\#",
        "h3": ""
      },
      "text": " allow list, go to the [URL Configuration](/dashboard/project/_/auth/url-configuration) page. In local development or self-hosted projects, use the [configuration file](/docs/guides/cli/config#auth.additional_redirect_urls).\nSupabase allows you to specify wildcards when adding redirect URLs to the [allow list](https://supabase.com/dashboard/project/_/auth/url-configuration). You can use wildcard match patterns to support preview URLs from providers like Netlify and Vercel.\n\n| Wildcard | Description |\n| --- | --- |\n| <code>*</code> | matches any sequence of non-separator characters |\n| <code>**</code> | matches any sequence of characters |\n| <code>?</code> | matches any single non-separator character |\n| <code>c</code> | matches character c (c != <code>*</code>, <code>**</code>, <code>?</code>, <code>\\</code>, <code>[</code>, <code>{</code>, <code>}</code>) |\\\n| <code>\\c</code> | matches character c |\\\n| <code>[!{ character-range }]</code> | matches any sequence of characters not in the <code>{ character-range }</code>. For example, <code>[!a-z]</code> will not match any characters ranging from a-z. |\\\n\\\nThe separator characters in a URL are defined as <code>.</code> and <code>/</code>. Use [this tool](https://www.digitalocean.com/community/tools/glob?comments=true&glob=http%3A%2F%2Flocalhost%3A3000%2F%2A%2A&matches=false&tests=http%3A%2F%2Flocalhost%3A3000&tests=http%3A%2F%2Flocalhost%3A3000%2F&tests=http%3A%2F%2Flocalhost%3A3000%2F%3Ftest%3Dtest&tests=http%3A%2F%2Flocalhost%3A3000%2Ftest-test%3Ftest%3Dtest&tests=http%3A%2F%2Flocalhost%3A3000%2Ftest%2Ftest%3Ftest%3Dtest) to test your patterns.\\\n\\\n"
    }
  },
  {
    "chunk_id": "680469b6-8d09-4389-b9c3-1e4b15a82efb",
    "metadata": {
      "token_count": 342,
      "source_url": "https://supabase.com/docs/guides/auth/redirect-urls",
      "page_title": "Redirect URLs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Redirect URLs",
        "h2": "Use wildcards in redirect URLs \\#",
        "h3": "## Recommendation\\"
      },
      "text": "%3Ftest%3Dtest&tests=http%3A%2F%2Flocalhost%3A3000%2Ftest%2Ftest%3Ftest%3Dtest) to test your patterns.\\\n\\\n\\\nWhile the \"globstar\" ( <code>**</code>) is useful for local development and preview URLs, we recommend setting the exact redirect URL path for your site URL in production.\\\n\\\n\\\n| Redirect URL | Description |\\\n| --- | --- |\\\n| <code>http://localhost:3000/*</code> | matches <code>http://localhost:3000/foo</code>, <code>http://localhost:3000/bar</code> but not <code>http://localhost:3000/foo/bar</code> or <code>http://localhost:3000/foo/</code> (note the trailing slash) |\\\n| <code>http://localhost:3000/**</code> | matches <code>http://localhost:3000/foo</code>, <code>http://localhost:3000/bar</code> and <code>http://localhost:3000/foo/bar</code> |\\\n| <code>http://localhost:3000/?</code> | matches <code>http://localhost:3000/a</code> but not <code>http://localhost:3000/foo</code> |\\\n| <code>http://localhost:3000/[!a-z]</code> | matches <code>http://localhost:3000/1</code> but not <code>http://localhost:3000/a</code> |\\\n\\\n"
    }
  },
  {
    "chunk_id": "4e66b3f8-f9fb-41ad-b014-a28f4c197c99",
    "metadata": {
      "token_count": 528,
      "source_url": "https://supabase.com/docs/guides/auth/redirect-urls",
      "page_title": "Redirect URLs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Redirect URLs",
        "h2": "Netlify preview URLs \\#\\",
        "h3": ""
      },
      "text": " <code>http://localhost:3000/[!a-z]</code> | matches <code>http://localhost:3000/1</code> but not <code>http://localhost:3000/a</code> |\\\n\\\n\\\nFor deployments with Netlify, set the <code>SITE_URL</code> to your official site URL. Add the following additional redirect URLs for local development and deployment previews:\\\n\\\n- <code>http://localhost:3000/**</code>\\\n- <code>https://**--my_org.netlify.app/**</code>\\\n\\\n\\\nFor deployments with Vercel, set the <code>SITE_URL</code> to your official site URL. Add the following additional redirect URLs for local development and deployment previews:\\\n\\\n- <code>http://localhost:3000/**</code>\\\n- <code>https://*-username.vercel.app/**</code>\\\n\\\nVercel provides an environment variable for the URL of the deployment called <code>NEXT_PUBLIC_VERCEL_URL</code>. See the [Vercel docs](https://vercel.com/docs/concepts/projects/environment-variables#system-environment-variables) for more details. You can use this variable to dynamically redirect depending on the environment. You should also set the value of the environment variable called NEXT\\_PUBLIC\\_SITE\\_URL, this should be set to your site URL in production environment to ensure that redirects function correctly.\\\n\\\n``\\\n_18\\\nconst getURL = () => {\\\n_18\\\nlet url =\\\n_18\\\n    process?.env?.NEXT_PUBLIC_SITE_URL ?? // Set this to your site URL in production env.\\\n_18\\\n    process?.env?.NEXT_PUBLIC_VERCEL_URL ?? // Automatically set by Vercel.\\\n_18\\\n    'http://localhost:3000/'\\\n_18\\\n// Make sure to include <code>https://</code> when not localhost.\\\n_18\\\nurl = url.startsWith('http') ? url : <code>https://${url}</code>\\\n_18\\\n// Make sure to include a trailing <code>/</code>.\\\n_18\\\nurl = url.endsWith('/') ? url : <code>${url}/</code>\\\n_18\\\nreturn url\\\n_18\\\n}\\\n_18\\\n_18\\\nconst { data, error } = await supabase.auth.signInWithOAuth({\\\n_18\\\nprovider: 'github',\\\n_18\\\noptions: {\\\n_18\\\n    redirectTo: getURL(),\\\n_18\\\n},\\\n_18\\\n})\\\n``\\\n\\\n"
    }
  },
  {
    "chunk_id": "f39ee76f-6916-4953-8ed1-cc9f675d5a7b",
    "metadata": {
      "token_count": 220,
      "source_url": "https://supabase.com/docs/guides/auth/redirect-urls",
      "page_title": "Redirect URLs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Redirect URLs",
        "h2": "Email templates when using <code>redirectTo</code> \\#\\",
        "h3": ""
      },
      "text": " } = await supabase.auth.signInWithOAuth({\\\n_18\\\nprovider: 'github',\\\n_18\\\noptions: {\\\n_18\\\n    redirectTo: getURL(),\\\n_18\\\n},\\\n_18\\\n})\\\n``\\\n\\\n\\\nWhen using a <code>redirectTo</code> option, you may need to replace the <code>{{ .SiteURL }}</code> with <code>{{ .RedirectTo }}</code> in your email templates. See the [Email Templates guide](/docs/guides/auth/auth-email-templates) for more information.\\\n\\\nFor example, change the following:\\\n\\\n`\\\n_10\\\n<!-- Old -->\\\n_10\\\n<a href=\"{{ .SiteURL }}/auth/confirm?token_hash={{ .TokenHash }}&type=signup\">Confirm your mail</a>\\\n_10\\\n_10\\\n<!-- New -->\\\n_10\\\n<a href=\"{{ .RedirectTo }}/auth/confirm?token_hash={{ .TokenHash }}&type=signup\"\\\n_10\\\n>Confirm your mail</a\\\n_10\\\n>\\\n`\\\n\\\n"
    }
  },
  {
    "chunk_id": "20534fdb-f2d8-4028-af2c-1bdb41c48cfe",
    "metadata": {
      "token_count": 154,
      "source_url": "https://supabase.com/docs/guides/auth/redirect-urls",
      "page_title": "Redirect URLs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Redirect URLs",
        "h2": "Mobile deep linking URIs \\#\\",
        "h3": ""
      },
      "text": "_10\\\n<!-- New -->\\\n_10\\\n<a href=\"{{ .RedirectTo }}/auth/confirm?token_hash={{ .TokenHash }}&type=signup\"\\\n_10\\\n>Confirm your mail</a\\\n_10\\\n>\\\n`\\\n\\\n\\\nFor mobile applications you can use deep linking URIs. For example, for your <code>SITE_URL</code> you can specify something like <code>com.supabase://login-callback/</code> and for additional redirect URLs something like <code>com.supabase.staging://login-callback/</code> if needed.\\\n\\\nRead more about deep linking and find code examples for different frameworks [here](/docs/guides/auth/native-mobile-deep-linking).\\\n\\\n"
    }
  },
  {
    "chunk_id": "a771ea55-b802-40cd-bb96-c179a4157c3a",
    "metadata": {
      "token_count": 173,
      "source_url": "https://supabase.com/docs/guides/auth/redirect-urls",
      "page_title": "Redirect URLs | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Redirect URLs",
        "h2": "Error Handling \\#\\",
        "h3": ""
      },
      "text": ">com.supabase.staging://login-callback/</code> if needed.\\\n\\\nRead more about deep linking and find code examples for different frameworks [here](/docs/guides/auth/native-mobile-deep-linking).\\\n\\\n\\\nWhen authentication fails, the user will still be redirected to the redirect URL provided. However, the error details will be returned as query fragments in the URL. You can parse these query fragments and show a custom error message to the user. For example:\\\n\\\n`\\\n_10\\\nconst params = new URLSearchParams(window.location.hash.slice())\\\n_10\\\n_10\\\nif (params.get('error_code').startsWith('4')) {\\\n_10\\\n// show error message if error is a 4xx error\\\n_10\\\nwindow.alert(params.get('error_description'))\\\n_10\\\n}\\\n`\n"
    }
  },
  {
    "chunk_id": "9aaa060a-2642-447c-8991-a0209618b870",
    "metadata": {
      "token_count": 242,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/totp",
      "page_title": "Multi-Factor Authentication (TOTP) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (TOTP)",
        "h2": "How does app authenticator multi-factor authentication work? \\#",
        "h3": ""
      },
      "text": "Auth\nApp Authenticator (TOTP) multi-factor authentication involves a timed one-time password generated from an authenticator app in the control of users. It uses a QR Code which to transmit a shared secret used to generate a One Time Password. A user can scan a QR code with their phone to capture a shared secret required for subsequent authentication.\n\nThe use of a QR code was [initially introduced by Google Authenticator](https://github.com/google/google-authenticator/wiki/Key-Uri-Format) but is now universally accepted by all authenticator apps. The QR code has an alternate representation in URI form following the <code>otpauth</code> scheme such as: <code>otpauth://totp/supabase:alice@supabase.com?secret=<secret>&issuer=supabase</code> which a user can manually input in cases where there is difficulty rendering a QR Code.\n\nBelow is a flow chart illustrating how the Enrollment, Challenge, and Verify APIs work in the context of MFA (TOTP).\n\n[TOTP MFA API](/docs/reference/javascript/auth-mfa-api) is free to use and is enabled on all Supabase projects by default.\n"
    }
  },
  {
    "chunk_id": "d4deb056-75b4-4dd6-ae03-b73305554894",
    "metadata": {
      "token_count": 389,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/totp",
      "page_title": "Multi-Factor Authentication (TOTP) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (TOTP)",
        "h2": "How does app authenticator multi-factor authentication work? \\#",
        "h3": "Add enrollment flow \\#"
      },
      "text": " the Enrollment, Challenge, and Verify APIs work in the context of MFA (TOTP).\n\n[TOTP MFA API](/docs/reference/javascript/auth-mfa-api) is free to use and is enabled on all Supabase projects by default.\nAn enrollment flow provides a UI for users to set up additional authentication factors. Most applications add the enrollment flow in two places within their app:\n\n1. Right after login or sign up.\nThis lets users quickly set up MFA immediately after they log in or create an\naccount. We recommend encouraging all users to set up MFA if that makes sense\nfor your application. Many applications offer this as an opt-in step in an\neffort to reduce onboarding friction.\n2. From within a settings page.\nAllows users to set up, disable or modify their MFA settings.\n\nEnrolling a factor for use with MFA takes three steps:\n\n1. Call <code>supabase.auth.mfa.enroll()</code>.\nThis method returns a QR code and a secret. Display the QR\ncode to the user and ask them to scan it with their authenticator application.\nIf they are unable to scan the QR code, show the secret in plain text which\nthey can type or paste into their authenticator app.\n2. Calling the <code>supabase.auth.mfa.challenge()</code> API.\nThis prepares Supabase Auth to accept a verification code from the user\nand returns a challenge ID. In the case of Phone MFA this step also sends the verification code to the user.\n3. Calling the <code>supabase.auth.mfa.verify()</code> API.\nThis verifies that the user has indeed added the secret from step (1) into\ntheir app and is working correctly. If the verification succeeds, the factor\nimmediately becomes active for the user account. If not, you should repeat\nsteps 2 and 3.\n"
    }
  },
  {
    "chunk_id": "18fa99f4-fb93-4fc0-bd47-8b775e7bf982",
    "metadata": {
      "token_count": 847,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/totp",
      "page_title": "Multi-Factor Authentication (TOTP) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (TOTP)",
        "h2": "How does app authenticator multi-factor authentication work? \\#",
        "h3": "# Example: React \\#"
      },
      "text": " has indeed added the secret from step (1) into\ntheir app and is working correctly. If the verification succeeds, the factor\nimmediately becomes active for the user account. If not, you should repeat\nsteps 2 and 3.\nBelow is an example that creates a new <code>EnrollMFA</code> component that illustrates the important pieces of the MFA enrollment flow.\n\n- When the component appears on screen, the <code>supabase.auth.mfa.enroll()</code> API is\ncalled once to start the process of enrolling a new factor for the current\nuser.\n- This API returns a QR code in the SVG format, which is shown on screen using\na normal <code><img></code> tag by encoding the SVG as a data URL.\n- Once the user has scanned the QR code with their authenticator app, they\nshould enter the verification code within the <code>verifyCode</code> input field and\nclick on <code>Enable</code>.\n- A challenge is created using the <code>supabase.auth.mfa.challenge()</code> API and the\ncode from the user is submitted for verification using the\n<code>supabase.auth.mfa.verify()</code> challenge.\n- <code>onEnabled</code> is a callback that notifies the other components that enrollment\nhas completed.\n- <code>onCancelled</code> is a callback that notifies the other components that the user\nhas clicked the <code>Cancel</code> button.\n\n``\n_76\n/**\n_76\n* EnrollMFA shows a simple enrollment dialog. When shown on screen it calls\n_76\n* the <code>enroll</code> API. Each time a user clicks the Enable button it calls the\n_76\n* <code>challenge</code> and <code>verify</code> APIs to check if the code provided by the user is\n_76\n* valid.\n_76\n* When enrollment is successful, it calls <code>onEnrolled</code>. When the user clicks\n_76\n* Cancel the <code>onCancelled</code> callback is called.\n_76\n*/\n_76\nexport function EnrollMFA({\n_76\nonEnrolled,\n_76\nonCancelled,\n_76\n}: {\n_76\nonEnrolled: () => void\n_76\nonCancelled: () => void\n_76\n}) {\n_76\nconst [factorId, setFactorId] = useState('')\n_76\nconst [qr, setQR] = useState('') // holds the QR code image SVG\n_76\nconst [verifyCode, setVerifyCode] = useState('') // contains the code entered by the user\n_76\nconst [error, setError] = useState('') // holds an error message\n_76\n_76\nconst onEnableClicked = () => {\n_76\n    setError('')\n_76\n    ;(async () => {\n_76\n      const challenge = await supabase.auth.mfa.challenge({ factorId })\n_76\n      if (challenge.error) {\n_76\n        setError(challenge.error.message)\n_76\n        throw challenge.error\n_76\n      }\n_76\n_76\n      const challengeId = challenge.data.id\n_76\n_76\n      const verify = await supabase.auth.mfa.verify({\n_76\n        factorId,\n_76\n        challengeId,\n_76\n        code: verifyCode,\n_76\n      })\n_76\n      if (verify.error) {\n_76\n        setError(verify.error.message)\n_76\n        throw verify.error\n_76\n      }\n_76\n_76\n      onEnrolled()\n_76\n    })()\n_76\n}\n_76\n_76\nuseEffect(() => {\n_76\n    ;(async () => {\n_76\n      const { data, error } = await supabase.auth.mfa.enroll({\n_76\n        factorType: 'totp',\n_76\n      })\n_76\n"
    }
  },
  {
    "chunk_id": "3fea0d61-a613-477c-9419-ae32b254db30",
    "metadata": {
      "token_count": 290,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/totp",
      "page_title": "Multi-Factor Authentication (TOTP) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (TOTP)",
        "h2": "How does app authenticator multi-factor authentication work? \\#",
        "h3": "# Example: React \\#"
      },
      "text": "_76\n    ;(async () => {\n_76\n      const { data, error } = await supabase.auth.mfa.enroll({\n_76\n        factorType: 'totp',\n_76\n      })\n_76\n      if (error) {\n_76\n        throw error\n_76\n      }\n_76\n_76\n      setFactorId(data.id)\n_76\n_76\n      // Supabase Auth returns an SVG QR code which you can convert into a data\n_76\n      // URL that you can place in an <img> tag.\n_76\n      setQR(data.totp.qr_code)\n_76\n    })()\n_76\n}, [])\n_76\n_76\nreturn (\n_76\n    <>\n_76\n      {error && <div className=\"error\">{error}</div>}\n_76\n      <img src={qr} />\n_76\n      <input\n_76\n        type=\"text\"\n_76\n        value={verifyCode}\n_76\n        onChange={(e) => setVerifyCode(e.target.value.trim())}\n_76\n      />\n_76\n      <input type=\"button\" value=\"Enable\" onClick={onEnableClicked} />\n_76\n      <input type=\"button\" value=\"Cancel\" onClick={onCancelled} />\n_76\n    </>\n_76\n)\n_76\n}\n``\n"
    }
  },
  {
    "chunk_id": "3b77f85d-b8e5-4999-9b76-5e394d3b02ea",
    "metadata": {
      "token_count": 358,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/totp",
      "page_title": "Multi-Factor Authentication (TOTP) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (TOTP)",
        "h2": "How does app authenticator multi-factor authentication work? \\#",
        "h3": "Add a challenge step to login \\#"
      },
      "text": "input type=\"button\" value=\"Enable\" onClick={onEnableClicked} />\n_76\n      <input type=\"button\" value=\"Cancel\" onClick={onCancelled} />\n_76\n    </>\n_76\n)\n_76\n}\n``\nOnce a user has logged in via their first factor (email+password, magic link, one time password, social login etc.) you need to perform a check if any additional factors need to be verified.\n\nThis can be done by using the <code>supabase.auth.mfa.getAuthenticatorAssuranceLevel()</code> API. When the user signs in and is redirected back to your app, you should call this method to extract the user's current and next authenticator assurance level (AAL).\n\nTherefore if you receive a <code>currentLevel</code> which is <code>aal1</code> but a <code>nextLevel</code> of <code>aal2</code>, the user should be given the option to go through MFA.\n\nBelow is a table that explains the combined meaning.\n\n| Current Level | Next Level | Meaning |\n| --: | :-- | :-- |\n| <code>aal1</code> | <code>aal1</code> | User does not have MFA enrolled. |\n| <code>aal1</code> | <code>aal2</code> | User has an MFA factor enrolled but has not verified it. |\n| <code>aal2</code> | <code>aal2</code> | User has verified their MFA factor. |\n| <code>aal2</code> | <code>aal1</code> | User has disabled their MFA factor. (Stale JWT.) |\n"
    }
  },
  {
    "chunk_id": "81f48f65-8b39-4518-85e1-1f6b90787a98",
    "metadata": {
      "token_count": 848,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/totp",
      "page_title": "Multi-Factor Authentication (TOTP) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (TOTP)",
        "h2": "How does app authenticator multi-factor authentication work? \\#",
        "h3": "# Example: React \\#"
      },
      "text": "code>aal2</code> | User has verified their MFA factor. |\n| <code>aal2</code> | <code>aal1</code> | User has disabled their MFA factor. (Stale JWT.) |\nAdding the challenge step to login depends heavily on the architecture of your app. However, a fairly common way to structure React apps is to have a large component (often named <code>App</code>) which contains most of the authenticated application logic.\n\nThis example will wrap this component with logic that will show an MFA challenge screen if necessary, before showing the full application. This is illustrated in the <code>AppWithMFA</code> example below.\n\n`\n_33\nfunction AppWithMFA() {\n_33\nconst [readyToShow, setReadyToShow] = useState(false)\n_33\nconst [showMFAScreen, setShowMFAScreen] = useState(false)\n_33\n_33\nuseEffect(() => {\n_33\n    ;(async () => {\n_33\n      try {\n_33\n        const { data, error } = await supabase.auth.mfa.getAuthenticatorAssuranceLevel()\n_33\n        if (error) {\n_33\n          throw error\n_33\n        }\n_33\n_33\n        console.log(data)\n_33\n_33\n        if (data.nextLevel === 'aal2' && data.nextLevel !== data.currentLevel) {\n_33\n          setShowMFAScreen(true)\n_33\n        }\n_33\n      } finally {\n_33\n        setReadyToShow(true)\n_33\n      }\n_33\n    })()\n_33\n}, [])\n_33\n_33\nif (readyToShow) {\n_33\n    if (showMFAScreen) {\n_33\n      return <AuthMFA />\n_33\n    }\n_33\n_33\n    return <App />\n_33\n}\n_33\n_33\nreturn <></>\n_33\n}\n`\n\n- <code>supabase.auth.mfa.getAuthenticatorAssuranceLevel()</code> does return a promise.\nDon't worry, this is a very fast method (microseconds) as it rarely uses the\nnetwork.\n- <code>readyToShow</code> only makes sure the AAL check completes before showing any\napplication UI to the user.\n- If the current level can be upgraded to the next one, the MFA screen is\nshown.\n- Once the challenge is successful, the <code>App</code> component is finally rendered on\nscreen.\n\nBelow is the component that implements the challenge and verify logic.\n\n`\n_53\nfunction AuthMFA() {\n_53\nconst [verifyCode, setVerifyCode] = useState('')\n_53\nconst [error, setError] = useState('')\n_53\n_53\nconst onSubmitClicked = () => {\n_53\n    setError('')\n_53\n    ;(async () => {\n_53\n      const factors = await supabase.auth.mfa.listFactors()\n_53\n      if (factors.error) {\n_53\n        throw factors.error\n_53\n      }\n_53\n_53\n      const totpFactor = factors.data.totp[0]\n_53\n_53\n      if (!totpFactor) {\n_53\n        throw new Error('No TOTP factors found!')\n_53\n      }\n_53\n_53\n      const factorId = totpFactor.id\n_53\n_53\n      const challenge = await supabase.auth.mfa.challenge({ factorId })\n_53\n      if (challenge.error) {\n_53\n        setError(challenge.error.message)\n_53\n        throw challenge.error\n_53\n      }\n_53\n_53\n      const challengeId = challenge.data.id\n_53\n_53\n      const verify = await supabase.auth.mfa.verify({\n_53\n        factorId,\n_53\n        challengeId,\n_53\n        code: verifyCode,\n_53\n      })\n_53\n      if (verify.error) {\n"
    }
  },
  {
    "chunk_id": "7969ae37-366e-4a01-b96f-865ba67ef06b",
    "metadata": {
      "token_count": 410,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/totp",
      "page_title": "Multi-Factor Authentication (TOTP) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (TOTP)",
        "h2": "How does app authenticator multi-factor authentication work? \\#",
        "h3": "# Example: React \\#"
      },
      "text": " const verify = await supabase.auth.mfa.verify({\n_53\n        factorId,\n_53\n        challengeId,\n_53\n        code: verifyCode,\n_53\n      })\n_53\n      if (verify.error) {\n_53\n        setError(verify.error.message)\n_53\n        throw verify.error\n_53\n      }\n_53\n    })()\n_53\n}\n_53\n_53\nreturn (\n_53\n    <>\n_53\n      <div>Please enter the code from your authenticator app.</div>\n_53\n      {error && <div className=\"error\">{error}</div>}\n_53\n      <input\n_53\n        type=\"text\"\n_53\n        value={verifyCode}\n_53\n        onChange={(e) => setVerifyCode(e.target.value.trim())}\n_53\n      />\n_53\n      <input type=\"button\" value=\"Submit\" onClick={onSubmitClicked} />\n_53\n    </>\n_53\n)\n_53\n}\n`\n\n- You can extract the available MFA factors for the user by calling\n<code>supabase.auth.mfa.listFactors()</code>. Don't worry this method is also very quick\nand rarely uses the network.\n- If <code>listFactors()</code> returns more than one factor (or of a different type) you\nshould present the user with a choice. For simplicity this is not shown in\nthe example.\n- Each time the user presses the \"Submit\" button a new challenge is created for\nthe chosen factor (in this case the first one) and it is immediately\nverified. Any errors are displayed to the user.\n- On successful verification, the client library will refresh the session in\nthe background automatically and finally call the <code>onSuccess</code> callback, which\nwill show the authenticated <code>App</code> component on screen.\nWhat's inside the QR code?\n\nHow long is the TOTP code valid for?\n"
    }
  },
  {
    "chunk_id": "0bd3fd54-ce2c-4c44-b66d-cd3c11a3add0",
    "metadata": {
      "token_count": 128,
      "source_url": "https://supabase.com/docs/guides/auth/quickstarts/react-native",
      "page_title": "Use Supabase Auth with React Native | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Use Supabase Auth with React Native",
        "h2": "Learn how to use Supabase Auth with React Native",
        "h3": "Create a new Supabase project"
      },
      "text": "Auth\n1\n[Launch a new project](https://supabase.com/dashboard) in the Supabase Dashboard.\n\nYour new database has a table for storing your users. You can see that this table is currently empty by running some SQL in the [SQL Editor](https://supabase.com/dashboard/project/_/sql).\n\nSQL\\_EDITOR\n\n`\n_10\nselect * from auth.users;\n`\n\n2\nCreate a React app using the <code>create-expo-app</code> command.\n\nTerminal\n\n`\n_10\nnpx create-expo-app -t expo-template-blank-typescript my-app\n`\n\n3\n"
    }
  },
  {
    "chunk_id": "2e6fa2fd-989b-4667-84df-16d7ced4dc78",
    "metadata": {
      "token_count": 522,
      "source_url": "https://supabase.com/docs/guides/auth/quickstarts/react-native",
      "page_title": "Use Supabase Auth with React Native | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Use Supabase Auth with React Native",
        "h2": "Learn how to use Supabase Auth with React Native",
        "h3": "Install the Supabase client library"
      },
      "text": " auth.users;\n`\n\n2\nCreate a React app using the <code>create-expo-app</code> command.\n\nTerminal\n\n`\n_10\nnpx create-expo-app -t expo-template-blank-typescript my-app\n`\n\n3\nInstall <code>supabase-js</code> and the required dependencies.\n\nTerminal\n\n`\n_10\ncd my-app && npx expo install @supabase/supabase-js @react-native-async-storage/async-storage @rneui/themed react-native-url-polyfill\n`\n\n4\nCreate a helper file <code>lib/supabase.ts</code> that exports a Supabase client using your [Project URL and public API (anon) key](https://supabase.com/dashboard/project/_/settings/api).\n\nlib/supabase.ts\n\n``\n_29\nimport { AppState } from 'react-native'\n_29\nimport 'react-native-url-polyfill/auto'\n_29\nimport AsyncStorage from '@react-native-async-storage/async-storage'\n_29\nimport { createClient } from '@supabase/supabase-js'\n_29\n_29\nconst supabaseUrl = YOUR_REACT_NATIVE_SUPABASE_URL\n_29\nconst supabaseAnonKey = YOUR_REACT_NATIVE_SUPABASE_ANON_KEY\n_29\n_29\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n_29\nauth: {\n_29\n    storage: AsyncStorage,\n_29\n    autoRefreshToken: true,\n_29\n    persistSession: true,\n_29\n    detectSessionInUrl: false,\n_29\n},\n_29\n})\n_29\n_29\n// Tells Supabase Auth to continuously refresh the session automatically\n_29\n// if the app is in the foreground. When this is added, you will continue\n_29\n// to receive <code>onAuthStateChange</code> events with the <code>TOKEN_REFRESHED</code> or\n_29\n// <code>SIGNED_OUT</code> event if the user's session is terminated. This should\n_29\n// only be registered once.\n_29\nAppState.addEventListener('change', (state) => {\n_29\nif (state === 'active') {\n_29\n    supabase.auth.startAutoRefresh()\n_29\n} else {\n_29\n    supabase.auth.stopAutoRefresh()\n_29\n}\n_29\n})\n``\n\n5\n"
    }
  },
  {
    "chunk_id": "6408af65-7f87-433f-934c-c492efc52635",
    "metadata": {
      "token_count": 836,
      "source_url": "https://supabase.com/docs/guides/auth/quickstarts/react-native",
      "page_title": "Use Supabase Auth with React Native | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Use Supabase Auth with React Native",
        "h2": "Learn how to use Supabase Auth with React Native",
        "h3": "Create a login component"
      },
      "text": "if (state === 'active') {\n_29\n    supabase.auth.startAutoRefresh()\n_29\n} else {\n_29\n    supabase.auth.stopAutoRefresh()\n_29\n}\n_29\n})\n``\n\n5\nLet's set up a React Native component to manage logins and sign ups.\n\ncomponents/Auth.tsx\n\n`\n_83\nimport React, { useState } from 'react'\n_83\nimport { Alert, StyleSheet, View } from 'react-native'\n_83\nimport { supabase } from '../lib/supabase'\n_83\nimport { Button, Input } from '@rneui/themed'\n_83\n_83\nexport default function Auth() {\n_83\nconst [email, setEmail] = useState('')\n_83\nconst [password, setPassword] = useState('')\n_83\nconst [loading, setLoading] = useState(false)\n_83\n_83\nasync function signInWithEmail() {\n_83\n    setLoading(true)\n_83\n    const { error } = await supabase.auth.signInWithPassword({\n_83\n      email: email,\n_83\n      password: password,\n_83\n    })\n_83\n_83\n    if (error) Alert.alert(error.message)\n_83\n    setLoading(false)\n_83\n}\n_83\n_83\nasync function signUpWithEmail() {\n_83\n    setLoading(true)\n_83\n    const {\n_83\n      data: { session },\n_83\n      error,\n_83\n    } = await supabase.auth.signUp({\n_83\n      email: email,\n_83\n      password: password,\n_83\n    })\n_83\n_83\n    if (error) Alert.alert(error.message)\n_83\n    if (!session) Alert.alert('Please check your inbox for email verification!')\n_83\n    setLoading(false)\n_83\n}\n_83\n_83\nreturn (\n_83\n    <View style={styles.container}>\n_83\n      <View style={[styles.verticallySpaced, styles.mt20]}>\n_83\n        <Input\n_83\n          label=\"Email\"\n_83\n          leftIcon={{ type: 'font-awesome', name: 'envelope' }}\n_83\n          onChangeText={(text) => setEmail(text)}\n_83\n          value={email}\n_83\n          placeholder=\"email@address.com\"\n_83\n          autoCapitalize={'none'}\n_83\n        />\n_83\n      </View>\n_83\n      <View style={styles.verticallySpaced}>\n_83\n        <Input\n_83\n          label=\"Password\"\n_83\n          leftIcon={{ type: 'font-awesome', name: 'lock' }}\n_83\n          onChangeText={(text) => setPassword(text)}\n_83\n          value={password}\n_83\n          secureTextEntry={true}\n_83\n          placeholder=\"Password\"\n_83\n          autoCapitalize={'none'}\n_83\n        />\n_83\n      </View>\n_83\n      <View style={[styles.verticallySpaced, styles.mt20]}>\n_83\n        <Button title=\"Sign in\" disabled={loading} onPress={() => signInWithEmail()} />\n_83\n      </View>\n_83\n      <View style={styles.verticallySpaced}>\n_83\n        <Button title=\"Sign up\" disabled={loading} onPress={() => signUpWithEmail()} />\n_83\n      </View>\n_83\n    </View>\n_83\n)\n_83\n}\n_83\n_83\nconst styles = StyleSheet.create({\n_83\ncontainer: {\n_83\n    marginTop: 40,\n_83\n    padding: 12,\n_83\n},\n_83\nverticallySpaced: {\n_83\n    paddingTop: 4,\n_83\n    paddingBottom: 4,\n_83\n    alignSelf: 'stretch',\n_83\n},\n_83\nmt20: {\n_83\n    marginTop: 20,\n_83\n},\n_83\n})\n`\n\n6\n"
    }
  },
  {
    "chunk_id": "9fe9ab17-5533-4ae7-b688-fcaa49acd988",
    "metadata": {
      "token_count": 385,
      "source_url": "https://supabase.com/docs/guides/auth/quickstarts/react-native",
      "page_title": "Use Supabase Auth with React Native | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Use Supabase Auth with React Native",
        "h2": "Learn how to use Supabase Auth with React Native",
        "h3": "Add the Auth component to your app"
      },
      "text": ",\n_83\n    paddingBottom: 4,\n_83\n    alignSelf: 'stretch',\n_83\n},\n_83\nmt20: {\n_83\n    marginTop: 20,\n_83\n},\n_83\n})\n`\n\n6\nAdd the <code>Auth</code> component to your <code>App.tsx</code> file. If the user is logged in, print the user id to the screen.\n\nApp.tsx\n\n`\n_28\nimport 'react-native-url-polyfill/auto'\n_28\nimport { useState, useEffect } from 'react'\n_28\nimport { supabase } from './lib/supabase'\n_28\nimport Auth from './components/Auth'\n_28\nimport Account from './components/Account'\n_28\nimport { View, Text } from 'react-native'\n_28\nimport { Session } from '@supabase/supabase-js'\n_28\n_28\nexport default function App() {\n_28\nconst [session, setSession] = useState<Session | null>(null)\n_28\n_28\nuseEffect(() => {\n_28\n    supabase.auth.getSession().then(({ data: { session } }) => {\n_28\n      setSession(session)\n_28\n    })\n_28\n_28\n    supabase.auth.onAuthStateChange((_event, session) => {\n_28\n      setSession(session)\n_28\n    })\n_28\n}, [])\n_28\n_28\nreturn (\n_28\n    <View>\n_28\n      <Auth />\n_28\n      {session && session.user && <Text>{session.user.id}</Text>}\n_28\n    </View>\n_28\n)\n_28\n}\n`\n\n7\nStart the app, and follow the instructions in the terminal.\n\nTerminal\n\n`\n_10\nnpm start\n`\n"
    }
  },
  {
    "chunk_id": "54915fef-0831-4e85-9b86-90339811fb54",
    "metadata": {
      "token_count": 378,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-templates",
      "page_title": "Email Templates | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Email Templates",
        "h2": "Learn how to manage the email templates in Supabase.",
        "h3": ""
      },
      "text": "Auth\nYou can customize the email messages used for the authentication flows. You can edit the following email templates:\n\n- Confirm signup\n- Invite user\n- Magic Link\n- Change Email Address\n- Reset Password\nThe templating system provides the following variables for use:\n\n| Name | Description |\n| --- | --- |\n| <code>{{ .ConfirmationURL }}</code> | Contains the confirmation URL. For example, a signup confirmation URL would look like: <code>https://project-ref.supabase.co/auth/v1/verify?token={{ .TokenHash }}&type=signup&redirect_to=https://example.com/path</code> . |\n| <code>{{ .Token }}</code> | Contains a 6-digit One-Time-Password (OTP) that can be used instead of the <code>{{. ConfirmationURL }}</code> . |\n| <code>{{ .TokenHash }}</code> | Contains a hashed version of the <code>{{ .Token }}</code>. This is useful for constructing your own email link in the email template. |\n| <code>{{ .SiteURL }}</code> | Contains your application's Site URL. This can be configured in your project's [authentication settings](/dashboard/project/_/auth/url-configuration). |\n| <code>{{ .RedirectTo }}</code> | Contains the redirect URL passed when <code>signUp</code>, <code>signInWithOtp</code>, <code>signInWithOAuth</code>, <code>resetPasswordForEmail</code> or <code>inviteUserByEmail</code> is called. The redirect URL allow list can be configured in your project's [authentication settings](/dashboard/project/_/auth/url-configuration). |\n| <code>{{ .Data }}</code> | Contains metadata from <code>auth.users.user_metadata</code>. Use this to personalize the email message. |\n"
    }
  },
  {
    "chunk_id": "cceebe17-bd51-4de5-befc-b18b38fa976a",
    "metadata": {
      "token_count": 151,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-templates",
      "page_title": "Email Templates | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Email Templates",
        "h2": "Editing email templates \\#",
        "h3": ""
      },
      "text": " your project's [authentication settings](/dashboard/project/_/auth/url-configuration). |\n| <code>{{ .Data }}</code> | Contains metadata from <code>auth.users.user_metadata</code>. Use this to personalize the email message. |\nOn hosted Supabase projects, edit your email templates on the [Email Templates](/dashboard/project/_/auth/templates) page. On self-hosted projects or in local development, edit your [configuration files](/docs/guides/cli/customizing-email-templates).\nFor mobile applications, you might need to link or redirect to a specific page within your app. See the [Mobile Deep Linking guide](/docs/guides/auth/native-mobile-deep-linking) to set this up.\n"
    }
  },
  {
    "chunk_id": "e81535cb-a8e6-4728-a633-2bc79fdefbab",
    "metadata": {
      "token_count": 301,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-templates",
      "page_title": "Email Templates | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Email Templates",
        "h2": "Limitations \\#",
        "h3": "Email prefetching \\#"
      },
      "text": "-email-templates).\nFor mobile applications, you might need to link or redirect to a specific page within your app. See the [Mobile Deep Linking guide](/docs/guides/auth/native-mobile-deep-linking) to set this up.\nCertain email providers may have spam detection or other security features that prefetch URL links from incoming emails (e.g. [Safe Links in Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/safe-links-about?view=o365-worldwide)).\nIn this scenario, the <code>{{ .ConfirmationURL }}</code> sent will be consumed instantly which leads to a \"Token has expired or is invalid\" error.\nTo guard against this:\n\n- Use an email OTP instead by including <code>{{ .Token }}</code> in the email template.\n\n- Create your own custom email link to redirect the user to a page where they can click on a button to confirm the action.\nFor example, you can include the following in your email template:\n\n`\n_10\n<a href=\"{{ .SiteURL }}/confirm-signup?confirmation_url={{ .ConfirmationURL }}\"\n_10\n>Confirm your signup\n_10\n</a>\n`\n\nThe user should be brought to a page on your site where they can confirm the action by clicking a button.\nThe button should contain the actual confirmation link which can be obtained from parsing the <code>confirmation_url={{ .ConfirmationURL }}</code> query parameter in the URL.\n"
    }
  },
  {
    "chunk_id": "b2693bdc-1afa-4030-9287-2a44a42044e9",
    "metadata": {
      "token_count": 514,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-templates",
      "page_title": "Email Templates | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Email Templates",
        "h2": "Limitations \\#",
        "h3": "Email tracking \\#"
      },
      "text": " to a page on your site where they can confirm the action by clicking a button.\nThe button should contain the actual confirmation link which can be obtained from parsing the <code>confirmation_url={{ .ConfirmationURL }}</code> query parameter in the URL.\nIf you are using an external email provider that enables \"email tracking\", the links inside the Supabase email templates will be overwritten and won't perform as expected. We recommend disabling email tracking to ensure email links are not overwritten.\nIf you intend to use [Server-side rendering](/docs/guides/auth/server-side-rendering), you might want the email link to redirect the user to a server-side endpoint to check if they are authenticated before returning the page. However, the default email link will redirect the user after verification to the redirect URL with the session in the query fragments. Since the session is returned in the query fragments by default, you won't be able to access it on the server-side.\n\nYou can customize the email link in the email template to redirect the user to a server-side endpoint successfully. For example:\n\n`\n_10\n<a\n_10\nhref=\"https://api.example.com/v1/authenticate?token_hash={{ .TokenHash }}&type=invite&redirect_to={{ .RedirectTo }}\"\n_10\n>Accept the invite\n_10\n</a>\n`\n\nWhen the user clicks on the link, the request will hit <code>https://api.example.com/v1/authenticate</code> and you can grab the <code>token_hash</code>, <code>type</code> and <code>redirect_to</code> query parameters from the URL. Then, you can call the [<code>verifyOtp</code>](/docs/reference/javascript/auth-verifyotp) method to get back an authenticated session before redirecting the user back to the client. Since the <code>verifyOtp</code> method makes a <code>POST</code> request to Supabase Auth to verify the user, the session will be returned in the response body, which can be read by the server. For example:\n\n`\n_10\nconst { token_hash, type } = Object.fromEntries(new URLSearchParams(window.location.search))\n_10\nconst {\n_10\ndata: { session },\n_10\nerror,\n_10\n} = await supabase.auth.verifyOtp({ token_hash, type })\n_10\n_10\n// subsequently redirect the user back to the client using the redirect_to param\n_10\n// ...\n`\n"
    }
  },
  {
    "chunk_id": "5c38e16a-83f7-4436-92ca-d75bafb7af0f",
    "metadata": {
      "token_count": 329,
      "source_url": "https://supabase.com/docs/guides/auth/auth-email-templates",
      "page_title": "Email Templates | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Email Templates",
        "h2": "Customization \\#",
        "h3": "Send different email to early access users \\#"
      },
      "text": "10\nerror,\n_10\n} = await supabase.auth.verifyOtp({ token_hash, type })\n_10\n_10\n// subsequently redirect the user back to the client using the redirect_to param\n_10\n// ...\n`\nSupabase Auth makes use of [Go Templates](https://pkg.go.dev/text/template). This means it is possible to conditionally render information based on template properties.You may wish to checkout this [guide by Hugo](https://gohugo.io/templates/introduction/) for a guide on the templating language.\nSend a different email to users who signed up via an early access domain ( <code>https://www.earlyaccess.trial.com</code>).\n\n`\n_14\n{{ if eq .Data.Domain \"https://www.example.com\" }}\n_14\n<h1>Welcome to Our Database Service!</h1>\n_14\n<p>Dear Developer,</p>\n_14\n<p>Welcome to Billy, the scalable developer platform!</p>\n_14\n<p>Best Regards,<br>\n_14\nBilly Team</p>\n_14\n{{ else if eq .Data.Domain \"https://www.earlyaccess.trial.com\" }}\n_14\n<h1>Welcome to Our Database Service!</h1>\n_14\n<p>Dear Developer,</p>\n_14\n<p>Welcome Billy, the scalable developer platform!</p>\n_14\n<p> As an early access member, you have access to select features like Point To Space Restoration.</p>\n_14\n<p>Best Regards,<br>\n_14\nBilly Team</p>\n_14\n{{ end }}\n`\n"
    }
  },
  {
    "chunk_id": "0e120b98-0bf9-4edc-8b2d-adbb00aa3e33",
    "metadata": {
      "token_count": 114,
      "source_url": "https://supabase.com/docs/guides/auth/server-side",
      "page_title": "Server-Side Rendering | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Server-Side Rendering",
        "h2": "How SSR works with Supabase Auth.",
        "h3": ""
      },
      "text": "Auth\nSSR frameworks move rendering and data fetches to the server, to reduce client bundle size and execution time.\n\nSupabase Auth is fully compatible with SSR. You need to make a few changes to the configuration of your Supabase client, to store the user session in cookies instead of local storage. After setting up your Supabase client, follow the instructions for any flow in the How-To guides.\n\nMake sure to use the PKCE flow instructions where those differ from the implicit flow instructions. If no difference is mentioned, don't worry about this.\n"
    }
  },
  {
    "chunk_id": "50e784a7-ee49-45eb-909d-527ad210062f",
    "metadata": {
      "token_count": 193,
      "source_url": "https://supabase.com/docs/guides/auth/server-side",
      "page_title": "Server-Side Rendering | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Server-Side Rendering",
        "h2": "<code>@supabase/ssr</code> \\#",
        "h3": ""
      },
      "text": " setting up your Supabase client, follow the instructions for any flow in the How-To guides.\n\nMake sure to use the PKCE flow instructions where those differ from the implicit flow instructions. If no difference is mentioned, don't worry about this.\nWe have developed an [<code>@supabase/ssr</code>](https://www.npmjs.com/package/@supabase/ssr) package to make setting up the Supabase client as simple as possible. This package is currently in beta. Adoption is recommended but be aware that the API is still unstable and may have breaking changes in the future.\n\nIf you're currently using the [Auth Helpers package](https://github.com/supabase/auth-helpers), the [docs are still available](/docs/guides/auth/auth-helpers), however we recommend migrating to the new <code>@supabase/ssr</code> package as this will be the recommended path moving forward.\n"
    }
  },
  {
    "chunk_id": "8726e469-badb-4690-989e-57cddf4348b2",
    "metadata": {
      "token_count": 190,
      "source_url": "https://supabase.com/docs/guides/auth/server-side",
      "page_title": "Server-Side Rendering | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Server-Side Rendering",
        "h2": "Framework quickstarts \\#",
        "h3": ""
      },
      "text": "/auth-helpers), the [docs are still available](/docs/guides/auth/auth-helpers), however we recommend migrating to the new <code>@supabase/ssr</code> package as this will be the recommended path moving forward.\n[![Next.js](https://supabase.com/docs/img/icons/nextjs-icon.svg)\\\\\n\\\\\nNext.js\\\\\n\\\\\nAutomatically configure Supabase in Next.js to use cookies, making your user and their session available on the client and server.](/docs/guides/auth/server-side/nextjs) [![SvelteKit](https://supabase.com/docs/img/icons/svelte-icon.svg)\\\\\n\\\\\nSvelteKit\\\\\n\\\\\nAutomatically configure Supabase in SvelteKit to use cookies, making your user and their session available on the client and server.](/docs/guides/auth/server-side/sveltekit)\n"
    }
  },
  {
    "chunk_id": "8df0bfbe-6913-4661-ba0a-d6552bc1f8de",
    "metadata": {
      "token_count": 118,
      "source_url": "https://supabase.com/docs/guides/auth/quickstarts/react",
      "page_title": "Use Supabase Auth with React | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Use Supabase Auth with React",
        "h2": "Learn how to use Supabase Auth with React.js.",
        "h3": "Create a new Supabase project"
      },
      "text": "Auth\n1\n[Launch a new project](https://supabase.com/dashboard) in the Supabase Dashboard.\n\nYour new database has a table for storing your users. You can see that this table is currently empty by running some SQL in the [SQL Editor](https://supabase.com/dashboard/project/_/sql).\n\nSQL\\_EDITOR\n\n`\n_10\nselect * from auth.users;\n`\n\n2\nCreate a React app using the <code>create-react-app</code> command.\n\nTerminal\n\n`\n_10\nnpx create-react-app my-app\n`\n\n3\n"
    }
  },
  {
    "chunk_id": "bb612dc5-6b14-4c15-b9ab-a7fd3797c70e",
    "metadata": {
      "token_count": 581,
      "source_url": "https://supabase.com/docs/guides/auth/quickstarts/react",
      "page_title": "Use Supabase Auth with React | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Use Supabase Auth with React",
        "h2": "Learn how to use Supabase Auth with React.js.",
        "h3": "Install the Supabase client library"
      },
      "text": "\\_EDITOR\n\n`\n_10\nselect * from auth.users;\n`\n\n2\nCreate a React app using the <code>create-react-app</code> command.\n\nTerminal\n\n`\n_10\nnpx create-react-app my-app\n`\n\n3\nThe fastest way to get started is to use Supabase's <code>auth-ui-react</code> library which provides a convenient interface for working with Supabase Auth from a React app.\n\nNavigate to the React app and install the Supabase libraries.\n\nTerminal\n\n`\n_10\ncd my-app && npm install @supabase/supabase-js @supabase/auth-ui-react @supabase/auth-ui-shared\n`\n\n4\nIn <code>index.js</code>, create a Supabase client using your [Project URL and public API (anon) key](https://supabase.com/dashboard/project/_/settings/api).\n\nYou can configure the Auth component to display whenever there is no session inside <code>supabase.auth.getSession()</code>\n\nsrc/index.js\n\n`\n_32\nimport './index.css'\n_32\nimport { useState, useEffect } from 'react'\n_32\nimport { createClient } from '@supabase/supabase-js'\n_32\nimport { Auth } from '@supabase/auth-ui-react'\n_32\nimport { ThemeSupa } from '@supabase/auth-ui-shared'\n_32\n_32\nconst supabase = createClient('https://<project>.supabase.co', '<your-anon-key>')\n_32\n_32\nexport default function App() {\n_32\n    const [session, setSession] = useState(null)\n_32\n_32\n    useEffect(() => {\n_32\n      supabase.auth.getSession().then(({ data: { session } }) => {\n_32\n        setSession(session)\n_32\n      })\n_32\n_32\n      const {\n_32\n        data: { subscription },\n_32\n      } = supabase.auth.onAuthStateChange((_event, session) => {\n_32\n        setSession(session)\n_32\n      })\n_32\n_32\n      return () => subscription.unsubscribe()\n_32\n    }, [])\n_32\n_32\n    if (!session) {\n_32\n      return (<Auth supabaseClient={supabase} appearance={{ theme: ThemeSupa }} />)\n_32\n    }\n_32\n    else {\n_32\n      return (<div>Logged in!</div>)\n_32\n    }\n_32\n}\n`\n\n5\nStart the app, go to [http://localhost:3000](http://localhost:3000) in a browser, and open the browser console and you should be able to log in.\n\nTerminal\n\n`\n_10\nnpm start\n`\n"
    }
  },
  {
    "chunk_id": "fcaeb0c3-5a78-4b7b-9b9e-7db9ea99e10c",
    "metadata": {
      "token_count": 196,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/phone",
      "page_title": "Multi-Factor Authentication (Phone) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (Phone)",
        "h2": "How does phone multi-factor-authentication work? \\#",
        "h3": ""
      },
      "text": "Auth\nPhone multi-factor authentication involves a shared code generated by Supabase Auth and the end user. The code is delivered via a messaging channel, such as SMS or WhatsApp, and the user uses the code to authenticate to Supabase Auth.\n\nThe phone messaging configuration for MFA is shared with [phone auth login](/docs/guides/auth/phone-login). The same provider configuration that is used for phone login is used for MFA. You can also use the [Send SMS Hook](/docs/guides/auth/auth-hooks/send-sms-hook) if you need to use an MFA (Phone) messaging provider different from what is supported natively.\n\nBelow is a flow chart illustrating how the Enrollment and Verify APIs work in the context of MFA (Phone).\n\nPhone MFA is part of the Auth Advanced MFA Add-on and costs an additional $75 per month for the first project in the organization and an additional $10 per month for additional projects.\n"
    }
  },
  {
    "chunk_id": "b0ec91bd-6aef-4c4a-8c9c-849f1f659700",
    "metadata": {
      "token_count": 345,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/phone",
      "page_title": "Multi-Factor Authentication (Phone) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (Phone)",
        "h2": "How does phone multi-factor-authentication work? \\#",
        "h3": "Add enrollment flow \\#"
      },
      "text": " APIs work in the context of MFA (Phone).\n\nPhone MFA is part of the Auth Advanced MFA Add-on and costs an additional $75 per month for the first project in the organization and an additional $10 per month for additional projects.\nAn enrollment flow provides a UI for users to set up additional authentication factors. Most applications add the enrollment flow in two places within their app:\n\n1. Right after login or sign up.\nThis allows users quickly set up Multi Factor Authentication (MFA) post login or account creation. Where possible, encourage all users to set up MFA. Many applications offer this as an opt-in step in an\neffort to reduce onboarding friction.\n2. From within a settings page.\nAllows users to set up, disable or modify their MFA settings.\n\nAs far as possible, maintain a generic flow that you can reuse in both cases with minor modifications.\n\nEnrolling a factor for use with MFA takes three steps for phone MFA:\n\n1. Call <code>supabase.auth.mfa.enroll()</code>.\n2. Calling the <code>supabase.auth.mfa.challenge()</code> API. This sends a code via SMS or WhatsApp and prepares Supabase Auth to accept a verification code from the user.\n3. Calling the <code>supabase.auth.mfa.verify()</code> API. <code>supabase.auth.mfa.challenge()</code> returns a challenge ID.\nThis verifies that the code issued by Supabase Auth matches the code input by the user. If the verification succeeds, the factor\nimmediately becomes active for the user account. If not, you should repeat\nsteps 2 and 3.\n"
    }
  },
  {
    "chunk_id": "9813a7b5-9538-4ee3-82bf-0a990f5d97f3",
    "metadata": {
      "token_count": 848,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/phone",
      "page_title": "Multi-Factor Authentication (Phone) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (Phone)",
        "h2": "How does phone multi-factor-authentication work? \\#",
        "h3": "# Example: React \\#"
      },
      "text": "This verifies that the code issued by Supabase Auth matches the code input by the user. If the verification succeeds, the factor\nimmediately becomes active for the user account. If not, you should repeat\nsteps 2 and 3.\nBelow is an example that creates a new <code>EnrollMFA</code> component that illustrates the important pieces of the MFA enrollment flow.\n\n- When the component appears on screen, the <code>supabase.auth.mfa.enroll()</code> API is\ncalled once to start the process of enrolling a new factor for the current\nuser.\n- A challenge is created using the <code>supabase.auth.mfa.challenge()</code> API and the\ncode from the user is submitted for verification using the\n<code>supabase.auth.mfa.verify()</code> challenge.\n- <code>onEnabled</code> is a callback that notifies the other components that enrollment\nhas completed.\n- <code>onCancelled</code> is a callback that notifies the other components that the user\nhas clicked the <code>Cancel</code> button.\n\n`\n_84\nexport function EnrollMFA({\n_84\nonEnrolled,\n_84\nonCancelled,\n_84\n}: {\n_84\nonEnrolled: () => void\n_84\nonCancelled: () => void\n_84\n}) {\n_84\nconst [phoneNumber, setPhoneNumber] = useState('')\n_84\nconst [factorId, setFactorId] = useState('')\n_84\nconst [verifyCode, setVerifyCode] = useState('')\n_84\nconst [error, setError] = useState('')\n_84\nconst [challengeId, setChallengeId] = useState('')\n_84\n_84\nconst onEnableClicked = () => {\n_84\n    setError('')\n_84\n    ;(async () => {\n_84\n      const verify = await auth.mfa.verify({\n_84\n        factorId,\n_84\n        challengeId,\n_84\n        code: verifyCode,\n_84\n      })\n_84\n      if (verify.error) {\n_84\n        setError(verify.error.message)\n_84\n        throw verify.error\n_84\n      }\n_84\n_84\n      onEnrolled()\n_84\n    })()\n_84\n}\n_84\nconst onEnrollClicked = async () => {\n_84\n    setError('')\n_84\n    try {\n_84\n      const factor = await auth.mfa.enroll({\n_84\n        phone: phoneNumber,\n_84\n        factorType: 'phone',\n_84\n      })\n_84\n      if (factor.error) {\n_84\n        setError(factor.error.message)\n_84\n        throw factor.error\n_84\n      }\n_84\n_84\n      setFactorId(factor.data.id)\n_84\n    } catch (error) {\n_84\n      setError('Failed to Enroll the Factor.')\n_84\n    }\n_84\n}\n_84\n_84\nconst onSendOTPClicked = async () => {\n_84\n    setError('')\n_84\n    try {\n_84\n      const challenge = await auth.mfa.challenge({ factorId })\n_84\n      if (challenge.error) {\n_84\n        setError(challenge.error.message)\n_84\n        throw challenge.error\n_84\n      }\n_84\n_84\n      setChallengeId(challenge.data.id)\n_84\n    } catch (error) {\n_84\n      setError('Failed to resend the code.')\n_84\n    }\n_84\n}\n_84\n_84\nreturn (\n_84\n    <>\n_84\n      {error && <div className=\"error\">{error}</div>}\n_84\n      <input\n_84\n        type=\"text\"\n_84\n        placeholder=\"Phone Number\"\n_84\n        value={phoneNumber}\n_84\n        onChange={(e) => setPhoneNumber(e.target.value.trim())}\n_84\n      />\n_84\n      <input\n_84\n        type=\"text\"\n_84\n"
    }
  },
  {
    "chunk_id": "3ce418bc-6e7d-4e7c-bce4-befa6671049e",
    "metadata": {
      "token_count": 191,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/phone",
      "page_title": "Multi-Factor Authentication (Phone) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (Phone)",
        "h2": "How does phone multi-factor-authentication work? \\#",
        "h3": "# Example: React \\#"
      },
      "text": " Number\"\n_84\n        value={phoneNumber}\n_84\n        onChange={(e) => setPhoneNumber(e.target.value.trim())}\n_84\n      />\n_84\n      <input\n_84\n        type=\"text\"\n_84\n        placeholder=\"Verification Code\"\n_84\n        value={verifyCode}\n_84\n        onChange={(e) => setVerifyCode(e.target.value.trim())}\n_84\n      />\n_84\n      <input type=\"button\" value=\"Enroll\" onClick={onEnrollClicked} />\n_84\n      <input type=\"button\" value=\"Submit Code\" onClick={onEnableClicked} />\n_84\n      <input type=\"button\" value=\"Send OTP Code\" onClick={onSendOTPClicked} />\n_84\n      <input type=\"button\" value=\"Cancel\" onClick={onCancelled} />\n_84\n    </>\n_84\n)\n_84\n}\n`\n"
    }
  },
  {
    "chunk_id": "29b90eba-3d47-4201-9f21-103b63d304f2",
    "metadata": {
      "token_count": 358,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/phone",
      "page_title": "Multi-Factor Authentication (Phone) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (Phone)",
        "h2": "How does phone multi-factor-authentication work? \\#",
        "h3": "Add a challenge step to login \\#"
      },
      "text": "button\" value=\"Send OTP Code\" onClick={onSendOTPClicked} />\n_84\n      <input type=\"button\" value=\"Cancel\" onClick={onCancelled} />\n_84\n    </>\n_84\n)\n_84\n}\n`\nOnce a user has logged in via their first factor (email+password, magic link, one time password, social login etc.) you need to perform a check if any additional factors need to be verified.\n\nThis can be done by using the <code>supabase.auth.mfa.getAuthenticatorAssuranceLevel()</code> API. When the user signs in and is redirected back to your app, you should call this method to extract the user's current and next authenticator assurance level (AAL).\n\nTherefore if you receive a <code>currentLevel</code> which is <code>aal1</code> but a <code>nextLevel</code> of <code>aal2</code>, the user should be given the option to go through MFA.\n\nBelow is a table that explains the combined meaning.\n\n| Current Level | Next Level | Meaning |\n| --: | :-- | :-- |\n| <code>aal1</code> | <code>aal1</code> | User does not have MFA enrolled. |\n| <code>aal1</code> | <code>aal2</code> | User has an MFA factor enrolled but has not verified it. |\n| <code>aal2</code> | <code>aal2</code> | User has verified their MFA factor. |\n| <code>aal2</code> | <code>aal1</code> | User has disabled their MFA factor. (Stale JWT.) |\n"
    }
  },
  {
    "chunk_id": "24473926-ecc3-42d3-968c-c10e440c787c",
    "metadata": {
      "token_count": 849,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/phone",
      "page_title": "Multi-Factor Authentication (Phone) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (Phone)",
        "h2": "How does phone multi-factor-authentication work? \\#",
        "h3": "# Example: React \\#"
      },
      "text": "code>aal2</code> | User has verified their MFA factor. |\n| <code>aal2</code> | <code>aal1</code> | User has disabled their MFA factor. (Stale JWT.) |\nAdding the challenge step to login depends heavily on the architecture of your app. However, a fairly common way to structure React apps is to have a large component (often named <code>App</code>) which contains most of the authenticated application logic.\n\nThis example will wrap this component with logic that will show an MFA challenge screen if necessary, before showing the full application. This is illustrated in the <code>AppWithMFA</code> example below.\n\n`\n_33\nfunction AppWithMFA() {\n_33\nconst [readyToShow, setReadyToShow] = useState(false)\n_33\nconst [showMFAScreen, setShowMFAScreen] = useState(false)\n_33\n_33\nuseEffect(() => {\n_33\n    ;(async () => {\n_33\n      try {\n_33\n        const { data, error } = await supabase.auth.mfa.getAuthenticatorAssuranceLevel()\n_33\n        if (error) {\n_33\n          throw error\n_33\n        }\n_33\n_33\n        console.log(data)\n_33\n_33\n        if (data.nextLevel === 'aal2' && data.nextLevel !== data.currentLevel) {\n_33\n          setShowMFAScreen(true)\n_33\n        }\n_33\n      } finally {\n_33\n        setReadyToShow(true)\n_33\n      }\n_33\n    })()\n_33\n}, [])\n_33\n_33\nif (readyToShow) {\n_33\n    if (showMFAScreen) {\n_33\n      return <AuthMFA />\n_33\n    }\n_33\n_33\n    return <App />\n_33\n}\n_33\n_33\nreturn <></>\n_33\n}\n`\n\n- <code>supabase.auth.mfa.getAuthenticatorAssuranceLevel()</code> does return a promise.\nDon't worry, this is a very fast method (microseconds) as it rarely uses the\nnetwork.\n- <code>readyToShow</code> only makes sure the AAL check completes before showing any\napplication UI to the user.\n- If the current level can be upgraded to the next one, the MFA screen is\nshown.\n- Once the challenge is successful, the <code>App</code> component is finally rendered on\nscreen.\n\nBelow is the component that implements the challenge and verify logic.\n\n`\n_72\nfunction AuthMFA() {\n_72\nconst [verifyCode, setVerifyCode] = useState('')\n_72\nconst [error, setError] = useState('')\n_72\nconst [factorId, setFactorId] = useState('')\n_72\nconst [challengeId, setChallengeId] = useState('')\n_72\nconst [phoneNumber, setPhoneNumber] = useState('')\n_72\n_72\nconst startChallenge = async () => {\n_72\n    setError('')\n_72\n    try {\n_72\n      const factors = await supabase.auth.mfa.listFactors()\n_72\n      if (factors.error) {\n_72\n        throw factors.error\n_72\n      }\n_72\n_72\n      const phoneFactor = factors.data.phone[0]\n_72\n_72\n      if (!phoneFactor) {\n_72\n        throw new Error('No phone factors found!')\n_72\n      }\n_72\n_72\n      const factorId = phoneFactor.id\n_72\n      setFactorId(factorId)\n_72\n      setPhoneNumber(phoneFactor.phone)\n_72\n_72\n      const challenge = await supabase.auth.mfa.challenge({ factorId })\n_72\n      if (challenge.error) {\n_72\n        setError(challenge.error.message)\n_72\n        throw challenge.error\n_72\n      }\n_72\n_72\n      setChallengeId(challenge.data.id)\n_72\n"
    }
  },
  {
    "chunk_id": "dc23f44b-caae-4738-b575-19775e1dd982",
    "metadata": {
      "token_count": 602,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/phone",
      "page_title": "Multi-Factor Authentication (Phone) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (Phone)",
        "h2": "How does phone multi-factor-authentication work? \\#",
        "h3": "# Example: React \\#"
      },
      "text": "72\n      if (challenge.error) {\n_72\n        setError(challenge.error.message)\n_72\n        throw challenge.error\n_72\n      }\n_72\n_72\n      setChallengeId(challenge.data.id)\n_72\n    } catch (error) {\n_72\n      setError(error.message)\n_72\n    }\n_72\n}\n_72\n_72\nconst verifyCode = async () => {\n_72\n    setError('')\n_72\n    try {\n_72\n      const verify = await supabase.auth.mfa.verify({\n_72\n        factorId,\n_72\n        challengeId,\n_72\n        code: verifyCode,\n_72\n      })\n_72\n      if (verify.error) {\n_72\n        setError(verify.error.message)\n_72\n        throw verify.error\n_72\n      }\n_72\n    } catch (error) {\n_72\n      setError(error.message)\n_72\n    }\n_72\n}\n_72\n_72\nreturn (\n_72\n    <>\n_72\n      <div>Please enter the code sent to your phone.</div>\n_72\n      {phoneNumber && <div>Phone number: {phoneNumber}</div>}\n_72\n      {error && <div className=\"error\">{error}</div>}\n_72\n      <input\n_72\n        type=\"text\"\n_72\n        value={verifyCode}\n_72\n        onChange={(e) => setVerifyCode(e.target.value.trim())}\n_72\n      />\n_72\n      {!challengeId ? (\n_72\n        <input type=\"button\" value=\"Start Challenge\" onClick={startChallenge} />\n_72\n      ) : (\n_72\n        <input type=\"button\" value=\"Verify Code\" onClick={verifyCode} />\n_72\n      )}\n_72\n    </>\n_72\n)\n_72\n}\n`\n\n- You can extract the available MFA factors for the user by calling\n<code>supabase.auth.mfa.listFactors()</code>. Don't worry this method is also very quick\nand rarely uses the network.\n- If <code>listFactors()</code> returns more than one factor (or of a different type) you\nshould present the user with a choice. For simplicity this is not shown in\nthe example.\n- Phone numbers are unique per user. Users can only have one verified phone factor with a given phone number.\nAttempting to enroll a new phone factor alongside an existing verified factor with the same number will result in an error.\n- Each time the user presses the \"Submit\" button a new challenge is created for\nthe chosen factor (in this case the first one)\n- On successful verification, the client library will refresh the session in\nthe background automatically and finally call the <code>onSuccess</code> callback, which\nwill show the authenticated <code>App</code> component on screen.\n"
    }
  },
  {
    "chunk_id": "c1173dba-cbfe-45c5-9ac8-2ba47f221359",
    "metadata": {
      "token_count": 200,
      "source_url": "https://supabase.com/docs/guides/auth/auth-mfa/phone",
      "page_title": "Multi-Factor Authentication (Phone) | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Multi-Factor Authentication (Phone)",
        "h2": "How does phone multi-factor-authentication work? \\#",
        "h3": "Security Configuration \\#"
      },
      "text": " one)\n- On successful verification, the client library will refresh the session in\nthe background automatically and finally call the <code>onSuccess</code> callback, which\nwill show the authenticated <code>App</code> component on screen.\nEach code is valid for up to 5 minutes, after which a new one can be sent. Successive codes remain valid until expiry. When possible choose the longest code length acceptable to your use case, at a minimum of 6. This can be configured in the [Authentication Settings](/dashboard/project/_/settings/auth).\n\nPlease be aware that Phone MFA is vulnerable to SIM swap attacks where an attacker will call a mobile provider and ask to port the target's phone number to a new SIM card and then use the said SIM card to intercept an MFA code. Please evaluate the your application's tolerance for such an attack. You can read more about SIM swapping attacks [here](https://en.wikipedia.org/wiki/SIM_swap_scam)\n"
    }
  },
  {
    "chunk_id": "b0616a68-71ac-45ec-a61a-89e8633d30cc",
    "metadata": {
      "token_count": 226,
      "source_url": "https://supabase.com/docs/guides/auth/phone-login",
      "page_title": "Phone Login | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Phone Login",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nPhone Login is a method of authentication that allows users to log in to a website or application without using a password. The user authenticates through a one-time code sent via SMS.\n\nUsers can also log in with their phones using Native Mobile Login with the built-in identity provider. For Native Mobile Login with Android and iOS, see the [Social Login guides](/docs/guides/auth/social-login).\n\nPhone OTP login can:\n\n- Improve the user experience by not requiring users to create and remember a password\n- Increase security by reducing the risk of password-related security breaches\n- Reduce support burden of dealing with password resets and other password-related flows\n\nTo keep SMS sending costs under control, make sure you adjust your project's rate limits and [configure CAPTCHA](/docs/guides/auth/auth-captcha). See the [Production Checklist](/docs/guides/platform/going-into-prod) to learn more.\n\nSome countries have special regulations for services that send SMS messages to users, for example, India's TRAI DLT regulations. Remember to look up and follow the regulations of countries where you operate.\n"
    }
  },
  {
    "chunk_id": "ed80d3b9-2279-4ffa-989f-1bfc1837333d",
    "metadata": {
      "token_count": 154,
      "source_url": "https://supabase.com/docs/guides/auth/phone-login",
      "page_title": "Phone Login | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Phone Login",
        "h2": "Enabling Phone Login \\#",
        "h3": ""
      },
      "text": "/going-into-prod) to learn more.\n\nSome countries have special regulations for services that send SMS messages to users, for example, India's TRAI DLT regulations. Remember to look up and follow the regulations of countries where you operate.\nEnable phone authentication on the [Auth Providers page](/dashboard/project/_/auth/providers) for hosted Supabase projects.\n\nFor self-hosted projects or local development, use the [configuration file](/docs/guides/cli/config#auth.sms.enable_signup). See the configuration variables namespaced under <code>auth.sms</code>.\n\nYou also need to set up an SMS provider. Each provider has its own configuration. Supported providers include MessageBird, Twilio, Vonage, and TextLocal (community-supported).\n"
    }
  },
  {
    "chunk_id": "22c6ec5b-b7ec-4826-bb98-32b66965a234",
    "metadata": {
      "token_count": 160,
      "source_url": "https://supabase.com/docs/guides/auth/phone-login",
      "page_title": "Phone Login | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Phone Login",
        "h2": "Enabling Phone Login \\#",
        "h3": "Configuring SMS Providers"
      },
      "text": " the configuration variables namespaced under <code>auth.sms</code>.\n\nYou also need to set up an SMS provider. Each provider has its own configuration. Supported providers include MessageBird, Twilio, Vonage, and TextLocal (community-supported).\n![MessageBird Icon](https://supabase.com/docs/img/icons/messagebird-icon.svg)\n![Twilio Icon](https://supabase.com/docs/img/icons/twilio-icon.svg)\n![Vonage Icon](https://supabase.com/docs/img/icons/vonage-icon-light.svg)\n![Textlocal (Community Supported) Icon](https://supabase.com/docs/guides/auth/Community%20Supported)\nBy default, a user can only request an OTP once every 60 seconds and they expire after 1 hour.\n"
    }
  },
  {
    "chunk_id": "ac895656-1972-45ba-9be7-85a8c42e7668",
    "metadata": {
      "token_count": 425,
      "source_url": "https://supabase.com/docs/guides/auth/phone-login",
      "page_title": "Phone Login | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Phone Login",
        "h2": "Signing in with phone OTP \\#",
        "h3": ""
      },
      "text": ")\n![Textlocal (Community Supported) Icon](https://supabase.com/docs/guides/auth/Community%20Supported)\nBy default, a user can only request an OTP once every 60 seconds and they expire after 1 hour.\nWith OTP, a user can sign in without setting a password on their account. They need to verify their phone number each time they sign in.\n\nJavaScriptSwiftKotlinPythonHTTP\n\n`\n_10\nconst { data, error } = await supabase.auth.signInWithOtp({\n_10\nphone: '+13334445555',\n_10\n})\n`\n\nThe user receives an SMS with a 6-digit pin that you must verify within 60 seconds.\nTo verify the one-time password (OTP) sent to the user's phone number, call [<code>verifyOtp()</code>](/docs/reference/javascript/auth-verifyotp) with the phone number and OTP:\n\nJavaScriptSwiftKotlinPythonHTTP\n\nYou should present a form to the user so they can input the 6 digit pin, then send it along with the phone number to <code>verifyOtp</code>:\n\n`\n_10\nconst {\n_10\ndata: { session },\n_10\nerror,\n_10\n} = await supabase.auth.verifyOtp({\n_10\nphone: '13334445555',\n_10\ntoken: '123456',\n_10\ntype: 'sms',\n_10\n})\n`\n\nIf successful the user will now be logged in and you should receive a valid session like:\n\n`\n_10\n{\n_10\n\"access_token\": \"<ACCESS_TOKEN>\",\n_10\n\"token_type\": \"bearer\",\n_10\n\"expires_in\": 3600,\n_10\n\"refresh_token\": \"<REFRESH_TOKEN>\"\n_10\n}\n`\n\nThe access token can be sent in the Authorization header as a Bearer token for any CRUD operations on supabase-js. See our guide on [Row Level Security](/docs/guides/auth#row-level-security) for more info on restricting access on a user basis.\n"
    }
  },
  {
    "chunk_id": "fb1e9758-d326-4abe-a43e-a43c77fbca91",
    "metadata": {
      "token_count": 185,
      "source_url": "https://supabase.com/docs/guides/auth/phone-login",
      "page_title": "Phone Login | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Phone Login",
        "h2": "Updating a phone number \\#",
        "h3": ""
      },
      "text": " in the Authorization header as a Bearer token for any CRUD operations on supabase-js. See our guide on [Row Level Security](/docs/guides/auth#row-level-security) for more info on restricting access on a user basis.\nTo update a user's phone number, the user must be logged in. Call [<code>updateUser()</code>](/docs/reference/javascript/auth-updateuser) with their phone number:\n\nJavaScriptSwiftPython\n\n`\n_10\nconst { data, error } = await supabase.auth.updateUser({\n_10\nphone: '123456789',\n_10\n})\n`\n\nThe user receives an SMS with a 6-digit pin that you must [verify](#verifying-a-phone-otp) within 60 seconds.\nUse the <code>phone_change</code> type when calling <code>verifyOTP</code> to update a user\u2019s phone number.\n"
    }
  },
  {
    "chunk_id": "e86dd190-ee9b-4adf-9fb7-efa41a1c7531",
    "metadata": {
      "token_count": 103,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/flutter-auth-ui",
      "page_title": "Flutter Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Flutter Auth UI",
        "h2": "Add Flutter Auth UI \\#",
        "h3": ""
      },
      "text": "Auth\nFlutter Auth UI is a Flutter package containing pre-built widgets for authenticating users.\nIt is unstyled and can match your brand and aesthetic.\n\n![Flutter Auth UI](https://raw.githubusercontent.com/supabase-community/flutter-auth-ui/main/screenshots/supabase_auth_ui.png)\nAdd the latest version of the package [supabase-auth-ui](https://pub.dev/packages/supabase_auth_ui) to pubspec.yaml:\n\n`\n1\nflutter pub add supabase_auth_ui\n`\n"
    }
  },
  {
    "chunk_id": "d8d3362f-14bf-4dcf-a980-5ad543e71e5c",
    "metadata": {
      "token_count": 347,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/flutter-auth-ui",
      "page_title": "Flutter Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Flutter Auth UI",
        "h2": "Add Flutter Auth UI \\#",
        "h3": "Initialize the Flutter Auth package \\#"
      },
      "text": "abase_auth_ui.png)\nAdd the latest version of the package [supabase-auth-ui](https://pub.dev/packages/supabase_auth_ui) to pubspec.yaml:\n\n`\n1\nflutter pub add supabase_auth_ui\n`\n`\n1\nimport 'package:flutter/material.dart';\n2\nimport 'package:supabase_auth_ui/supabase_auth_ui.dart';\n3\n4\nvoid main() async {\n5\nawait Supabase.initialize(\n6\n    url: dotenv.get('SUPABASE_URL'),\n7\n    anonKey: dotenv.get('SUPABASE_ANON_KEY'),\n8\n);\n9\n10\nrunApp(const MyApp());\n11\n}\n`\nUse a SupaEmailAuth widget to create an email and password signin and signup form. It also contains a button to toggle to display a forgot password form.\n\nYou can pass metadataFields to add additional fields to the form to pass as metadata to Supabase.\n\n`\n1\nSupaEmailAuth(\n2\nredirectTo: kIsWeb ? null : 'io.mydomain.myapp://callback',\n3\nonSignInComplete: (response) {},\n4\nonSignUpComplete: (response) {},\n5\nmetadataFields: [\\\n6\\\n    MetaDataField(\\\n7\\\n    prefixIcon: const Icon(Icons.person),\\\n8\\\n    label: 'Username',\\\n9\\\n    key: 'username',\\\n10\\\n    validator: (val) {\\\n11\\\n            if (val == null || val.isEmpty) {\\\n12\\\n            return 'Please enter something';\\\n13\\\n            }\\\n14\\\n            return null;\\\n15\\\n          },\\\n16\\\n        ),\\\n17\\\n    ],\n18\n)\n`\n"
    }
  },
  {
    "chunk_id": "a82c07c5-5c72-4eb4-9a09-f673d8dc8f7f",
    "metadata": {
      "token_count": 172,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/flutter-auth-ui",
      "page_title": "Flutter Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Flutter Auth UI",
        "h2": "Add Flutter Auth UI \\#",
        "h3": "Magic link Auth \\#"
      },
      "text": "            if (val == null || val.isEmpty) {\\\n12\\\n            return 'Please enter something';\\\n13\\\n            }\\\n14\\\n            return null;\\\n15\\\n          },\\\n16\\\n        ),\\\n17\\\n    ],\n18\n)\n`\nUse SupaMagicAuth widget to create a magic link signIn form.\n\n`\n1\nSupaMagicAuth(\n2\nredirectUrl: kIsWeb ? null : 'io.mydomain.myapp://callback',\n3\nonSuccess: (Session response) {},\n4\nonError: (error) {},\n5\n)\n`\nUse SupaResetPassword to create a password reset form.\n\n`\n1\nSupaResetPassword(\n2\naccessToken: supabase.auth.currentSession?.accessToken,\n3\nonSuccess: (UserResponse response) {},\n4\nonError: (error) {},\n5\n)\n`\n"
    }
  },
  {
    "chunk_id": "01f83fe2-c923-4f27-b97f-4bd72f6ee166",
    "metadata": {
      "token_count": 217,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/flutter-auth-ui",
      "page_title": "Flutter Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Flutter Auth UI",
        "h2": "Add Flutter Auth UI \\#",
        "h3": "Phone Auth \\#"
      },
      "text": " a password reset form.\n\n`\n1\nSupaResetPassword(\n2\naccessToken: supabase.auth.currentSession?.accessToken,\n3\nonSuccess: (UserResponse response) {},\n4\nonError: (error) {},\n5\n)\n`\nUse SupaPhoneAuth to create a phone authentication form.\n\n`\n1\nSupaPhoneAuth(\n2\nauthAction: SupaAuthAction.signUp,\n3\nonSuccess: (AuthResponse response) {},\n4\n),\n`\nThe package supports login with [official social providers](../../auth#providers).\n\nUse SupaSocialsAuth to create list of social login buttons.\n\n`\n1\nSupaSocialsAuth(\n2\nsocialProviders: [\\\n3\\\n    OAuthProvider.apple,\\\n4\\\n    OAuthProvider.google,\\\n5\\\n],\n6\ncolored: true,\n7\nredirectUrl: kIsWeb\n8\n    ? null\n9\n    : 'io.mydomain.myapp://callback',\n10\nonSuccess: (Session response) {},\n11\nonError: (error) {},\n12\n)\n`\n"
    }
  },
  {
    "chunk_id": "c9656a92-eaec-4857-94a5-b4d0a82355e1",
    "metadata": {
      "token_count": 209,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers/flutter-auth-ui",
      "page_title": "Flutter Auth UI | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Flutter Auth UI",
        "h2": "Add Flutter Auth UI \\#",
        "h3": "Theming \\#"
      },
      "text": "\nredirectUrl: kIsWeb\n8\n    ? null\n9\n    : 'io.mydomain.myapp://callback',\n10\nonSuccess: (Session response) {},\n11\nonError: (error) {},\n12\n)\n`\nThis package uses plain Flutter components allowing you to control the appearance of the components using your own theme.\nYesNo\n\nThanks for your feedback!\n\n- [Add Flutter Auth UI](#add-flutter-auth-ui)\n- [Initialize the Flutter Auth package](#initialize-the-flutter-auth-package)\n- [Email Auth](#email-auth)\n- [Magic link Auth](#magic-link-auth)\n- [Reset password](#reset-password)\n- [Phone Auth](#phone-auth)\n- [Social Auth](#social-auth)\n- [Theming](#theming)\n\n1. We only collect analytics essential to ensuring smooth operation of our services. [Learn more](https://supabase.com/privacy)\n\n   AcceptOpt out[Learn more](https://supabase.com/privacy)\n"
    }
  },
  {
    "chunk_id": "864e8561-a07d-40be-be88-5cb91329f6bb",
    "metadata": {
      "token_count": 255,
      "source_url": "https://supabase.com/docs/guides/auth/server-side/migrating-to-ssr-from-auth-helpers",
      "page_title": "Migrating to the SSR package from Auth Helpers | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Migrating to the SSR package from Auth Helpers",
        "h2": "Next steps \\#",
        "h3": "Replacing Supabase packages \\#"
      },
      "text": "Auth\nThe new <code>ssr</code> package takes the core concepts of the Auth Helpers and makes them available to any server language or framework. This page will guide you through migrating from the Auth Helpers package to <code>ssr</code>.\nNext.jsSvelteKitRemix\n\n`\n_10\nnpm uninstall @supabase/auth-helpers-nextjs\n`\n\n`\n_10\nnpm install @supabase/ssr\n`\nThe new <code>ssr</code> package exports two functions for creating a Supabase client. The <code>createBrowserClient</code> function is used in the client, and the <code>createServerClient</code> function is used in the server.\n\nCheck out the [Creating a client](/docs/guides/auth/server-side/creating-a-client) page for examples of creating a client in your framework.\n- Implement [Authentication using Email and Password](/docs/guides/auth/server-side/email-based-auth-with-pkce-flow-for-ssr)\n- Implement [Authentication using OAuth](/docs/guides/auth/server-side/oauth-with-pkce-flow-for-ssr)\n- [Learn more about SSR](/docs/guides/auth/server-side-rendering)\n"
    }
  },
  {
    "chunk_id": "0a00c3ac-0dbd-4f8a-b3cd-992aa9af310a",
    "metadata": {
      "token_count": 220,
      "source_url": "https://supabase.com/docs/guides/auth/quickstarts/nextjs",
      "page_title": "Use Supabase Auth with Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Use Supabase Auth with Next.js",
        "h2": "Learn how to configure Supabase Auth for the Next.js App Router.",
        "h3": "Create a new Supabase project"
      },
      "text": "Auth\n1\nHead over to [database.new](https://database.new) and create a new Supabase project.\n\nYour new database has a table for storing your users. You can see that this table is currently empty by running some SQL in the [SQL Editor](https://supabase.com/dashboard/project/_/sql/new).\n\nSQL\\_EDITOR\n\n`\n_10\nselect * from auth.users;\n`\n\n2\nUse the <code>create-next-app</code> command and the <code>with-supabase</code> template, to create a Next.js app pre-configured with:\n\n- [Cookie-based Auth](https://supabase.com/docs/guides/auth/auth-helpers/nextjs)\n- [TypeScript](https://www.typescriptlang.org/)\n- [Tailwind CSS](https://tailwindcss.com/)\n\n[See GitHub repo](https://github.com/vercel/next.js/tree/canary/examples/with-supabase)\n\nTerminal\n\n`\n_10\nnpx create-next-app -e with-supabase\n`\n\n3\n"
    }
  },
  {
    "chunk_id": "1565b2b3-cb96-40cb-9cea-9e202a75130c",
    "metadata": {
      "token_count": 253,
      "source_url": "https://supabase.com/docs/guides/auth/quickstarts/nextjs",
      "page_title": "Use Supabase Auth with Next.js | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Use Supabase Auth with Next.js",
        "h2": "Learn how to configure Supabase Auth for the Next.js App Router.",
        "h3": "Declare Supabase Environment Variables"
      },
      "text": ".com/)\n\n[See GitHub repo](https://github.com/vercel/next.js/tree/canary/examples/with-supabase)\n\nTerminal\n\n`\n_10\nnpx create-next-app -e with-supabase\n`\n\n3\nRename <code>.env.local.example</code> to <code>.env.local</code> and populate with [your project's URL and Anon Key](https://supabase.com/dashboard/project/_/settings/api).\n\n.env.local\n\n`\n_10\nNEXT_PUBLIC_SUPABASE_URL=your-project-url\n_10\nNEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key\n`\n\n4\nStart the development server, go to [http://localhost:3000](http://localhost:3000) in a browser, and you should see the contents of <code>app/page.tsx</code>.\n\nTo Sign Up a new user, navigate to [http://localhost:3000/login](http://localhost:3000/login), and click <code>Sign Up Now</code>.\n\nCheck out the [Supabase Auth docs](https://supabase.com/docs/guides/auth#authentication) for more authentication methods.\n\nTerminal\n\n`\n_10\nnpm run dev\n`\n"
    }
  },
  {
    "chunk_id": "e58ab98f-51cc-472d-8933-08432f7e2d58",
    "metadata": {
      "token_count": 240,
      "source_url": "https://supabase.com/docs/guides/auth/password-security",
      "page_title": "Password security | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password security",
        "h2": "Help your users to protect their password security",
        "h3": ""
      },
      "text": "Auth\nA password is more secure if it is harder to guess or brute-force. In theory, a password is harder to guess if it is longer. It is also harder to guess if it uses a larger set of characters (for example, digits, lowercase and uppercase letters, and symbols).\n\nThis table shows the _minimum_ number of guesses that need to be tried to access a user's account:\n\n| Required characters | Length | Guesses |\n| --- | --- | --- |\n| Digits only | 8 | ~ 227 |\n| Digits and letters | 8 | ~ 241 |\n| Digits, lower and uppercase letters | 8 | ~ 248 |\n| Digits, lower and uppercase letters, symbols | 8 | ~ 252 |\n\nIn reality though, passwords are not always generated at random. They often contain variations of names, words, dates, and common phrases. Malicious actors can use these properties to guess a password in fewer attempts.\n\nThere are hundreds of millions (and growing!) known passwords out there. Malicious actors can use these lists of leaked passwords to automate login attempts (known as credential stuffing) and steal or access sensitive user data.\n"
    }
  },
  {
    "chunk_id": "4b7a3f9c-1744-44e8-b521-62de31f92c8f",
    "metadata": {
      "token_count": 205,
      "source_url": "https://supabase.com/docs/guides/auth/password-security",
      "page_title": "Password security | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password security",
        "h2": "Password strength and leaked password protection \\#",
        "h3": ""
      },
      "text": " to guess a password in fewer attempts.\n\nThere are hundreds of millions (and growing!) known passwords out there. Malicious actors can use these lists of leaked passwords to automate login attempts (known as credential stuffing) and steal or access sensitive user data.\nTo help protect your users, Supabase Auth allows you fine-grained control over the strength of the passwords used on your project. You can configure these in your project's [Auth settings](/dashboard/project/_/settings/auth):\n\n- Set a large minimum password length. Anything less than 8 characters is not recommended.\n- Set the required characters that must appear at least once in a user's password. Use the strongest option of requiring digits, lowercase and uppercase letters, and symbols.\n- Prevent the use of leaked passwords. Supabase Auth uses the open-source [HaveIBeenPwned.org Pwned Passwords API](https://haveibeenpwned.com/Passwords) to reject passwords that have been leaked and are known by malicious actors.\n"
    }
  },
  {
    "chunk_id": "8e909700-7b71-4c00-8de5-9e9716fe2c85",
    "metadata": {
      "token_count": 324,
      "source_url": "https://supabase.com/docs/guides/auth/password-security",
      "page_title": "Password security | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Password security",
        "h2": "Additional recommendations \\#",
        "h3": "How are passwords stored? \\#"
      },
      "text": ". Supabase Auth uses the open-source [HaveIBeenPwned.org Pwned Passwords API](https://haveibeenpwned.com/Passwords) to reject passwords that have been leaked and are known by malicious actors.\nIn addition to choosing suitable password strength settings and preventing the use of leaked passwords, consider asking your users to:\n\n- Use a password manager to store and generate passwords.\n- Avoid password reuse across websites and apps.\n- Avoid using personal information in passwords.\n- Use [Multi-Factor Authentication](/docs/guides/auth/auth-mfa).\nSupabase Auth uses [bcrypt](https://en.wikipedia.org/wiki/Bcrypt), a strong password hashing function, to store hashes of users' passwords. Only hashed passwords are stored. You cannot impersonate a user with the password hash. Each hash is accompanied by a randomly generated salt parameter for extra security.\n\nThe hash is stored in the <code>encrypted_password</code> column of the <code>auth.users</code> table. The column's name is a misnomer (cryptographic hashing is not encryption), but is kept for backward compatibility.\nExisting users can still sign in with their current password even if it doesn't meet the new, strengthened password requirements. However, if their password falls short of these updated standards, they will encounter a <code>WeakPasswordError</code> during the <code>signInWithPassword</code> process, explaining why it's considered weak. This change is also applicable to new users and existing users changing their passwords, ensuring everyone adheres to the enhanced security standards.\n"
    }
  },
  {
    "chunk_id": "bb948ecc-02ec-41e4-8f57-c8c7a46eab8f",
    "metadata": {
      "token_count": 254,
      "source_url": "https://supabase.com/docs/guides/auth/social-login",
      "page_title": "Social Login | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Social Login",
        "h2": "Benefits \\#",
        "h3": ""
      },
      "text": "Auth\nSocial Login (OAuth) is an open standard for authentication that allows users to log in to one website or application using their credentials from another website or application. OAuth allows users to grant third-party applications access to their online accounts without sharing their passwords.\nOAuth is commonly used for things like logging in to a social media account from a third-party app. It is a secure and convenient way to authenticate users and share information between applications.\nThere are several reasons why you might want to add social login to your applications:\n\n- **Improved user experience**: Users can register and log in to your application using their existing social media accounts, which can be faster and more convenient than creating a new account from scratch. This makes it easier for users to access your application, improving their overall experience.\n\n- **Better user engagement**: You can access additional data and insights about your users, such as their interests, demographics, and social connections. This can help you tailor your content and marketing efforts to better engage with your users and provide a more personalized experience.\n\n- **Increased security**: Social login can improve the security of your application by leveraging the security measures and authentication protocols of the social media platforms that your users are logging in with. This can help protect against unauthorized access and account takeovers.\n"
    }
  },
  {
    "chunk_id": "82e248c0-f1f0-4d0a-ae46-a1a930731a5d",
    "metadata": {
      "token_count": 840,
      "source_url": "https://supabase.com/docs/guides/auth/social-login",
      "page_title": "Social Login | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Social Login",
        "h2": "Set up a social provider with Supabase Auth \\#",
        "h3": ""
      },
      "text": " personalized experience.\n\n- **Increased security**: Social login can improve the security of your application by leveraging the security measures and authentication protocols of the social media platforms that your users are logging in with. This can help protect against unauthorized access and account takeovers.\nSupabase supports a suite of social providers. Follow these guides to configure a social provider for your platform.\n\n[![Google Icon](https://supabase.com/docs/img/icons/google-icon.svg)\\\\\n\\\\\n**Google**](/docs/guides/auth/social-login/auth-google) [![Facebook Icon](https://supabase.com/docs/img/icons/facebook-icon.svg)\\\\\n\\\\\n**Facebook**](/docs/guides/auth/social-login/auth-facebook) [![Apple Icon](https://supabase.com/docs/img/icons/apple-icon.svg)\\\\\n\\\\\n**Apple**](/docs/guides/auth/social-login/auth-apple) [![Azure (Microsoft) Icon](https://supabase.com/docs/guides/auth/Microsoft)\\\\\n\\\\\n**Azure (Microsoft)**](/docs/guides/auth/social-login/auth-azure) [![Twitter Icon](https://supabase.com/docs/img/icons/twitter-icon-light.svg)\\\\\n\\\\\n**Twitter**](/docs/guides/auth/social-login/auth-twitter) [![GitHub Icon](https://supabase.com/docs/img/icons/github-icon-light.svg)\\\\\n\\\\\n**GitHub**](/docs/guides/auth/social-login/auth-github) [![Gitlab Icon](https://supabase.com/docs/img/icons/gitlab-icon.svg)\\\\\n\\\\\n**Gitlab**](/docs/guides/auth/social-login/auth-gitlab) [![Bitbucket Icon](https://supabase.com/docs/img/icons/bitbucket-icon.svg)\\\\\n\\\\\n**Bitbucket**](/docs/guides/auth/social-login/auth-bitbucket) [![Discord Icon](https://supabase.com/docs/img/icons/discord-icon.svg)\\\\\n\\\\\n**Discord**](/docs/guides/auth/social-login/auth-discord) [![Figma Icon](https://supabase.com/docs/img/icons/figma-icon.svg)\\\\\n\\\\\n**Figma**](/docs/guides/auth/social-login/auth-figma) [![Kakao Icon](https://supabase.com/docs/img/icons/kakao-icon.svg)\\\\\n\\\\\n**Kakao**](/docs/guides/auth/social-login/auth-kakao) [![Keycloak Icon](https://supabase.com/docs/img/icons/keycloak-icon.svg)\\\\\n\\\\\n**Keycloak**](/docs/guides/auth/social-login/auth-keycloak) [![LinkedIn Icon](https://supabase.com/docs/img/icons/linkedin-icon.svg)\\\\\n\\\\\n**LinkedIn**](/docs/guides/auth/social-login/auth-linkedin) [![Notion Icon](https://supabase.com/docs/img/icons/notion-icon.svg)\\\\\n\\\\\n**Notion**](/docs/guides/auth/social-login/auth-notion) [![Slack Icon](https://supabase.com/docs/img/icons/slack-icon.svg)\\\\\n\\\\\n**Slack**](/docs/guides/auth/social-login/auth-slack) [![Spotify Icon](https://supabase.com/docs/img/icons/spotify-icon.svg)\\\\\n\\\\\n**Spotify**](/docs/guides/auth/social-login/auth-spotify) [![Twitch Icon](https://supabase.com/docs/img/icons/twitch-icon.svg)\\\\\n\\\\\n**Twitch**](/docs/guides/auth/social-login/auth-twitch) [![WorkOS Icon](https://supabase.com/docs/img/icons/workos-icon.svg)\\\\\n\\\\\n**WorkOS**](/docs/guides/auth/social-login/auth-workos) [![Zoom Icon](https://supabase.com/docs/img/icons/zoom-icon.svg)\\\\\n\\\\\n**Zoom**](/docs/guides/auth/social-login/auth-zoom)\n"
    }
  },
  {
    "chunk_id": "2ac3b90d-3452-4dfd-a607-a57a4bd2d0aa",
    "metadata": {
      "token_count": 252,
      "source_url": "https://supabase.com/docs/guides/auth/social-login",
      "page_title": "Social Login | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Social Login",
        "h2": "Provider tokens \\#",
        "h3": ""
      },
      "text": "docs/guides/auth/social-login/auth-workos) [![Zoom Icon](https://supabase.com/docs/img/icons/zoom-icon.svg)\\\\\n\\\\\n**Zoom**](/docs/guides/auth/social-login/auth-zoom)\nYou can use the provider token and provider refresh token returned to make API calls to the OAuth provider. For example, you can use the Google provider token to access Google APIs on behalf of your user.\n\nSupabase Auth does not manage refreshing the provider token for the user. Your application will need to use the provider refresh token to obtain a new provider token. If no provider refresh token is returned, then it could mean one of the following:\n\n- The OAuth provider does not return a refresh token\n- Additional scopes need to be specified in order for the OAuth provider to return a refresh token.\n\nProvider tokens are intentionally not stored in your project's database. This is because provider tokens give access to potentially sensitive user data in third-party systems. Different applications have different needs, and one application's OAuth scopes may be significantly more permissive than another. If you want to use the provider token outside of the browser that completed the OAuth flow, it is recommended to send it to a trusted and secure server you control.\n"
    }
  },
  {
    "chunk_id": "2f39e75e-fa05-4ce9-bc14-3497d21d68cd",
    "metadata": {
      "token_count": 259,
      "source_url": "https://supabase.com/docs/guides/auth/auth-captcha",
      "page_title": "Enable Captcha Protection | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Enable Captcha Protection",
        "h2": "Sign up for Captcha \\#",
        "h3": ""
      },
      "text": "Auth\nSupabase provides you with the option of adding captcha to your sign-in, sign-up, and password reset forms. This keeps your website safe from bots and malicious scripts. Supabase authentication has support for [hCaptcha](https://www.hcaptcha.com/) and [Cloudflare Turnstile](https://www.cloudflare.com/products/turnstile/).\nHCaptchaTurnstile\n\nGo to the [hCaptcha](https://www.hcaptcha.com/) website and sign up for an account. On the Welcome page, copy the **Sitekey** and **Secret key**.\n\nIf you have already signed up and didn't copy this information from the Welcome page, you can get the **Secret key** from the Settings page.\n\n![site_secret_settings.png](https://supabase.com/docs/img/guides/auth-captcha/site_secret_settings.png)\n\nThe **Sitekey** can be found in the **Settings** of the active site you created.\n\n![sites_dashboard.png](https://supabase.com/docs/img/guides/auth-captcha/sites_dashboard.png)\n\nIn the Settings page, look for the **Sitekey** section and copy the key.\n\n![sitekey_settings.png](https://supabase.com/docs/img/guides/auth-captcha/sitekey_settings.png)\n"
    }
  },
  {
    "chunk_id": "f9655bd6-d17b-4870-9936-7912ce224e8d",
    "metadata": {
      "token_count": 696,
      "source_url": "https://supabase.com/docs/guides/auth/auth-captcha",
      "page_title": "Enable Captcha Protection | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Enable Captcha Protection",
        "h2": "Enable Captcha protection for your Supabase project \\#",
        "h3": ""
      },
      "text": "/auth-captcha/sites_dashboard.png)\n\nIn the Settings page, look for the **Sitekey** section and copy the key.\n\n![sitekey_settings.png](https://supabase.com/docs/img/guides/auth-captcha/sitekey_settings.png)\nNavigate to the **[Auth](https://supabase.com/dashboard/project/_/settings/auth)** section of your Project Settings in the Supabase Dashboard and find the **Enable Captcha protection** toggle under Settings > Authentication > Bot and Abuse Protection > Enable Captcha protection.\n\nSelect your CAPTCHA provider from the dropdown, enter your Captcha **Secret key**, and click **Save**.\nThe frontend requires some changes to provide the captcha on-screen for the user. This example uses React and the corresponding Captcha React component, but both Captcha providers can be used with any JavaScript framework.\n\nHCaptchaTurnstile\n\nInstall <code>@hcaptcha/react-hcaptcha</code> in your project as a dependency.\n\n`\n_10\nnpm install @hcaptcha/react-hcaptcha\n`\n\nNow import the <code>HCaptcha</code> component from the <code>@hcaptcha/react-hcaptcha</code> library.\n\n`\n_10\nimport HCaptcha from '@hcaptcha/react-hcaptcha'\n`\n\nLet's create a empty state to store our <code>captchaToken</code>\n\n`\n_10\nconst [captchaToken, setCaptchaToken] = useState()\n`\n\nNow lets add the HCaptcha component to the JSX section of our code\n\n`\n_10\n<HCaptcha />\n`\n\nWe will pass it the sitekey we copied from the hCaptcha website as a property along with a onVerify property which takes a callback function. This callback function will have a token as one of its properties. Let's set the token in the state using <code>setCaptchaToken</code>\n\n`\n_10\n<HCaptcha\n_10\nsitekey=\"your-sitekey\"\n_10\nonVerify={(token) => {\n_10\n    setCaptchaToken(token)\n_10\n}}\n_10\n/>\n`\n\nNow lets use the captcha token we receive in our Supabase signUp function.\n\n`\n_10\nawait supabase.auth.signUp({\n_10\nemail,\n_10\npassword,\n_10\noptions: { captchaToken },\n_10\n})\n`\n\nWe will also need to reset the captcha challenge after we have made a call to the function above.\n\nCreate a ref to use on our HCaptcha component.\n\n`\n_10\nconst captcha = useRef()\n`\n\nLet's add a ref attribute on the <code>HCaptcha</code> component and assign the <code>captcha</code> constant to it.\n\n`\n_10\n<HCaptcha\n_10\nref={captcha}\n_10\nsitekey=\"your-sitekey\"\n_10\nonVerify={(token) => {\n_10\n    setCaptchaToken(token)\n_10\n}}\n_10\n/>\n`\n\nReset the <code>captcha</code> after the signUp function is called using the following code:\n\n`\n_10\ncaptcha.current.resetCaptcha()\n`\n\nIn order to test that this works locally we will need to use something like [ngrok](https://ngrok.com/) or add an entry to your hosts file. You can read more about this in the [hCaptcha docs](https://docs.hcaptcha.com/#local-development).\n\nRun the application and you should now be provided with a captcha challenge.\n"
    }
  },
  {
    "chunk_id": "699ce4f1-3a5d-473f-8c9f-85d62d60da3c",
    "metadata": {
      "token_count": 104,
      "source_url": "https://supabase.com/docs/guides/auth/architecture",
      "page_title": "Auth architecture | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth architecture",
        "h2": "The architecture behind Supabase Auth.",
        "h3": ""
      },
      "text": "Auth\nThere are four major layers to Supabase Auth:\n\n1. [Client layer.](#client-layer) This can be one of the Supabase client SDKs, or manually made HTTP requests using the HTTP client of your choice.\n2. Kong API gateway. This is shared between all Supabase products.\n3. [Auth service](#auth-service) (formerly known as GoTrue).\n4. [Postgres database.](#postgres) This is shared between all Supabase products.\n"
    }
  },
  {
    "chunk_id": "1c0e4c60-f942-45cc-8c07-5228c48f3ffc",
    "metadata": {
      "token_count": 264,
      "source_url": "https://supabase.com/docs/guides/auth/architecture",
      "page_title": "Auth architecture | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth architecture",
        "h2": "Client layer \\#",
        "h3": ""
      },
      "text": " gateway. This is shared between all Supabase products.\n3. [Auth service](#auth-service) (formerly known as GoTrue).\n4. [Postgres database.](#postgres) This is shared between all Supabase products.\nThe client layer runs in your app. This could be running in many places, including:\n\n- Your frontend browser code\n- Your backend server code\n- Your native application\n\nThe client layer provides the functions that you use to sign in and manage users. We recommend using the Supabase client SDKs, which handle:\n\n- Configuration and authentication of HTTP calls to the Supabase Auth backend\n- Persistence, refresh, and removal of Auth Tokens in your app's storage medium\n- Integration with other Supabase products\n\nBut at its core, this layer manages the making of HTTP calls, so you could write your own client layer if you wanted to.\n\nSee the Client SDKs for more information:\n\n- [JavaScript](/docs/reference/javascript/introduction)\n- [Flutter](/docs/reference/dart/introduction)\n- [Swift](/docs/reference/swift/introduction)\n- [Python](/docs/reference/python/introduction)\n- [C#](/docs/reference/csharp/introduction)\n- [Kotlin](/docs/reference/kotlin/introduction)\n"
    }
  },
  {
    "chunk_id": "278f73ba-c440-41df-846e-93f06d01360d",
    "metadata": {
      "token_count": 171,
      "source_url": "https://supabase.com/docs/guides/auth/architecture",
      "page_title": "Auth architecture | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth architecture",
        "h2": "Auth service \\#",
        "h3": ""
      },
      "text": ")\n- [Swift](/docs/reference/swift/introduction)\n- [Python](/docs/reference/python/introduction)\n- [C#](/docs/reference/csharp/introduction)\n- [Kotlin](/docs/reference/kotlin/introduction)\nThe [Auth service](https://github.com/supabase/auth) is an Auth API server written and maintained by Supabase. It is a fork of the GoTrue project, originally created by Netlify.\n\nWhen you deploy a new Supabase project, we deploy an instance of this server alongside your database, and inject your database with the required Auth schema.\n\nThe Auth service is responsible for:\n\n- Validating, issuing, and refreshing JWTs\n- Serving as the intermediary between your app and Auth information in the database\n- Communicating with external providers for Social Login and SSO\n"
    }
  },
  {
    "chunk_id": "d5f1df20-6a12-4f69-b843-e7b771b89375",
    "metadata": {
      "token_count": 260,
      "source_url": "https://supabase.com/docs/guides/auth/architecture",
      "page_title": "Auth architecture | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth architecture",
        "h2": "Postgres \\#",
        "h3": ""
      },
      "text": " required Auth schema.\n\nThe Auth service is responsible for:\n\n- Validating, issuing, and refreshing JWTs\n- Serving as the intermediary between your app and Auth information in the database\n- Communicating with external providers for Social Login and SSO\nSupabase Auth uses the <code>auth</code> schema in your Postgres database to store user tables and other information. For security, this schema is not exposed on the auto-generated API.\n\nYou can connect Auth information to your own objects using [database triggers](/docs/guides/database/postgres/triggers) and [foreign keys](https://www.postgresql.org/docs/current/tutorial-fk.html). Make sure that any views you create for Auth data are adequately protected by [enabling RLS](/docs/guides/database/postgres/row-level-security) or [revoking grants](https://www.postgresql.org/docs/current/sql-revoke.html).\n\nMake sure any views you create for Auth data are protected.\n\nStarting in Postgres version 15, views inherit the RLS policies of the underlying tables if created with <code>security_invoker</code>. Views in earlier versions, or those created without <code>security_invoker</code>, inherit the permissions of the owner, who can bypass RLS policies.\n"
    }
  },
  {
    "chunk_id": "eceaf9a7-a058-4151-b9df-c227efd8cb65",
    "metadata": {
      "token_count": 363,
      "source_url": "https://supabase.com/docs/guides/auth/identities",
      "page_title": "Identities | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Identities",
        "h2": "The user identity object \\#",
        "h3": ""
      },
      "text": "Auth\nAn identity is an authentication method associated with a user. Supabase Auth supports the following types of identity:\n\n- Email\n- Phone\n- OAuth\n- SAML\n\nA user can have more than one identity. Anonymous users have no identity until they link an identity to their user.\nThe user identity object contains the following attributes:\n\n| Attributes | Type | Description |\n| --- | --- | --- |\n| provider\\_id | <code>string</code> | The provider id returned by the provider. If the provider is an OAuth provider, the id refers to the user's account with the OAuth provider. If the provider is <code>email</code> or <code>phone</code>, the id is the user's id from the <code>auth.users</code> table. |\n| user\\_id | <code>string</code> | The user's id that the identity is linked to. |\n| identity\\_data | <code>object</code> | The identity metadata. For OAuth and SAML identities, this contains information about the user from the provider. |\n| id | <code>string</code> | The unique id of the identity. |\n| provider | <code>string</code> | The provider name. |\n| email | <code>string</code> | The email is a generated column that references the optional email property in the identity\\_data |\n| created\\_at | <code>string</code> | The timestamp that the identity was created. |\n| last\\_sign\\_in\\_at | <code>string</code> | The timestamp that the identity was last used to sign in. |\n| updated\\_at | <code>string</code> | The timestamp that the identity was last updated. |\n"
    }
  },
  {
    "chunk_id": "e407d4d5-6a3c-4041-a976-d620e3f8f8d6",
    "metadata": {
      "token_count": 152,
      "source_url": "https://supabase.com/docs/guides/auth/auth-smtp",
      "page_title": "Configure a Custom SMTP | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Configure a Custom SMTP",
        "h2": "Auth SMTP \\#",
        "h3": ""
      },
      "text": "Auth\nAt present, you can trial the Supabase platform by sending up to **3** emails per hour via the built-in service. The default email service as a whole is offered on a best effort basis: we will do our best to maintain it and will review usage of the service on a regular basis to see if the email service should be continued.\n\nAs you progress toward production, you may find yourself wanting for a custom SMTP service in order to increase your limits. A custom SMTP server will allow you to set your own cap on the number of emails sent per hour.\n\nBeyond rate limits, an SMTP server might also help with:\n\n- Deliverability and Reputation Management\n- Scalability\n- Analytics and Tracking\n- Compliance and Anti Spam measures\n"
    }
  },
  {
    "chunk_id": "fb56d598-c4b1-4ff0-8809-b1b9c112a396",
    "metadata": {
      "token_count": 257,
      "source_url": "https://supabase.com/docs/guides/auth/auth-smtp",
      "page_title": "Configure a Custom SMTP | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Configure a Custom SMTP",
        "h2": "How to set up SMTP \\#",
        "h3": "SMTP providers \\#"
      },
      "text": " you to set your own cap on the number of emails sent per hour.\n\nBeyond rate limits, an SMTP server might also help with:\n\n- Deliverability and Reputation Management\n- Scalability\n- Analytics and Tracking\n- Compliance and Anti Spam measures\nHead over to [Auth Settings Page](https://supabase.com/dashboard/project/_/settings/auth) and hit \"Enable Custom SMTP\" under the SMTP Provider section.\n\nFill in fields below with the relevant details obtained from your custom SMTP provider:\n\n![SMTP settings](https://supabase.com/docs/img/guides/auth-smtp/smtp.png)\nAfter adding a custom SMTP provider, you can head over to [Auth > Rate Limits](https://supabase.com/dashboard/project/_/auth/rate-limits) to configure the rate limits for sending emails.\nYou can use Supabase Auth with any major SMTP provider of your choosing. Some SMTP providers you could consider using are:\n\n- [Twilio SendGrid](https://docs.sendgrid.com/for-developers/sending-email/integrating-with-the-smtp-api)\n- [AWS SES](https://docs.aws.amazon.com/ses/latest/dg/send-email-smtp.html)\n- [Resend](https://resend.com/docs/dashboard/emails/introduction)\n"
    }
  },
  {
    "chunk_id": "0e32928f-fb25-4455-8c32-668799786136",
    "metadata": {
      "token_count": 43,
      "source_url": "https://supabase.com/docs/guides/auth/enterprise-sso",
      "page_title": "Enterprise Single Sign-On | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Enterprise Single Sign-On",
        "h2": "",
        "h3": ""
      },
      "text": "Auth\nSupabase Auth supports building enterprise applications that require Single Sign-On (SSO) authentication [with SAML 2.0](/docs/guides/auth/sso/auth-sso-saml).\n"
    }
  },
  {
    "chunk_id": "2de0a3df-3a08-440f-a331-a792404b3d2e",
    "metadata": {
      "token_count": 275,
      "source_url": "https://supabase.com/docs/guides/auth/general-configuration",
      "page_title": "General configuration | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "General configuration",
        "h2": "General configuration options for Supabase Auth",
        "h3": ""
      },
      "text": "Auth\nThis section covers the [general configuration options](/dashboard/project/_/settings/auth) for Supabase Auth. If you are looking for another type of configuration, you may be interested in one of the following sections:\n\n- [Provider-specific configuration](/dashboard/project/_/auth/providers)\n- [Rate limits](/dashboard/project/_/auth/rate-limits)\n- [Email Templates](/dashboard/project/_/auth/templates)\n- [Redirect URLs](/dashboard/project/_/auth/url-configuration)\n- [Auth Hooks](/dashboard/project/_/auth/hooks)\n\nSupabase Auth provides these [general configuration options](/dashboard/project/_/settings/auth) to control user access to your application:\n\n- **Allow new users to sign up**: Users will be able to sign up. If this config is disabled, only existing users can sign in.\n\n- **Confirm Email**: Users will need to confirm their email address before signing in for the first time.\n  - Having **Confirm Email** disabled assumes that the user's email does not need to be verified in order to login and implicitly confirms the user's email in the database.\n  - This option can be found in the email provider under the provider-specific configuration.\n- **Allow anonymous sign-ins**: Allow anonymous users to be created.\n\n- **Allow manual linking**: Allow users to link their accounts manually.\n"
    }
  },
  {
    "chunk_id": "2e6dadff-5ae5-4850-8370-2eadfa15928d",
    "metadata": {
      "token_count": 558,
      "source_url": "https://supabase.com/docs/guides/auth/managing-user-data",
      "page_title": "User Management | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User Management",
        "h2": "View, delete, and export user information.",
        "h3": ""
      },
      "text": "Auth\nYou can view your users on the [Users page](/dashboard/project/_/auth/users) of the Dashboard. You can also view the contents of the Auth schema in the [Table Editor](/dashboard/project/_/editor).\nFor security, the Auth schema is not exposed in the auto-generated API. If you want to access users data via the API, you can create your own user tables in the <code>public</code> schema.\n\nMake sure to protect the table by enabling [Row Level Security](/docs/guides/database/postgres/row-level-security). Reference the <code>auth.users</code> table to ensure data integrity. Specify <code>on delete cascade</code> in the reference. For example, a <code>public.profiles</code> table might look like this:\n\n`\n_10\ncreate table public.profiles (\n_10\nid uuid not null references auth.users on delete cascade,\n_10\nfirst_name text,\n_10\nlast_name text,\n_10\n_10\nprimary key (id)\n_10\n);\n_10\n_10\nalter table public.profiles enable row level security;\n`\n\nOnly use primary keys as [foreign key references](https://www.postgresql.org/docs/current/tutorial-fk.html) for schemas and tables like <code>auth.users</code> which are managed by Supabase. PostgreSQL lets you specify a foreign key reference for columns backed by a unique index (not necessarily primary keys).\n\nPrimary keys are **guaranteed not to change**. Columns, indices, constraints or other database objects managed by Supabase **may change at any time** and you should be careful when referencing them directly.\n\nTo update your <code>public.profiles</code> table every time a user signs up, set up a trigger. If the trigger fails, it could block signups, so test your code thoroughly.\n\n`\n_17\n-- inserts a row into public.profiles\n_17\ncreate function public.handle_new_user()\n_17\nreturns trigger\n_17\nlanguage plpgsql\n_17\nsecurity definer set search_path = ''\n_17\nas $$\n_17\nbegin\n_17\ninsert into public.profiles (id, first_name, last_name)\n_17\nvalues (new.id, new.raw_user_meta_data ->> 'first_name', new.raw_user_meta_data ->> 'last_name');\n_17\nreturn new;\n_17\nend;\n_17\n$$;\n_17\n_17\n-- trigger the function every time a user is created\n_17\ncreate trigger on_auth_user_created\n_17\nafter insert on auth.users\n_17\nfor each row execute procedure public.handle_new_user();\n`\n"
    }
  },
  {
    "chunk_id": "f554deda-5119-4669-85f1-53d201ae3eaa",
    "metadata": {
      "token_count": 229,
      "source_url": "https://supabase.com/docs/guides/auth/managing-user-data",
      "page_title": "User Management | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User Management",
        "h2": "Adding and retrieving user metadata \\#",
        "h3": ""
      },
      "text": "_17\n_17\n-- trigger the function every time a user is created\n_17\ncreate trigger on_auth_user_created\n_17\nafter insert on auth.users\n_17\nfor each row execute procedure public.handle_new_user();\n`\nYou can assign metadata to users on sign up:\n\nJavaScriptDartSwiftKotlin\n\n`\n_10\nconst { data, error } = await supabase.auth.signUp({\n_10\nemail: 'example@email.com',\n_10\npassword: 'example-password',\n_10\noptions: {\n_10\n    data: {\n_10\n      first_name: 'John',\n_10\n      age: 27,\n_10\n    },\n_10\n},\n_10\n})\n`\n\nUser metadata is stored on the <code>raw_user_meta_data</code> column of the <code>auth.users</code> table. To view the metadata:\n\nJavaScriptDartSwiftKotlin\n\n`\n_10\nconst {\n_10\ndata: { user },\n_10\n} = await supabase.auth.getUser()\n_10\nlet metadata = user.user_metadata\n`\n"
    }
  },
  {
    "chunk_id": "559fff5e-ca3f-4b63-9335-31f9e2715247",
    "metadata": {
      "token_count": 271,
      "source_url": "https://supabase.com/docs/guides/auth/managing-user-data",
      "page_title": "User Management | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "User Management",
        "h2": "Deleting users \\#",
        "h3": ""
      },
      "text": ". To view the metadata:\n\nJavaScriptDartSwiftKotlin\n\n`\n_10\nconst {\n_10\ndata: { user },\n_10\n} = await supabase.auth.getUser()\n_10\nlet metadata = user.user_metadata\n`\nYou may delete users directly or via the management console at Authentication > Users. Note that deleting a user from the <code>auth.users</code> table does not automatically sign out a user. As Supabase makes use of JSON Web Tokens (JWT), a user's JWT will remain \"valid\" until it has expired. Should you wish to immediately revoke access for a user, do consider making use of a Row Level Security policy as described below.\n\nYou cannot delete a user if they are the owner of any objects in Supabase Storage.\n\nYou will encounter an error when you try to delete an Auth user that owns any Storage objects. If this happens, try deleting all the objects for that user, or reassign ownership to another user.\nAs Supabase is built on top of Postgres, you can query the <code>auth.users</code> and <code>auth.identities</code> table via the <code>SQL Editor</code> tab to extract all users:\n\n`\n_10\nselect * from auth.users;\n`\n\nYou can then export the results as CSV.\n"
    }
  },
  {
    "chunk_id": "d54ff64d-dde0-49d6-b2d1-5d975f65ab11",
    "metadata": {
      "token_count": 971,
      "source_url": "https://supabase.com/docs/guides/auth/native-mobile-deep-linking",
      "page_title": "Native Mobile Deep Linking | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Native Mobile Deep Linking",
        "h2": "Set up Deep Linking for mobile applications.",
        "h3": ""
      },
      "text": "Auth\nMany Auth methods involve a redirect to your app. For example:\n\n- Signup confirmation emails, Magic Link signins, and password reset emails contain a link that redirects to your app.\n- In OAuth signins, an automatic redirect occurs to your app.\n\nWith Deep Linking, you can configure this redirect to open a specific page. This is necessary if, for example, you need to display a form for password reset, or to manually exchange a token hash.\nExpo React NativeFlutterSwiftAndroid Kotlin\n\nTo link to your development build or standalone app, you need to specify a custom URL scheme for your app. You can register a scheme in your app config (app.json, app.config.js) by adding a string under the <code>scheme</code> key:\n\n`\n_10\n{\n_10\n\"expo\": {\n_10\n    \"scheme\": \"com.supabase\"\n_10\n}\n_10\n}\n`\n\nIn your project's [auth settings](https://supabase.com/dashboard/project/_/auth/url-configuration) add the redirect URL, e.g. <code>com.supabase://**</code>.\n\nFinally, implement the OAuth and linking handlers. See the [supabase-js reference](/docs/reference/javascript/initializing?example=react-native-options-async-storage) for instructions on initializing the supabase-js client in React Native.\n\n./components/Auth.tsx\n\n`\n_71\nimport { Button } from \"react-native\";\n_71\nimport { makeRedirectUri } from \"expo-auth-session\";\n_71\nimport * as QueryParams from \"expo-auth-session/build/QueryParams\";\n_71\nimport * as WebBrowser from \"expo-web-browser\";\n_71\nimport * as Linking from \"expo-linking\";\n_71\nimport { supabase } from \"app/utils/supabase\";\n_71\n_71\nWebBrowser.maybeCompleteAuthSession(); // required for web only\n_71\nconst redirectTo = makeRedirectUri();\n_71\n_71\nconst createSessionFromUrl = async (url: string) => {\n_71\nconst { params, errorCode } = QueryParams.getQueryParams(url);\n_71\n_71\nif (errorCode) throw new Error(errorCode);\n_71\nconst { access_token, refresh_token } = params;\n_71\n_71\nif (!access_token) return;\n_71\n_71\nconst { data, error } = await supabase.auth.setSession({\n_71\n    access_token,\n_71\n    refresh_token,\n_71\n});\n_71\nif (error) throw error;\n_71\nreturn data.session;\n_71\n};\n_71\n_71\nconst performOAuth = async () => {\n_71\nconst { data, error } = await supabase.auth.signInWithOAuth({\n_71\n    provider: \"github\",\n_71\n    options: {\n_71\n      redirectTo,\n_71\n      skipBrowserRedirect: true,\n_71\n    },\n_71\n});\n_71\nif (error) throw error;\n_71\n_71\nconst res = await WebBrowser.openAuthSessionAsync(\n_71\n    data?.url ?? \"\",\n_71\n    redirectTo\n_71\n);\n_71\n_71\nif (res.type === \"success\") {\n_71\n    const { url } = res;\n_71\n    await createSessionFromUrl(url);\n_71\n}\n_71\n};\n_71\n_71\nconst sendMagicLink = async () => {\n_71\nconst { error } = await supabase.auth.signInWithOtp({\n_71\n    email: \"example@email.com\",\n_71\n    options: {\n_71\n      emailRedirectTo: redirectTo,\n_71\n    },\n_71\n});\n_71\n_71\nif (error) throw error;\n_71\n// Email sent.\n_71\n};\n_71\n_71\nexport default function Auth() {\n_71\n// Handle linking into app from email app.\n_71\nconst url = Linking.useURL();\n_71\nif (url) createSessionFromUrl(url);\n_71\n_71\nreturn (\n_71\n    <>\n_71\n      <Button onPress={performOAuth} title=\"Sign in with Github\" />\n_71\n      <Button onPress={sendMagicLink} title=\"Send Magic Link\" />\n_71\n    </>\n_71\n);\n_71\n}\n`\n\nFor the best user experience it is recommended to use universal links which require a more elaborate setup. You can find the detailed setup instructions in the [Expo docs](https://docs.expo.dev/guides/deep-linking/).\n"
    }
  },
  {
    "chunk_id": "b4cbde7e-2ed1-4947-aeb6-30ade02aee5d",
    "metadata": {
      "token_count": 582,
      "source_url": "https://supabase.com/docs/guides/auth/rate-limits",
      "page_title": "Rate limits | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Rate limits",
        "h2": "Rate limits protect your services from abuse",
        "h3": ""
      },
      "text": "Auth\nSupabase Auth enforces rate limits on endpoints to prevent abuse. Some rate limits are [customizable](/dashboard/project/_/auth/rate-limits).\n\n| Endpoint | Path | Limited By | Rate Limit |\n| --- | --- | --- | --- |\n| All endpoints that send emails | <code>/auth/v1/signup</code> <code>/auth/v1/recover</code> <code>/auth/v1/user</code> [1](#user-content-fn-1) | Sum of combined requests | Defaults to 4 emails per hour as of 14th July 2023. As of 21 Oct 2023, this has been updated to 2 emails per hour. You can only change this with your own custom SMTP setup. |\n| All endpoints that send One-Time-Passwords (OTP) | <code>/auth/v1/otp</code> | Sum of combined requests | Defaults to 30 OTPs per hour. Is customizable. |\n| Send OTPs or magiclinks | <code>/auth/v1/otp</code> | Last request | Defaults to 60 seconds window before a new request is allowed. Is customizable. |\n| Signup confirmation request | <code>/auth/v1/signup</code> | Last request | Defaults to 60 seconds window before a new request is allowed. Is customizable. |\n| Password Reset Request | <code>/auth/v1/recover</code> | Last request | Defaults to 60 seconds window before a new request is allowed. Is customizable. |\n| Verification requests | <code>/auth/v1/verify</code> | IP Address | 360 requests per hour (with bursts up to 30 requests) |\n| Token refresh requests | <code>/auth/v1/token</code> | IP Address | 1800 requests per hour (with bursts up to 30 requests) |\n| Create or Verify an MFA challenge | <code>/auth/v1/factors/:id/challenge</code> <code>/auth/v1/factors/:id/verify</code> | IP Address | 15 requests per hour (with bursts up to  requests) |\n| Anonymous sign-ins | <code>/auth/v1/signup</code> [2](#user-content-fn-2) | IP Address | 30 requests per hour (with bursts up to 30 requests) |\n1. The rate limit is only applied on <code>/auth/v1/user</code> if this endpoint is called to update the user's email address. [\u21a9](#user-content-fnref-1)\n\n2. The rate limit is only applied on <code>/auth/v1/signup</code> if this endpoint is called without passing in an email or phone number in the request body. [\u21a9](#user-content-fnref-2)\n"
    }
  },
  {
    "chunk_id": "ab6e9e2d-d9c2-4f8e-974a-29199781d2d2",
    "metadata": {
      "token_count": 179,
      "source_url": "https://supabase.com/docs/guides/auth/sessions/implicit-flow",
      "page_title": "Implicit flow | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Implicit flow",
        "h2": "About authenticating with implicit flow.",
        "h3": ""
      },
      "text": "Auth\nThe implicit flow is one of two ways that a user can authenticate and your app can receive the necessary access and refresh tokens.\n\nThe flow is an implementation detail handled for you by Supabase Auth, but understanding the difference between implicit and [PKCE flow](/docs/guides/auth/sessions/pkce-flow) is important for understanding the difference between client-only and server-side auth.\nAfter a successful signin, the user is redirected to your app with a URL that looks like this:\n\n`\n_10\nhttps://yourapp.com/...#access_token=<...>&refresh_token=<...>&...\n`\n\nThe access and refresh tokens are contained in the URL fragment.\n\nThe client libraries:\n\n- Detect this type of URL\n- Extract the access token, refresh token, and some extra information\n- Persist this information to local storage for further use by the library and your app\n"
    }
  },
  {
    "chunk_id": "0520346e-12d8-4077-be8b-ebb1c5580eae",
    "metadata": {
      "token_count": 181,
      "source_url": "https://supabase.com/docs/guides/auth/sessions/implicit-flow",
      "page_title": "Implicit flow | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Implicit flow",
        "h2": "Limitations \\#",
        "h3": ""
      },
      "text": " tokens are contained in the URL fragment.\n\nThe client libraries:\n\n- Detect this type of URL\n- Extract the access token, refresh token, and some extra information\n- Persist this information to local storage for further use by the library and your app\nThe implicit flow only works on the client. Web browsers do not send the URL fragment to the server by design. This is a security feature:\n\n- You may be hosting your single-page app on a third-party server. The third-party service shouldn't get access to your user's credentials.\n- Even if the server is under your direct control, <code>GET</code> requests and their full URLs are often logged. This approach avoids leaking credentials in request or access logs.\n\nIf you wish to obtain the access token and refresh token on a server, use the [PKCE flow](/docs/guides/auth/sessions/pkce-flow).\n"
    }
  },
  {
    "chunk_id": "3f6703f3-e197-482b-849e-89623a78b6f7",
    "metadata": {
      "token_count": 245,
      "source_url": "https://supabase.com/docs/guides/auth/users",
      "page_title": "Users | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Users",
        "h2": "Permanent and anonymous users \\#",
        "h3": ""
      },
      "text": "Auth\nA **user** in Supabase Auth is someone with a user ID, stored in the Auth schema. Once someone is a user, they can be issued an Access Token, which can be used to access Supabase endpoints. The token is tied to the user, so you can restrict access to resources via [RLS policies](/docs/guides/database/postgres/row-level-security).\nSupabase distinguishes between permanent and anonymous users.\n\n- **Permanent users** are tied to a piece of Personally Identifiable Information (PII), such as an email address, a phone number, or a third-party identity. They can use these identities to sign back into their account after signing out.\n- **Anonymous users** aren't tied to any identities. They have a user ID and a personalized Access Token, but they have no way of signing back in as the same user if they are signed out.\n\nAnonymous users are useful for:\n\n- E-commerce applications, to create shopping carts before checkout\n- Full-feature demos without collecting personal information\n- Temporary or throw-away accounts\n\nSee the [Anonymous Signins guide](/docs/guides/auth/auth-anonymous) to learn more about anonymous users.\n"
    }
  },
  {
    "chunk_id": "b3edfa36-96cc-4760-b836-79f7a4aa7dfe",
    "metadata": {
      "token_count": 841,
      "source_url": "https://supabase.com/docs/guides/auth/users",
      "page_title": "Users | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Users",
        "h2": "Permanent and anonymous users \\#",
        "h3": "## Anonymous users do not use the anon role"
      },
      "text": " applications, to create shopping carts before checkout\n- Full-feature demos without collecting personal information\n- Temporary or throw-away accounts\n\nSee the [Anonymous Signins guide](/docs/guides/auth/auth-anonymous) to learn more about anonymous users.\nJust like permanent users, anonymous users use the **authenticated** role for database access.\n\nThe **anon** role is for those who aren't signed in at all and are not tied to any user ID. We refer to these as unauthenticated or public users.\nThe user object stores all the information related to a user in your application. The user object can be retrieved using one of these methods:\n\n1. [<code>supabase.auth.getUser()</code>](/docs/reference/javascript/auth-getuser)\n2. Retrieve a user object as an admin using [<code>supabase.auth.admin.getUserById()</code>](/docs/reference/javascript/auth-admin-listusers)\n\nA user can sign in with one of the following methods:\n\n- Password-based method (with email or phone)\n- Passwordless method (with email or phone)\n- OAuth\n- SAML SSO\n\nAn identity describes the authentication method that a user can use to sign in. A user can have multiple identities. These are the types of identities supported:\n\n- Email\n- Phone\n- OAuth\n- SAML\n\nA user with an email or phone identity will be able to sign in with either a password or passwordless method (e.g. use a one-time password (OTP) or magiclink). By default, a user with an unverified email or phone number will not be able to sign in.\n\nThe user object contains the following attributes:\n\n| Attributes | Type | Description |\n| --- | --- | --- |\n| id | <code>string</code> | The unique id of the identity of the user. |\n| aud | <code>string</code> | The audience claim. |\n| role | <code>string</code> | The role claim used by Postgres to perform Row Level Security (RLS) checks. |\n| email | <code>string</code> | The user's email address. |\n| email\\_confirmed\\_at | <code>string</code> | The timestamp that the user's email was confirmed. If null, it means that the user's email is not confirmed. |\n| phone | <code>string</code> | The user's phone number. |\n| phone\\_confirmed\\_at | <code>string</code> | The timestamp that the user's phone was confirmed. If null, it means that the user's phone is not confirmed. |\n| confirmed\\_at | <code>string</code> | The timestamp that either the user's email or phone was confirmed. If null, it means that the user does not have a confirmed email address and phone number. |\n| last\\_sign\\_in\\_at | <code>string</code> | The timestamp that the user last signed in. |\n| app\\_metadata | <code>object</code> | The <code>provider</code> attribute indicates the first provider that the user used to sign up with. The <code>providers</code> attribute indicates the list of providers that the user can use to login with. |\n| user\\_metadata | <code>object</code> | Defaults to the first provider's identity data but can contain additional custom user metadata if specified. Refer to [**User Identity**](/docs/guides/auth/auth-identity-linking#the-user-identity) for more information about the identity object. |\n| identities | <code>UserIdentity[]</code> | Contains an object array of identities linked to the user. |\n| created\\_at | <code>string</code> | The timestamp that the user was created. |\n| updated\\_at | <code>string</code> | The timestamp that the user was last updated. |\n| is\\_anonymous | <code>boolean</code> | Is true if the user is an anonymous user. |\n- [User Management guide](/docs/guides/auth/managing-user-data)\n"
    }
  },
  {
    "chunk_id": "6d28678e-198b-419d-b303-e10a48d14ebd",
    "metadata": {
      "token_count": 317,
      "source_url": "https://supabase.com/docs/guides/auth/auth-helpers",
      "page_title": "Auth Helpers | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth Helpers",
        "h2": "Status \\#",
        "h3": ""
      },
      "text": "Auth\nThe Auth helpers package is in maintenance mode and we won\u2019t be actively improving it. We strongly recommend using the new <code>@supabase/ssr</code> package instead of <code>auth-helpers</code>. <code>@supabase/ssr</code> takes the core concepts of the Auth Helpers package and makes them available to any server framework. Check out the [migration doc](/docs/guides/auth/server-side/migrating-to-ssr-from-auth-helpers) to learn more.\n\nWorking with server-side frameworks is slightly different to client-side frameworks. In this section we cover the various ways of handling server-side authentication and demonstrate how to use the Supabase helper-libraries to make the process more seamless.\n\n[**Next.js** \\\\\n\\\\\nHelpers for authenticating users in Next.js applications.](/docs/guides/auth/auth-helpers/nextjs)\n\n[**SvelteKit** \\\\\n\\\\\nHelpers for authenticating users in SvelteKit applications.](/docs/guides/auth/auth-helpers/sveltekit)\n\n[**Remix** \\\\\n\\\\\nHelpers for authenticating users in Remix applications.](/docs/guides/auth/auth-helpers/remix)\nThe Auth Helpers are in <code>beta</code>. They are usable in their current state, but it's likely that there will be breaking changes.\n- [Source code](https://github.com/supabase/auth-helpers)\n- [Known bugs and issues](https://github.com/supabase/auth-helpers/issues)\n"
    }
  },
  {
    "chunk_id": "7aa66d01-744c-490f-bf6d-3255cbcde697",
    "metadata": {
      "token_count": 174,
      "source_url": "https://supabase.com/docs/guides/auth",
      "page_title": "Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth",
        "h2": "Use Supabase to authenticate and authorize your users.",
        "h3": ""
      },
      "text": "Auth\nSupabase Auth makes it easy to implement authentication and authorization in your app. We provide client SDKs and API endpoints to help you create and manage users.\n\nYour users can use many popular Auth methods, including password, magic link, one-time password (OTP), social login, and single sign-on (SSO).\nAuthentication and authorization are the core responsibilities of any Auth system.\n\n- **Authentication** means checking that a user is who they say they are.\n- **Authorization** means checking what resources a user is allowed to access.\n\nSupabase Auth uses [JSON Web Tokens (JWTs)](/docs/guides/auth/jwts) for authentication. Auth integrates with Supabase's database features, making it easy to use [Row Level Security (RLS)](/docs/guides/database/postgres/row-level-security) for authorization.\n"
    }
  },
  {
    "chunk_id": "f6ab9ee1-4e15-47f7-b06c-fb33ae7ba50f",
    "metadata": {
      "token_count": 193,
      "source_url": "https://supabase.com/docs/guides/auth",
      "page_title": "Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth",
        "h2": "The Supabase ecosystem \\#",
        "h3": ""
      },
      "text": "/guides/auth/jwts) for authentication. Auth integrates with Supabase's database features, making it easy to use [Row Level Security (RLS)](/docs/guides/database/postgres/row-level-security) for authorization.\nYou can use Supabase Auth as a standalone product, but it's also built to integrate with the Supabase ecosystem.\n\nAuth uses your project's Postgres database under the hood, storing user data and other Auth information in a special schema. You can connect this data to your own tables using triggers and foreign key references.\n\nAuth also enables access control to your database's automatically generated [REST API](/docs/guides/api). When using Supabase SDKs, your data requests are automatically sent with the user's Auth Token. The Auth Token scopes database access on a row-by-row level when used along with [RLS policies](/docs/guides/database/postgres/row-level-security).\n"
    }
  },
  {
    "chunk_id": "13410422-dc11-4eef-8d4f-e348a23649af",
    "metadata": {
      "token_count": 851,
      "source_url": "https://supabase.com/docs/guides/auth",
      "page_title": "Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth",
        "h2": "Providers \\#",
        "h3": "Social Auth \\#"
      },
      "text": " SDKs, your data requests are automatically sent with the user's Auth Token. The Auth Token scopes database access on a row-by-row level when used along with [RLS policies](/docs/guides/database/postgres/row-level-security).\nSupabase Auth works with many popular Auth methods, including Social and Phone Auth using third-party providers. See the following sections for a list of supported third-party providers.\n[![Apple Icon](https://supabase.com/docs/img/icons/apple-icon.svg)\\\\\n\\\\\n**Apple**](/docs/guides/auth/social-login/auth-apple) [![Azure (Microsoft) Icon](https://supabase.com/docs/guides/Microsoft)\\\\\n\\\\\n**Azure (Microsoft)**](/docs/guides/auth/social-login/auth-azure) [![Bitbucket Icon](https://supabase.com/docs/img/icons/bitbucket-icon.svg)\\\\\n\\\\\n**Bitbucket**](/docs/guides/auth/social-login/auth-bitbucket) [![Discord Icon](https://supabase.com/docs/img/icons/discord-icon.svg)\\\\\n\\\\\n**Discord**](/docs/guides/auth/social-login/auth-discord) [![Facebook Icon](https://supabase.com/docs/img/icons/facebook-icon.svg)\\\\\n\\\\\n**Facebook**](/docs/guides/auth/social-login/auth-facebook) [![Figma Icon](https://supabase.com/docs/img/icons/figma-icon.svg)\\\\\n\\\\\n**Figma**](/docs/guides/auth/social-login/auth-figma) [![GitHub Icon](https://supabase.com/docs/img/icons/github-icon-light.svg)\\\\\n\\\\\n**GitHub**](/docs/guides/auth/social-login/auth-github) [![GitLab Icon](https://supabase.com/docs/img/icons/gitlab-icon.svg)\\\\\n\\\\\n**GitLab**](/docs/guides/auth/social-login/auth-gitlab) [![Google Icon](https://supabase.com/docs/img/icons/google-icon.svg)\\\\\n\\\\\n**Google**](/docs/guides/auth/social-login/auth-google) [![Kakao Icon](https://supabase.com/docs/img/icons/kakao-icon.svg)\\\\\n\\\\\n**Kakao**](/docs/guides/auth/social-login/auth-kakao) [![Keycloak Icon](https://supabase.com/docs/img/icons/keycloak-icon.svg)\\\\\n\\\\\n**Keycloak**](/docs/guides/auth/social-login/auth-keycloak) [![LinkedIn Icon](https://supabase.com/docs/img/icons/linkedin-icon.svg)\\\\\n\\\\\n**LinkedIn**](/docs/guides/auth/social-login/auth-linkedin) [![Notion Icon](https://supabase.com/docs/img/icons/notion-icon.svg)\\\\\n\\\\\n**Notion**](/docs/guides/auth/social-login/auth-notion) [![Slack Icon](https://supabase.com/docs/img/icons/slack-icon.svg)\\\\\n\\\\\n**Slack**](/docs/guides/auth/social-login/auth-slack) [![Spotify Icon](https://supabase.com/docs/img/icons/spotify-icon.svg)\\\\\n\\\\\n**Spotify**](/docs/guides/auth/social-login/auth-spotify) [![Twitter Icon](https://supabase.com/docs/img/icons/twitter-icon-light.svg)\\\\\n\\\\\n**Twitter**](/docs/guides/auth/social-login/auth-twitter) [![Twitch Icon](https://supabase.com/docs/img/icons/twitch-icon.svg)\\\\\n\\\\\n**Twitch**](/docs/guides/auth/social-login/auth-twitch) [![WorkOS Icon](https://supabase.com/docs/img/icons/workos-icon.svg)\\\\\n\\\\\n**WorkOS**](/docs/guides/auth/social-login/auth-workos) [![Zoom Icon](https://supabase.com/docs/img/icons/zoom-icon.svg)\\\\\n\\\\\n**Zoom**](/docs/guides/auth/social-login/auth-zoom)\n"
    }
  },
  {
    "chunk_id": "fd60fde3-2c13-49e2-bfe9-2efdbaeeb671",
    "metadata": {
      "token_count": 197,
      "source_url": "https://supabase.com/docs/guides/auth",
      "page_title": "Auth | Supabase Docs"
    },
    "data": {
      "headers": {
        "h1": "Auth",
        "h2": "Providers \\#",
        "h3": "Phone Auth \\#"
      },
      "text": "docs/guides/auth/social-login/auth-workos) [![Zoom Icon](https://supabase.com/docs/img/icons/zoom-icon.svg)\\\\\n\\\\\n**Zoom**](/docs/guides/auth/social-login/auth-zoom)\n[![MessageBird Icon](https://supabase.com/docs/img/icons/messagebird-icon.svg)\\\\\n\\\\\n**MessageBird**](/docs/guides/auth/phone-login?showSmsProvider=MessageBird) [![Twilio Icon](https://supabase.com/docs/img/icons/twilio-icon.svg)\\\\\n\\\\\n**Twilio**](/docs/guides/auth/phone-login?showSmsProvider=Twilio) [![Vonage Icon](https://supabase.com/docs/img/icons/vonage-icon-light.svg)\\\\\n\\\\\n**Vonage**](/docs/guides/auth/phone-login?showSmsProvider=Vonage)\n"
    }
  }
]
